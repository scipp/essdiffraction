
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>DREAM advanced data reduction &#8212; ESSdiffraction</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/autodoc_pydantic.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../_static/nbsphinx-code-cells.css?v=2aa19091" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../_static/documentation_options.js?v=4aa2d450"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'user-guide/dream/dream-advanced-powder-reduction';</script>
    <script src="../../_static/anaconda-icon.js?v=461bdc62"></script>
    <link rel="icon" href="../../_static/favicon.svg"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="25.10.0" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.svg" class="logo__image only-light" alt="ESSdiffraction - Home"/>
    <img src="../../_static/logo-dark.svg" class="logo__image only-dark pst-js-only" alt="ESSdiffraction - Home"/>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-external" href="https://scipp.github.io/essreduce">
    ESSreduce
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="https://scipp.github.io/plopp">
    Plopp
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="https://scipp.github.io/sciline">
    Sciline
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="https://scipp.github.io">
    Scipp
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button"
                data-bs-toggle="dropdown" aria-expanded="false"
                aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-external" href="https://scipp.github.io/scippneutron">
    ScippNeutron
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-external" href="https://scipp.github.io/scippnexus">
    ScippNexus
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/scipp/essdiffraction" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/essdiffraction/" title="PyPI" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-python fa-lg" aria-hidden="true"></i>
            <span class="sr-only">PyPI</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://anaconda.org/conda-forge/essdiffraction" title="Conda" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-custom fa-anaconda fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Conda</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
    </div>
  

  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-external" href="https://scipp.github.io/essreduce">
    ESSreduce
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="https://scipp.github.io/plopp">
    Plopp
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="https://scipp.github.io/sciline">
    Sciline
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="https://scipp.github.io">
    Scipp
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="https://scipp.github.io/scippneutron">
    ScippNeutron
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="https://scipp.github.io/scippnexus">
    ScippNexus
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/scipp/essdiffraction" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/essdiffraction/" title="PyPI" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-python fa-lg" aria-hidden="true"></i>
            <span class="sr-only">PyPI</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://anaconda.org/conda-forge/essdiffraction" title="Conda" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-custom fa-anaconda fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Conda</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="dream-powder-reduction.html">DREAM powder data reduction</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">DREAM advanced data reduction</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="dream-instrument-view.html">DREAM instrument view</a></li>
<li class="toctree-l1"><a class="reference internal" href="workflow-widget-dream.html">Workflow widgets example</a></li>
<li class="toctree-l1"><a class="reference internal" href="dream-detector-diagnostics.html">DREAM Detector Diagnostics</a></li>
<li class="toctree-l1"><a class="reference internal" href="dream-visualize-absorption.html">Visualize effect of absorption</a></li>
<li class="toctree-l1"><a class="reference internal" href="dream-make-tof-lookup-table.html">Create a time-of-flight lookup table for DREAM</a></li>
</ul>
</div>
</nav></div>
        <div class="sidebar-primary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Compute-intensity-as-a-function-of-scattering-angle">Compute intensity as a function of scattering angle</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Alternative-run-normalizations">Alternative run normalizations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Normalize-by-integrated-monitor">Normalize by integrated monitor</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Normalize-by-proton-charge">Normalize by proton charge</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Compute-intermediate-results">Compute intermediate results</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Process-all-detector-banks">Process all detector banks</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#1D-intensity-vs.-ToF">1D intensity vs. ToF</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#2D-intensity-vs.-d-spacing-and-2θ">2D intensity vs. d-spacing and 2θ</a></li>
</ul>
</li>
</ul>
  </nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/user-guide/dream/dream-advanced-powder-reduction.ipynb"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">DREAM advanced data reduction</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="DREAM-advanced-data-reduction">
<h1>DREAM advanced data reduction<a class="headerlink" href="#DREAM-advanced-data-reduction" title="Link to this heading">#</a></h1>
<ul class="simple">
<li><p>Audience: Instrument (data) scientists, instrument users</p></li>
<li><p>Prerequisites: Basic knowledge of <a class="reference external" href="https://scipp.github.io/">Scipp</a>, <a class="reference external" href="https://scipp.github.io/sciline/">Sciline</a></p></li>
</ul>
<p>This notebook builds on the <a class="reference internal" href="dream-powder-reduction.html"><span class="doc">basic powder workflow</span></a> and demonstrates how the workflow can be used to compute different results and how alternative steps can be used.</p>
<p>This notebook uses the same data as the basic notebook, a McStas + GEANT4 simulation. The data is available through the ESSdiffraction package but accessing it requires the <code class="docutils literal notranslate"><span class="pre">pooch</span></code> package. If you get an error about a missing module <code class="docutils literal notranslate"><span class="pre">pooch</span></code>, you can install it with <code class="docutils literal notranslate"><span class="pre">!pip</span> <span class="pre">install</span> <span class="pre">pooch</span></code>:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">scipp</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sc</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ess</span><span class="w"> </span><span class="kn">import</span> <span class="n">dream</span><span class="p">,</span> <span class="n">powder</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">ess.dream.data</span>  <span class="c1"># noqa: F401</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ess.powder.types</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">plopp</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pp</span>
</pre></div>
</div>
</div>
<section id="Compute-intensity-as-a-function-of-scattering-angle">
<h2>Compute intensity as a function of scattering angle<a class="headerlink" href="#Compute-intensity-as-a-function-of-scattering-angle" title="Link to this heading">#</a></h2>
<p>The basic notebook sums over all detector voxels and produces a 1D curve. Here, we instead bin by scattering angle <span class="math notranslate nohighlight">\(2\theta\)</span>.</p>
<p>First, define the same workflow as in the <a class="reference internal" href="dream-powder-reduction.html"><span class="doc">basic example</span></a>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">workflow</span> <span class="o">=</span> <span class="n">dream</span><span class="o">.</span><span class="n">DreamGeant4Workflow</span><span class="p">(</span><span class="n">run_norm</span><span class="o">=</span><span class="n">powder</span><span class="o">.</span><span class="n">RunNormalization</span><span class="o">.</span><span class="n">monitor_histogram</span><span class="p">)</span>

<span class="n">workflow</span><span class="p">[</span><span class="n">Filename</span><span class="p">[</span><span class="n">SampleRun</span><span class="p">]]</span> <span class="o">=</span> <span class="n">dream</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">simulated_diamond_sample</span><span class="p">()</span>
<span class="n">workflow</span><span class="p">[</span><span class="n">Filename</span><span class="p">[</span><span class="n">VanadiumRun</span><span class="p">]]</span> <span class="o">=</span> <span class="n">dream</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">simulated_vanadium_sample</span><span class="p">()</span>
<span class="n">workflow</span><span class="p">[</span><span class="n">Filename</span><span class="p">[</span><span class="n">EmptyCanRun</span><span class="p">]]</span> <span class="o">=</span> <span class="n">dream</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">simulated_empty_can</span><span class="p">()</span>
<span class="n">workflow</span><span class="p">[</span><span class="n">CalibrationFilename</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

<span class="n">workflow</span><span class="p">[</span><span class="n">MonitorFilename</span><span class="p">[</span><span class="n">SampleRun</span><span class="p">]]</span> <span class="o">=</span> <span class="n">dream</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">simulated_monitor_diamond_sample</span><span class="p">()</span>
<span class="n">workflow</span><span class="p">[</span><span class="n">MonitorFilename</span><span class="p">[</span><span class="n">VanadiumRun</span><span class="p">]]</span> <span class="o">=</span> <span class="n">dream</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">simulated_monitor_vanadium_sample</span><span class="p">()</span>
<span class="n">workflow</span><span class="p">[</span><span class="n">MonitorFilename</span><span class="p">[</span><span class="n">EmptyCanRun</span><span class="p">]]</span> <span class="o">=</span> <span class="n">dream</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">simulated_monitor_empty_can</span><span class="p">()</span>
<span class="n">workflow</span><span class="p">[</span><span class="n">CaveMonitorPosition</span><span class="p">]</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">vector</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">4220.0</span><span class="p">],</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;mm&quot;</span><span class="p">)</span>

<span class="n">workflow</span><span class="p">[</span><span class="n">dream</span><span class="o">.</span><span class="n">InstrumentConfiguration</span><span class="p">]</span> <span class="o">=</span> <span class="n">dream</span><span class="o">.</span><span class="n">InstrumentConfiguration</span><span class="o">.</span><span class="n">high_flux</span>
<span class="c1"># Select a detector bank:</span>
<span class="n">workflow</span><span class="p">[</span><span class="n">NeXusDetectorName</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;mantle&quot;</span>
<span class="c1"># We drop uncertainties where they would otherwise lead to correlations:</span>
<span class="n">workflow</span><span class="p">[</span><span class="n">UncertaintyBroadcastMode</span><span class="p">]</span> <span class="o">=</span> <span class="n">UncertaintyBroadcastMode</span><span class="o">.</span><span class="n">drop</span>
<span class="c1"># Edges for binning in d-spacing:</span>
<span class="n">workflow</span><span class="p">[</span><span class="n">DspacingBins</span><span class="p">]</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="s2">&quot;dspacing&quot;</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">2.3434</span><span class="p">,</span> <span class="mi">201</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;angstrom&quot;</span><span class="p">)</span>

<span class="c1"># Do not mask any pixels / voxels:</span>
<span class="n">workflow</span> <span class="o">=</span> <span class="n">powder</span><span class="o">.</span><span class="n">with_pixel_mask_filenames</span><span class="p">(</span><span class="n">workflow</span><span class="p">,</span> <span class="p">[])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Downloading file &#39;DREAM_simple_pwd_workflow/data_dream_diamond_vana_container_sample_union.csv.zip&#39; from &#39;https://public.esss.dk/groups/scipp/ess/dream/2/DREAM_simple_pwd_workflow/data_dream_diamond_vana_container_sample_union.csv.zip&#39; to &#39;/home/runner/.cache/ess/dream&#39;.
Downloading file &#39;DREAM_simple_pwd_workflow/data_dream_vanadium_inc_coh.csv.zip&#39; from &#39;https://public.esss.dk/groups/scipp/ess/dream/2/DREAM_simple_pwd_workflow/data_dream_vanadium_inc_coh.csv.zip&#39; to &#39;/home/runner/.cache/ess/dream&#39;.
Downloading file &#39;DREAM_simple_pwd_workflow/data_dream_vana_container_sample_union.csv.zip&#39; from &#39;https://public.esss.dk/groups/scipp/ess/dream/2/DREAM_simple_pwd_workflow/data_dream_vana_container_sample_union.csv.zip&#39; to &#39;/home/runner/.cache/ess/dream&#39;.
Downloading file &#39;DREAM_simple_pwd_workflow/Cave_TOF_Monitor_diam_in_can.dat&#39; from &#39;https://public.esss.dk/groups/scipp/ess/dream/2/DREAM_simple_pwd_workflow/Cave_TOF_Monitor_diam_in_can.dat&#39; to &#39;/home/runner/.cache/ess/dream&#39;.
Downloading file &#39;DREAM_simple_pwd_workflow/Cave_TOF_Monitor_vana_inc_coh.dat&#39; from &#39;https://public.esss.dk/groups/scipp/ess/dream/2/DREAM_simple_pwd_workflow/Cave_TOF_Monitor_vana_inc_coh.dat&#39; to &#39;/home/runner/.cache/ess/dream&#39;.
Downloading file &#39;DREAM_simple_pwd_workflow/Cave_TOF_Monitor_van_can.dat&#39; from &#39;https://public.esss.dk/groups/scipp/ess/dream/2/DREAM_simple_pwd_workflow/Cave_TOF_Monitor_van_can.dat&#39; to &#39;/home/runner/.cache/ess/dream&#39;.
</pre></div></div>
</div>
<p>And then add the desired bin edges for <span class="math notranslate nohighlight">\(2\theta\)</span>:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">workflow</span><span class="p">[</span><span class="n">TwoThetaBins</span><span class="p">]</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span>
    <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;two_theta&quot;</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;rad&quot;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mf">2.4</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">201</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<p>Instead of computing <code class="docutils literal notranslate"><span class="pre">IofDspacing</span></code> and from that <code class="docutils literal notranslate"><span class="pre">IofTof</span></code> as in the basic example, here, we want to compute <code class="docutils literal notranslate"><span class="pre">IofDspacingTwoTheta</span></code>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">workflow</span><span class="o">.</span><span class="n">visualize</span><span class="p">(</span><span class="n">IofDspacingTwoTheta</span><span class="p">[</span><span class="n">SampleRun</span><span class="p">],</span> <span class="n">graph_attr</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;rankdir&quot;</span><span class="p">:</span> <span class="s2">&quot;LR&quot;</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../../_images/user-guide_dream_dream-advanced-powder-reduction_7_0.svg" src="../../_images/user-guide_dream_dream-advanced-powder-reduction_7_0.svg" />
</div>
</div>
<p>Now we can compute the intensity as a function of <span class="math notranslate nohighlight">\(2\theta\)</span> and <span class="math notranslate nohighlight">\(d\)</span>-spacing by requesting <code class="docutils literal notranslate"><span class="pre">IofDspacingTwoTheta</span></code>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grouped_dspacing</span> <span class="o">=</span> <span class="n">workflow</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">IofDspacingTwoTheta</span><span class="p">[</span><span class="n">SampleRun</span><span class="p">])</span>
<span class="n">grouped_dspacing</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Downloading file &#39;DREAM-high-flux-tof-lookup-table.h5&#39; from &#39;https://public.esss.dk/groups/scipp/ess/dream/2/DREAM-high-flux-tof-lookup-table.h5&#39; to &#39;/home/runner/.cache/ess/dream&#39;.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><!-- Original source from -->
<!-- https://github.com/jsignell/xarray/blob/1d960933ab252e0f79f7e050e6c9261d55568057/xarray/static/html/icons-svg-inline.html -->
<svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<title>Show/Hide data repr</title>
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<title>Show/Hide attributes</title>
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg><style id="scipp-style-sheet">.sc-root{--sc-background-color0:var(--jp-layout-color0,#fff);--sc-background-color1:var(--jp-layout-color1,#fcfcfc);--sc-background-color2:var(--jp-layout-color2,#efefef);--sc-inverse-background-color0:var(--jp-inverse-layout-color4,#111);--sc-font-color0:var(--jp-content-font-color0,#000);--sc-font-color1:var(--jp-content-font-color1,#555);--sc-font-color2:var(--jp-content-font-color2,#888);--sc-font-color3:var(--jp-content-font-color3,#ccc);}body.vscode-dark .sc-root{--sc-font-color0:rgba(255,255,255,1);--sc-font-color1:rgba(255,255,255,0.70);--sc-font-color2:rgba(255,255,255,0.54);--sc-font-color3:rgba(255,255,255,0.38);--sc-border-color:#1F1F1F;--sc-disabled-color:#515151;--sc-background-color0:#111111;--sc-background-color1:#111111;--sc-background-color2:#313131;}.sc-wrap{font-size:14px;min-width:300px;max-width:800px;}.sc-var-attrs .sc-wrap{padding-left:3em;}.sc-header{padding-top:6px;padding-bottom:6px;margin-bottom:4px;border-bottom:solid 1px #ddd;}.sc-header > div,.sc-header > ul{display:inline;margin-top:0;margin-bottom:0;}.sc-obj-type,.sc-array-name{margin-left:2px;margin-right:10px;}.sc-obj-type{color:var(--sc-font-color1);}.sc-underlying-size{color:var(--sc-font-color2);}.sc-sections,.reveal .sc-sections{padding-left:0 !important;display:grid;grid-template-columns:150px auto auto auto 1fr 20px 20px;}.sc-section-item{display:contents;}.sc-section-item input{display:none;}.sc-section-item input:enabled + label{cursor:pointer;color:var(--sc-font-color1);}.sc-section-item input:enabled + label:hover{color:var(--sc-font-color0);}.sc-section-summary{grid-column:1;font-weight:500;}.sc-section-summary > span{display:inline-block;padding-left:0.5em;}.sc-section-summary-in:disabled + label{color:var(--sc-font-color1);}.sc-section-summary-in + label:before{display:inline-block;content:'►';font-size:11px;width:15px;text-align:center;}.sc-section-summary-in:disabled + label:before{color:var(--sc-font-color3);}.sc-section-summary-in:checked + label:before{content:'▼';}.sc-section-summary-in:checked + label > span{display:none;}.sc-section-summary,.sc-section-inline-details{padding-top:4px;padding-bottom:4px;}.sc-section-inline-details{grid-column:2 / 6;}.sc-section-details{display:none;grid-column:1 / -1;margin-bottom:5px;}.sc-section-summary-in:checked ~ .sc-section-details{display:contents;}.sc-array-wrap{grid-column:1 / -1;display:grid;grid-template-columns:20px auto;}.sc-array-wrap > label{grid-column:1;vertical-align:top;}.sc-preview{color:var(--sc-font-color2);}.sc-array-preview,.sc-array-data{padding:0 5px !important;grid-column:2;}.sc-array-data,.sc-array-in:checked ~ .sc-array-preview{display:none;}.sc-array-in:checked ~ .sc-array-data,.sc-array-preview{display:inline-block;}.sc-dim-list{display:inline-block !important;list-style:none;padding:0 !important;margin:0;}.sc-dim-list li{display:inline-block;padding:0;margin:0!important;}.sc-dim-list:before{content:'(';}.sc-dim-list:after{content:')';}.sc-dim-list li:not(:last-child):after{content:',';padding-right:5px;}.sc-dim-list li span,.sc-standalone-var-name > span span,.sc-var-name > span span{padding:0 !important;}.sc-aligned{font-weight:bold;}.sc-var-list,.sc-var-item,.reveal .sc-var-list,.reveal .sc-var-item{display:contents;}.sc-var-item > div,.sc-var-item label,.sc-var-item > .sc-var-name span{background-color:var(--sc-background-color1);margin-bottom:0;}.sc-var-item > .sc-var-name:hover span{padding-right:5px;}.sc-var-list > li:nth-child(odd) > div,.sc-var-list > li:nth-child(odd) > label,.sc-var-list > li:nth-child(odd) > .sc-var-name span{background-color:var(--sc-background-color2);}.sc-var-name{grid-column:1;}.sc-var-dims{grid-column:2;}.sc-var-dtype{grid-column:3;text-align:right;color:var(--sc-font-color2);}.sc-var-unit{grid-column:4;text-align:left;color:var(--sc-font-color1);max-width:50pt;text-overflow:ellipsis;}.sc-value-preview{grid-column:5;}.sc-var-preview-variances{text-align:right;}.sc-sections .sc-section-item .sc-section-summary,.sc-sections .sc-section-item .sc-section-inline-details,.sc-section-item .sc-var-list .sc-var-item > div,.sc-section-item .sc-var-list .sc-var-item > label,.sc-section-details .sc-var-list .sc-var-item > div,.sc-section-details .sc-var-list .sc-var-item > label{margin-top:0;margin-bottom:0;}.sc-var-name,.sc-var-dims,.sc-var-dtype,.sc-var-unit,.sc-preview,.sc-attrs dt{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;padding-right:10px;}.sc-var-name:hover,.sc-var-dims:hover,.sc-var-dtype:hover,.sc-var-unit:hover,.sc-attrs dt:hover{overflow:visible;width:auto;z-index:1;}.sc-var-attrs{display:block;}.sc-var-data,.reveal .sc-var-data{display:none;}.sc-var-attrs,.sc-var-data{background-color:var(--sc-background-color0) !important;padding-bottom:5px !important;}.sc-var-attrs-in:checked ~ .sc-var-attrs{display:none;}.sc-var-data-in:checked ~ .sc-var-data{display:block;}.sc-var-data > table{float:right;}.sc-var-name span,.sc-var-data{padding-left:25px !important;}.sc-var-attrs,.sc-var-data{grid-column:1 / -1;}dl.sc-attrs{padding:0;margin:0;display:grid;grid-template-columns:125px auto;}.sc-attrs dt,dd{padding:0;margin:0;float:left;padding-right:10px;width:auto;}.sc-attrs dt{font-weight:normal;grid-column:1;}.sc-attrs dt:hover span{display:inline-block;padding-right:10px;}.sc-attrs dd{grid-column:2;white-space:pre-wrap;word-break:break-all;}.sc-icon-database,.sc-icon-file-text2{display:inline-block;vertical-align:middle;width:1em;height:1.5em !important;stroke-width:0;stroke:currentColor;fill:currentColor;}label.sc-hide-icon svg{opacity:0;}.sc-standalone-var-name{grid-column:1/3;}.sc-standalone-var-name span{padding-left:25px;padding-right:10px;}.sc-title{font-weight:bold;font-size:1.5em;}.sc-subtitle{font-weight:normal;font-style:italic;text-align:left;font-size:1.2em;padding:1px;}.sc-label{fill:var(--sc-font-color0,#444444);text-anchor:middle;}.sc-name{fill:var(--sc-font-color0,#111111);}.sc-inset-line{stroke:var(--sc-font-color1);stroke-width:0.05;stroke-dasharray:0.2,0.2;}.sc-log-wrap{height:25ex;resize:vertical;overflow-y:scroll;display:flex;flex-direction:column-reverse;border:1px solid;border-color:var(--jp-border-color2);background-color:var(--sc-background-color1);}div.sc-log{line-height:2.5ex;}table.sc-log{table-layout:auto;border-collapse:collapse;}tr.sc-log:nth-child(even){background-color:var(--sc-background-color0);}tr.sc-log > td{vertical-align:top;padding-bottom:0.5ex;}.sc-log-time-stamp{min-width:22ch;font-family:var(--jp-code-font-family);color:var(--sc-font-color2);}.sc-log-level{min-width:10ch;}tr.sc-log-debug td.sc-log-level{color:var(--jp-accent-color1);}tr.sc-log-info td.sc-log-level{color:var(--jp-info-color1);}tr.sc-log-warning td.sc-log-level{color:var(--jp-warn-color1);}tr.sc-log-error td.sc-log-level{font-weight:bold;color:var(--jp-error-color2);}tr.sc-log-critical td.sc-log-level{font-weight:bold;color:var(--sc-background-color0);background-color:var(--jp-error-color1);}.sc-log-message{white-space:pre-wrap;width:100%;}.sc-log-html-payload{white-space:normal;}.sc-log-name{padding-right:0.5em;text-align:right;white-space:pre-wrap;color:var(--sc-font-color3);}</style><div class='sc-wrap sc-root'><div class='sc-header'><div class='sc-obj-type'>scipp.DataArray (48.98 MB)</div></div><ul class='sc-sections'><li class='sc-section-item'><input id='section-0b701c37-1b38-4431-b6b6-d2a9f89f0709' class='sc-section-summary-in' type='checkbox' disabled ><label for='section-0b701c37-1b38-4431-b6b6-d2a9f89f0709' class='sc-section-summary' >Dimensions:</label><div class='sc-section-inline-details'><ul class='sc-dim-list'><li><span class='sc-has-index'>two_theta</span>: 200</li><li><span class='sc-has-index'>dspacing</span>: 200</li></ul></div><div class='sc-section-details'></div></li><li class='sc-section-item'><input id='section-165323cf-1e82-4b67-9db1-8c6da7082352' class='sc-section-summary-in' type='checkbox'  checked><label for='section-165323cf-1e82-4b67-9db1-8c6da7082352' class='sc-section-summary'  title='Expand/collapse section'>Coordinates: <span>(6)</span></label><div class='sc-section-inline-details'></div><div class='sc-section-details'><ul class='sc-var-list'><li class='sc-var-item'><div class='sc-var-name'><span class='sc-aligned'>detector</span></div><div class='sc-var-dims'>()</div><div class='sc-var-dtype'>string</div><div class='sc-var-unit'></div><div class='sc-value-preview sc-preview'><span><div>mantle</div></span></div><input id='attrs-01069bfc-5381-480c-9b66-b6c34841333b' class='sc-var-attrs-in' type='checkbox' disabled><label for='attrs-01069bfc-5381-480c-9b66-b6c34841333b' class='sc-hide-icon' title='Show/Hide attributes'><svg class='icon sc-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-baf872c8-c989-4869-8c28-a4229da2fb3b' class='sc-var-data-in' type='checkbox'><label for='data-baf872c8-c989-4869-8c28-a4229da2fb3b' title='Show/Hide data repr'><svg class='icon sc-icon-database'><use xlink:href='#icon-database'></use></svg></label><pre class='sc-var-data'>Values:<br>&#x27;mantle&#x27;</pre></span></li><li class='sc-var-item'><div class='sc-var-name'><span class='sc-aligned'>dspacing</span></div><div class='sc-var-dims'>(dspacing [bin-edge])</div><div class='sc-var-dtype'>float64</div><div class='sc-var-unit'>Å</div><div class='sc-value-preview sc-preview'><span><div>0.3, 0.310, ..., 2.333, 2.343</div></span></div><input id='attrs-f72bffc3-b16f-4ff2-985c-4432de81e764' class='sc-var-attrs-in' type='checkbox' disabled><label for='attrs-f72bffc3-b16f-4ff2-985c-4432de81e764' class='sc-hide-icon' title='Show/Hide attributes'><svg class='icon sc-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c29959ab-2d47-4cb7-9148-9e8a4d0cec9d' class='sc-var-data-in' type='checkbox'><label for='data-c29959ab-2d47-4cb7-9148-9e8a4d0cec9d' title='Show/Hide data repr'><svg class='icon sc-icon-database'><use xlink:href='#icon-database'></use></svg></label><pre class='sc-var-data'>Values:<br>array([0.3     , 0.310217, 0.320434, 0.330651, 0.340868, 0.351085,
       0.361302, 0.371519, 0.381736, 0.391953, 0.40217 , 0.412387,
       0.422604, 0.432821, 0.443038, 0.453255, 0.463472, 0.473689,
       0.483906, 0.494123, 0.50434 , 0.514557, 0.524774, 0.534991,
       0.545208, 0.555425, 0.565642, 0.575859, 0.586076, 0.596293,
       0.60651 , 0.616727, 0.626944, 0.637161, 0.647378, 0.657595,
       0.667812, 0.678029, 0.688246, 0.698463, 0.70868 , 0.718897,
       0.729114, 0.739331, 0.749548, 0.759765, 0.769982, 0.780199,
       0.790416, 0.800633, 0.81085 , 0.821067, 0.831284, 0.841501,
       0.851718, 0.861935, 0.872152, 0.882369, 0.892586, 0.902803,
       0.91302 , 0.923237, 0.933454, 0.943671, 0.953888, 0.964105,
       0.974322, 0.984539, 0.994756, 1.004973, 1.01519 , 1.025407,
       1.035624, 1.045841, 1.056058, 1.066275, 1.076492, 1.086709,
       1.096926, 1.107143, 1.11736 , 1.127577, 1.137794, 1.148011,
       1.158228, 1.168445, 1.178662, 1.188879, 1.199096, 1.209313,
       1.21953 , 1.229747, 1.239964, 1.250181, 1.260398, 1.270615,
       1.280832, 1.291049, 1.301266, 1.311483, 1.3217  , 1.331917,
       1.342134, 1.352351, 1.362568, 1.372785, 1.383002, 1.393219,
       1.403436, 1.413653, 1.42387 , 1.434087, 1.444304, 1.454521,
       1.464738, 1.474955, 1.485172, 1.495389, 1.505606, 1.515823,
       1.52604 , 1.536257, 1.546474, 1.556691, 1.566908, 1.577125,
       1.587342, 1.597559, 1.607776, 1.617993, 1.62821 , 1.638427,
       1.648644, 1.658861, 1.669078, 1.679295, 1.689512, 1.699729,
       1.709946, 1.720163, 1.73038 , 1.740597, 1.750814, 1.761031,
       1.771248, 1.781465, 1.791682, 1.801899, 1.812116, 1.822333,
       1.83255 , 1.842767, 1.852984, 1.863201, 1.873418, 1.883635,
       1.893852, 1.904069, 1.914286, 1.924503, 1.93472 , 1.944937,
       1.955154, 1.965371, 1.975588, 1.985805, 1.996022, 2.006239,
       2.016456, 2.026673, 2.03689 , 2.047107, 2.057324, 2.067541,
       2.077758, 2.087975, 2.098192, 2.108409, 2.118626, 2.128843,
       2.13906 , 2.149277, 2.159494, 2.169711, 2.179928, 2.190145,
       2.200362, 2.210579, 2.220796, 2.231013, 2.24123 , 2.251447,
       2.261664, 2.271881, 2.282098, 2.292315, 2.302532, 2.312749,
       2.322966, 2.333183, 2.3434  ])</pre></span></li><li class='sc-var-item'><div class='sc-var-name'><span class='sc-aligned'>gravity</span></div><div class='sc-var-dims'>()</div><div class='sc-var-dtype'>vector3</div><div class='sc-var-unit'>m/s^2</div><div class='sc-value-preview sc-preview'><span><div>[ 0.      -9.80665  0.     ]</div></span></div><input id='attrs-785789e7-b621-4ff6-875c-ecb2b1f52716' class='sc-var-attrs-in' type='checkbox' disabled><label for='attrs-785789e7-b621-4ff6-875c-ecb2b1f52716' class='sc-hide-icon' title='Show/Hide attributes'><svg class='icon sc-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-79c40fb1-9c0a-4655-82e2-437ac582a9be' class='sc-var-data-in' type='checkbox'><label for='data-79c40fb1-9c0a-4655-82e2-437ac582a9be' title='Show/Hide data repr'><svg class='icon sc-icon-database'><use xlink:href='#icon-database'></use></svg></label><pre class='sc-var-data'>Values:<br>array([ 0.     , -9.80665,  0.     ])</pre></span></li><li class='sc-var-item'><div class='sc-var-name'><span>sample_position</span></div><div class='sc-var-dims'>()</div><div class='sc-var-dtype'>vector3</div><div class='sc-var-unit'>mm</div><div class='sc-value-preview sc-preview'><span><div>[0. 0. 0.]</div></span></div><input id='attrs-a994a325-8098-451c-b554-62ef43ef8cb9' class='sc-var-attrs-in' type='checkbox' disabled><label for='attrs-a994a325-8098-451c-b554-62ef43ef8cb9' class='sc-hide-icon' title='Show/Hide attributes'><svg class='icon sc-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e9031f65-3c79-4dab-8929-1f09989e3d38' class='sc-var-data-in' type='checkbox'><label for='data-e9031f65-3c79-4dab-8929-1f09989e3d38' title='Show/Hide data repr'><svg class='icon sc-icon-database'><use xlink:href='#icon-database'></use></svg></label><pre class='sc-var-data'>Values:<br>array([0., 0., 0.])</pre></span></li><li class='sc-var-item'><div class='sc-var-name'><span>source_position</span></div><div class='sc-var-dims'>()</div><div class='sc-var-dtype'>vector3</div><div class='sc-var-unit'>mm</div><div class='sc-value-preview sc-preview'><span><div>[-3.478e+00  0.000e+00 -7.655e+04]</div></span></div><input id='attrs-f0236538-7c56-46dd-a844-13e46819a050' class='sc-var-attrs-in' type='checkbox' disabled><label for='attrs-f0236538-7c56-46dd-a844-13e46819a050' class='sc-hide-icon' title='Show/Hide attributes'><svg class='icon sc-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-da457d93-4463-4cf6-8b39-0fd6e211fe0a' class='sc-var-data-in' type='checkbox'><label for='data-da457d93-4463-4cf6-8b39-0fd6e211fe0a' title='Show/Hide data repr'><svg class='icon sc-icon-database'><use xlink:href='#icon-database'></use></svg></label><pre class='sc-var-data'>Values:<br>array([-3.478e+00,  0.000e+00, -7.655e+04])</pre></span></li><li class='sc-var-item'><div class='sc-var-name'><span class='sc-aligned'>two_theta</span></div><div class='sc-var-dims'>(two_theta [bin-edge])</div><div class='sc-var-dtype'>float64</div><div class='sc-var-unit'>rad</div><div class='sc-value-preview sc-preview'><span><div>0.8, 0.808, ..., 2.392, 2.4</div></span></div><input id='attrs-ecf753ca-9fad-42ae-8188-a60348254f4b' class='sc-var-attrs-in' type='checkbox' disabled><label for='attrs-ecf753ca-9fad-42ae-8188-a60348254f4b' class='sc-hide-icon' title='Show/Hide attributes'><svg class='icon sc-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e5d523d0-7dc1-4982-8872-f7b36ebc5ca0' class='sc-var-data-in' type='checkbox'><label for='data-e5d523d0-7dc1-4982-8872-f7b36ebc5ca0' title='Show/Hide data repr'><svg class='icon sc-icon-database'><use xlink:href='#icon-database'></use></svg></label><pre class='sc-var-data'>Values:<br>array([0.8  , 0.808, 0.816, 0.824, 0.832, 0.84 , 0.848, 0.856, 0.864,
       0.872, 0.88 , 0.888, 0.896, 0.904, 0.912, 0.92 , 0.928, 0.936,
       0.944, 0.952, 0.96 , 0.968, 0.976, 0.984, 0.992, 1.   , 1.008,
       1.016, 1.024, 1.032, 1.04 , 1.048, 1.056, 1.064, 1.072, 1.08 ,
       1.088, 1.096, 1.104, 1.112, 1.12 , 1.128, 1.136, 1.144, 1.152,
       1.16 , 1.168, 1.176, 1.184, 1.192, 1.2  , 1.208, 1.216, 1.224,
       1.232, 1.24 , 1.248, 1.256, 1.264, 1.272, 1.28 , 1.288, 1.296,
       1.304, 1.312, 1.32 , 1.328, 1.336, 1.344, 1.352, 1.36 , 1.368,
       1.376, 1.384, 1.392, 1.4  , 1.408, 1.416, 1.424, 1.432, 1.44 ,
       1.448, 1.456, 1.464, 1.472, 1.48 , 1.488, 1.496, 1.504, 1.512,
       1.52 , 1.528, 1.536, 1.544, 1.552, 1.56 , 1.568, 1.576, 1.584,
       1.592, 1.6  , 1.608, 1.616, 1.624, 1.632, 1.64 , 1.648, 1.656,
       1.664, 1.672, 1.68 , 1.688, 1.696, 1.704, 1.712, 1.72 , 1.728,
       1.736, 1.744, 1.752, 1.76 , 1.768, 1.776, 1.784, 1.792, 1.8  ,
       1.808, 1.816, 1.824, 1.832, 1.84 , 1.848, 1.856, 1.864, 1.872,
       1.88 , 1.888, 1.896, 1.904, 1.912, 1.92 , 1.928, 1.936, 1.944,
       1.952, 1.96 , 1.968, 1.976, 1.984, 1.992, 2.   , 2.008, 2.016,
       2.024, 2.032, 2.04 , 2.048, 2.056, 2.064, 2.072, 2.08 , 2.088,
       2.096, 2.104, 2.112, 2.12 , 2.128, 2.136, 2.144, 2.152, 2.16 ,
       2.168, 2.176, 2.184, 2.192, 2.2  , 2.208, 2.216, 2.224, 2.232,
       2.24 , 2.248, 2.256, 2.264, 2.272, 2.28 , 2.288, 2.296, 2.304,
       2.312, 2.32 , 2.328, 2.336, 2.344, 2.352, 2.36 , 2.368, 2.376,
       2.384, 2.392, 2.4  ])</pre></span></li></ul></div></li><li class='sc-section-item'><input id='section-1faca929-9d49-430d-b4f0-86117ee9ad1c' class='sc-section-summary-in' type='checkbox'  checked><label for='section-1faca929-9d49-430d-b4f0-86117ee9ad1c' class='sc-section-summary'  title='Expand/collapse section'>Data: <span>(1)</span></label><div class='sc-section-inline-details'></div><div class='sc-section-details'><ul class='sc-var-list'><li class='sc-var-item'><div class='sc-var-name'><span></span></div><div class='sc-var-dims'>(two_theta, dspacing)</div><div class='sc-var-dtype'>float64</div><div class='sc-var-unit'>𝟙</div><div class='sc-value-preview sc-preview'><span><div>binned data [len=0, len=0, ..., len=0, len=0]</div></span></div><input id='attrs-3aae5224-cdea-44e3-b6a6-c920717bf97e' class='sc-var-attrs-in' type='checkbox' disabled><label for='attrs-3aae5224-cdea-44e3-b6a6-c920717bf97e' class='sc-hide-icon' title='Show/Hide attributes'><svg class='icon sc-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4fc3689f-4248-412f-9c0c-441121c7cb0e' class='sc-var-data-in' type='checkbox'><label for='data-4fc3689f-4248-412f-9c0c-441121c7cb0e' title='Show/Hide data repr'><svg class='icon sc-icon-database'><use xlink:href='#icon-database'></use></svg></label><pre class='sc-var-data'>dim=&#x27;event&#x27;,
content=DataArray(
          dims=(event: 1266913),
          data=float64[dimensionless],
          coords={&#x27;event_time_zero&#x27;:datetime64[ns], &#x27;wavelength&#x27;:float64[Å],
                  &#x27;dspacing&#x27;:float64[Å]})</pre></li></ul></div></li><li class='sc-section-item'><input id='section-7f9c4ea2-e491-4374-a2b3-92f2b1beb70a' class='sc-section-summary-in' type='checkbox'  checked><label for='section-7f9c4ea2-e491-4374-a2b3-92f2b1beb70a' class='sc-section-summary'  title='Expand/collapse section'>Masks: <span>(1)</span></label><div class='sc-section-inline-details'></div><div class='sc-section-details'><ul class='sc-var-list'><li class='sc-var-item'><div class='sc-var-name'><span>zero_vanadium</span></div><div class='sc-var-dims'>(two_theta, dspacing)</div><div class='sc-var-dtype'>bool</div><div class='sc-var-unit'></div><div class='sc-value-preview sc-preview'><span><div>True, True, ..., True, True</div></span></div><input id='attrs-eb95a2fe-2911-463b-b267-1478cbe04957' class='sc-var-attrs-in' type='checkbox' disabled><label for='attrs-eb95a2fe-2911-463b-b267-1478cbe04957' class='sc-hide-icon' title='Show/Hide attributes'><svg class='icon sc-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-bc73f832-339f-4e08-9773-d0ac342519b0' class='sc-var-data-in' type='checkbox'><label for='data-bc73f832-339f-4e08-9773-d0ac342519b0' title='Show/Hide data repr'><svg class='icon sc-icon-database'><use xlink:href='#icon-database'></use></svg></label><pre class='sc-var-data'>Values:<br>array([[ True,  True,  True, ..., False, False, False],
       [ True,  True,  True, ..., False, False, False],
       [ True,  True,  True, ..., False, False, False],
       ...,
       [ True,  True,  True, ...,  True,  True,  True],
       [ True,  True,  True, ...,  True,  True,  True],
       [ True,  True,  True, ...,  True,  True,  True]], shape=(200, 200))</pre></span></li></ul></div></li></ul></div></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grouped_dspacing</span><span class="o">.</span><span class="n">hist</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="n">grouped_dspacing</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s1">&#39;detector&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">capitalize</span><span class="p">(),</span> <span class="n">norm</span><span class="o">=</span><span class="s2">&quot;log&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../../_images/user-guide_dream_dream-advanced-powder-reduction_10_0.svg" src="../../_images/user-guide_dream_dream-advanced-powder-reduction_10_0.svg" />
</div>
</div>
</section>
<section id="Alternative-run-normalizations">
<h2>Alternative run normalizations<a class="headerlink" href="#Alternative-run-normalizations" title="Link to this heading">#</a></h2>
<p>The <a class="reference internal" href="dream-powder-reduction.html"><span class="doc">basic example</span></a> normalizes the detector data by a monitor that was histogrammed in wavelength. ESSdiffraction provides some alternatives.</p>
<section id="Normalize-by-integrated-monitor">
<h3>Normalize by integrated monitor<a class="headerlink" href="#Normalize-by-integrated-monitor" title="Link to this heading">#</a></h3>
<p>Instead of computing a histogram of the monitor data, we can integrate over all bins to get a single intensity value for the monitor.</p>
<p>To do so, specify <code class="docutils literal notranslate"><span class="pre">ess.powder.RunNormalization.monitor_integrated</span></code> when constructing the workflow. This will insert <a class="reference internal" href="../../generated/modules/ess.powder.correction.normalize_by_monitor_integrated.html"><span class="doc">normalize_by_monitor_integrated</span></a> into the workflow. Then, set parameter as before.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">workflow</span> <span class="o">=</span> <span class="n">dream</span><span class="o">.</span><span class="n">DreamGeant4Workflow</span><span class="p">(</span>
    <span class="n">run_norm</span><span class="o">=</span><span class="n">powder</span><span class="o">.</span><span class="n">RunNormalization</span><span class="o">.</span><span class="n">monitor_integrated</span>
<span class="p">)</span>

<span class="n">workflow</span><span class="p">[</span><span class="n">Filename</span><span class="p">[</span><span class="n">SampleRun</span><span class="p">]]</span> <span class="o">=</span> <span class="n">dream</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">simulated_diamond_sample</span><span class="p">()</span>
<span class="n">workflow</span><span class="p">[</span><span class="n">Filename</span><span class="p">[</span><span class="n">VanadiumRun</span><span class="p">]]</span> <span class="o">=</span> <span class="n">dream</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">simulated_vanadium_sample</span><span class="p">()</span>
<span class="n">workflow</span><span class="p">[</span><span class="n">Filename</span><span class="p">[</span><span class="n">EmptyCanRun</span><span class="p">]]</span> <span class="o">=</span> <span class="n">dream</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">simulated_empty_can</span><span class="p">()</span>
<span class="n">workflow</span><span class="p">[</span><span class="n">CalibrationFilename</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

<span class="n">workflow</span><span class="p">[</span><span class="n">MonitorFilename</span><span class="p">[</span><span class="n">SampleRun</span><span class="p">]]</span> <span class="o">=</span> <span class="n">dream</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">simulated_monitor_diamond_sample</span><span class="p">()</span>
<span class="n">workflow</span><span class="p">[</span><span class="n">MonitorFilename</span><span class="p">[</span><span class="n">VanadiumRun</span><span class="p">]]</span> <span class="o">=</span> <span class="n">dream</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">simulated_monitor_vanadium_sample</span><span class="p">()</span>
<span class="n">workflow</span><span class="p">[</span><span class="n">MonitorFilename</span><span class="p">[</span><span class="n">EmptyCanRun</span><span class="p">]]</span> <span class="o">=</span> <span class="n">dream</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">simulated_monitor_empty_can</span><span class="p">()</span>
<span class="n">workflow</span><span class="p">[</span><span class="n">CaveMonitorPosition</span><span class="p">]</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">vector</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">4220.0</span><span class="p">],</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;mm&quot;</span><span class="p">)</span>

<span class="n">workflow</span><span class="p">[</span><span class="n">dream</span><span class="o">.</span><span class="n">InstrumentConfiguration</span><span class="p">]</span> <span class="o">=</span> <span class="n">dream</span><span class="o">.</span><span class="n">InstrumentConfiguration</span><span class="o">.</span><span class="n">high_flux</span>
<span class="c1"># Select a detector bank:</span>
<span class="n">workflow</span><span class="p">[</span><span class="n">NeXusDetectorName</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;mantle&quot;</span>
<span class="c1"># We drop uncertainties where they would otherwise lead to correlations:</span>
<span class="n">workflow</span><span class="p">[</span><span class="n">UncertaintyBroadcastMode</span><span class="p">]</span> <span class="o">=</span> <span class="n">UncertaintyBroadcastMode</span><span class="o">.</span><span class="n">drop</span>
<span class="c1"># Edges for binning in d-spacing:</span>
<span class="n">workflow</span><span class="p">[</span><span class="n">DspacingBins</span><span class="p">]</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="s2">&quot;dspacing&quot;</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">2.3434</span><span class="p">,</span> <span class="mi">201</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;angstrom&quot;</span><span class="p">)</span>

<span class="c1"># Do not mask any pixels / voxels:</span>
<span class="n">workflow</span> <span class="o">=</span> <span class="n">powder</span><span class="o">.</span><span class="n">with_pixel_mask_filenames</span><span class="p">(</span><span class="n">workflow</span><span class="p">,</span> <span class="p">[])</span>
</pre></div>
</div>
</div>
<p>Looking at the graph, we can see that this only differs from the histogrammed monitor normalization in how <code class="docutils literal notranslate"><span class="pre">NormalizedRunData</span></code> is computed:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">workflow</span><span class="o">.</span><span class="n">visualize</span><span class="p">(</span><span class="n">IofDspacing</span><span class="p">[</span><span class="n">SampleRun</span><span class="p">],</span> <span class="n">graph_attr</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;rankdir&quot;</span><span class="p">:</span> <span class="s2">&quot;LR&quot;</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../../_images/user-guide_dream_dream-advanced-powder-reduction_14_0.svg" src="../../_images/user-guide_dream_dream-advanced-powder-reduction_14_0.svg" />
</div>
</div>
<p>And compute the result:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">workflow</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">IofDspacing</span><span class="p">[</span><span class="n">SampleRun</span><span class="p">])</span>
<span class="n">result</span><span class="o">.</span><span class="n">hist</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">result</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s1">&#39;detector&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">capitalize</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../../_images/user-guide_dream_dream-advanced-powder-reduction_16_0.svg" src="../../_images/user-guide_dream_dream-advanced-powder-reduction_16_0.svg" />
</div>
</div>
</section>
<section id="Normalize-by-proton-charge">
<h3>Normalize by proton charge<a class="headerlink" href="#Normalize-by-proton-charge" title="Link to this heading">#</a></h3>
<p>We can normalize the detector data by the accumulated proton charge. This works similarly to normalizing by a monitor, but we pass <code class="docutils literal notranslate"><span class="pre">ess.powder.RunNormalization.proton_charge</span></code> when building the workflow. This will insert <a class="reference internal" href="../../generated/modules/ess.powder.correction.normalize_by_proton_charge.html"><span class="doc">normalize_by_proton_charge</span></a> into the workflow.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">workflow</span> <span class="o">=</span> <span class="n">dream</span><span class="o">.</span><span class="n">DreamGeant4Workflow</span><span class="p">(</span><span class="n">run_norm</span><span class="o">=</span><span class="n">powder</span><span class="o">.</span><span class="n">RunNormalization</span><span class="o">.</span><span class="n">proton_charge</span><span class="p">)</span>

<span class="n">workflow</span><span class="p">[</span><span class="n">Filename</span><span class="p">[</span><span class="n">SampleRun</span><span class="p">]]</span> <span class="o">=</span> <span class="n">dream</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">simulated_diamond_sample</span><span class="p">()</span>
<span class="n">workflow</span><span class="p">[</span><span class="n">Filename</span><span class="p">[</span><span class="n">VanadiumRun</span><span class="p">]]</span> <span class="o">=</span> <span class="n">dream</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">simulated_vanadium_sample</span><span class="p">()</span>
<span class="n">workflow</span><span class="p">[</span><span class="n">Filename</span><span class="p">[</span><span class="n">EmptyCanRun</span><span class="p">]]</span> <span class="o">=</span> <span class="n">dream</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">simulated_empty_can</span><span class="p">()</span>
<span class="n">workflow</span><span class="p">[</span><span class="n">CalibrationFilename</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

<span class="n">workflow</span><span class="p">[</span><span class="n">dream</span><span class="o">.</span><span class="n">InstrumentConfiguration</span><span class="p">]</span> <span class="o">=</span> <span class="n">dream</span><span class="o">.</span><span class="n">InstrumentConfiguration</span><span class="o">.</span><span class="n">high_flux</span>
<span class="c1"># Select a detector bank:</span>
<span class="n">workflow</span><span class="p">[</span><span class="n">NeXusDetectorName</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;mantle&quot;</span>
<span class="c1"># We drop uncertainties where they would otherwise lead to correlations:</span>
<span class="n">workflow</span><span class="p">[</span><span class="n">UncertaintyBroadcastMode</span><span class="p">]</span> <span class="o">=</span> <span class="n">UncertaintyBroadcastMode</span><span class="o">.</span><span class="n">drop</span>
<span class="c1"># Edges for binning in d-spacing:</span>
<span class="n">workflow</span><span class="p">[</span><span class="n">DspacingBins</span><span class="p">]</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="s2">&quot;dspacing&quot;</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">2.3434</span><span class="p">,</span> <span class="mi">201</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;angstrom&quot;</span><span class="p">)</span>

<span class="c1"># Do not mask any pixels / voxels:</span>
<span class="n">workflow</span> <span class="o">=</span> <span class="n">powder</span><span class="o">.</span><span class="n">with_pixel_mask_filenames</span><span class="p">(</span><span class="n">workflow</span><span class="p">,</span> <span class="p">[])</span>
</pre></div>
</div>
</div>
<p>Looking at the graph, we can see that this differs from the monitor normalizations in how <code class="docutils literal notranslate"><span class="pre">NormalizedRunData</span></code> is computed. And since we don’t need them here, the monitor providers and parameters are not in the graph:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">workflow</span><span class="o">.</span><span class="n">visualize</span><span class="p">(</span><span class="n">IofDspacing</span><span class="p">[</span><span class="n">SampleRun</span><span class="p">],</span> <span class="n">graph_attr</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;rankdir&quot;</span><span class="p">:</span> <span class="s2">&quot;LR&quot;</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../../_images/user-guide_dream_dream-advanced-powder-reduction_20_0.svg" src="../../_images/user-guide_dream_dream-advanced-powder-reduction_20_0.svg" />
</div>
</div>
<p>And compute the result as normal:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">workflow</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">IofDspacing</span><span class="p">[</span><span class="n">SampleRun</span><span class="p">])</span>
<span class="n">result</span><span class="o">.</span><span class="n">hist</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">result</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s1">&#39;detector&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">capitalize</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../../_images/user-guide_dream_dream-advanced-powder-reduction_22_0.svg" src="../../_images/user-guide_dream_dream-advanced-powder-reduction_22_0.svg" />
</div>
</div>
</section>
</section>
<section id="Compute-intermediate-results">
<h2>Compute intermediate results<a class="headerlink" href="#Compute-intermediate-results" title="Link to this heading">#</a></h2>
<p>For inspection and debugging purposes, we can also compute intermediate results. To avoid repeated computation (including costly loading of files), we can request multiple results at once, including the final result, if desired. For example:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">intermediates</span> <span class="o">=</span> <span class="n">workflow</span><span class="o">.</span><span class="n">compute</span><span class="p">((</span><span class="n">CountsWavelength</span><span class="p">[</span><span class="n">SampleRun</span><span class="p">],</span> <span class="n">MaskedData</span><span class="p">[</span><span class="n">SampleRun</span><span class="p">]))</span>
<span class="n">intermediates</span><span class="p">[</span><span class="n">CountsWavelength</span><span class="p">[</span><span class="n">SampleRun</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><!-- Original source from -->
<!-- https://github.com/jsignell/xarray/blob/1d960933ab252e0f79f7e050e6c9261d55568057/xarray/static/html/icons-svg-inline.html -->
<svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<title>Show/Hide data repr</title>
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<title>Show/Hide attributes</title>
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg><style id="scipp-style-sheet">.sc-root{--sc-background-color0:var(--jp-layout-color0,#fff);--sc-background-color1:var(--jp-layout-color1,#fcfcfc);--sc-background-color2:var(--jp-layout-color2,#efefef);--sc-inverse-background-color0:var(--jp-inverse-layout-color4,#111);--sc-font-color0:var(--jp-content-font-color0,#000);--sc-font-color1:var(--jp-content-font-color1,#555);--sc-font-color2:var(--jp-content-font-color2,#888);--sc-font-color3:var(--jp-content-font-color3,#ccc);}body.vscode-dark .sc-root{--sc-font-color0:rgba(255,255,255,1);--sc-font-color1:rgba(255,255,255,0.70);--sc-font-color2:rgba(255,255,255,0.54);--sc-font-color3:rgba(255,255,255,0.38);--sc-border-color:#1F1F1F;--sc-disabled-color:#515151;--sc-background-color0:#111111;--sc-background-color1:#111111;--sc-background-color2:#313131;}.sc-wrap{font-size:14px;min-width:300px;max-width:800px;}.sc-var-attrs .sc-wrap{padding-left:3em;}.sc-header{padding-top:6px;padding-bottom:6px;margin-bottom:4px;border-bottom:solid 1px #ddd;}.sc-header > div,.sc-header > ul{display:inline;margin-top:0;margin-bottom:0;}.sc-obj-type,.sc-array-name{margin-left:2px;margin-right:10px;}.sc-obj-type{color:var(--sc-font-color1);}.sc-underlying-size{color:var(--sc-font-color2);}.sc-sections,.reveal .sc-sections{padding-left:0 !important;display:grid;grid-template-columns:150px auto auto auto 1fr 20px 20px;}.sc-section-item{display:contents;}.sc-section-item input{display:none;}.sc-section-item input:enabled + label{cursor:pointer;color:var(--sc-font-color1);}.sc-section-item input:enabled + label:hover{color:var(--sc-font-color0);}.sc-section-summary{grid-column:1;font-weight:500;}.sc-section-summary > span{display:inline-block;padding-left:0.5em;}.sc-section-summary-in:disabled + label{color:var(--sc-font-color1);}.sc-section-summary-in + label:before{display:inline-block;content:'►';font-size:11px;width:15px;text-align:center;}.sc-section-summary-in:disabled + label:before{color:var(--sc-font-color3);}.sc-section-summary-in:checked + label:before{content:'▼';}.sc-section-summary-in:checked + label > span{display:none;}.sc-section-summary,.sc-section-inline-details{padding-top:4px;padding-bottom:4px;}.sc-section-inline-details{grid-column:2 / 6;}.sc-section-details{display:none;grid-column:1 / -1;margin-bottom:5px;}.sc-section-summary-in:checked ~ .sc-section-details{display:contents;}.sc-array-wrap{grid-column:1 / -1;display:grid;grid-template-columns:20px auto;}.sc-array-wrap > label{grid-column:1;vertical-align:top;}.sc-preview{color:var(--sc-font-color2);}.sc-array-preview,.sc-array-data{padding:0 5px !important;grid-column:2;}.sc-array-data,.sc-array-in:checked ~ .sc-array-preview{display:none;}.sc-array-in:checked ~ .sc-array-data,.sc-array-preview{display:inline-block;}.sc-dim-list{display:inline-block !important;list-style:none;padding:0 !important;margin:0;}.sc-dim-list li{display:inline-block;padding:0;margin:0!important;}.sc-dim-list:before{content:'(';}.sc-dim-list:after{content:')';}.sc-dim-list li:not(:last-child):after{content:',';padding-right:5px;}.sc-dim-list li span,.sc-standalone-var-name > span span,.sc-var-name > span span{padding:0 !important;}.sc-aligned{font-weight:bold;}.sc-var-list,.sc-var-item,.reveal .sc-var-list,.reveal .sc-var-item{display:contents;}.sc-var-item > div,.sc-var-item label,.sc-var-item > .sc-var-name span{background-color:var(--sc-background-color1);margin-bottom:0;}.sc-var-item > .sc-var-name:hover span{padding-right:5px;}.sc-var-list > li:nth-child(odd) > div,.sc-var-list > li:nth-child(odd) > label,.sc-var-list > li:nth-child(odd) > .sc-var-name span{background-color:var(--sc-background-color2);}.sc-var-name{grid-column:1;}.sc-var-dims{grid-column:2;}.sc-var-dtype{grid-column:3;text-align:right;color:var(--sc-font-color2);}.sc-var-unit{grid-column:4;text-align:left;color:var(--sc-font-color1);max-width:50pt;text-overflow:ellipsis;}.sc-value-preview{grid-column:5;}.sc-var-preview-variances{text-align:right;}.sc-sections .sc-section-item .sc-section-summary,.sc-sections .sc-section-item .sc-section-inline-details,.sc-section-item .sc-var-list .sc-var-item > div,.sc-section-item .sc-var-list .sc-var-item > label,.sc-section-details .sc-var-list .sc-var-item > div,.sc-section-details .sc-var-list .sc-var-item > label{margin-top:0;margin-bottom:0;}.sc-var-name,.sc-var-dims,.sc-var-dtype,.sc-var-unit,.sc-preview,.sc-attrs dt{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;padding-right:10px;}.sc-var-name:hover,.sc-var-dims:hover,.sc-var-dtype:hover,.sc-var-unit:hover,.sc-attrs dt:hover{overflow:visible;width:auto;z-index:1;}.sc-var-attrs{display:block;}.sc-var-data,.reveal .sc-var-data{display:none;}.sc-var-attrs,.sc-var-data{background-color:var(--sc-background-color0) !important;padding-bottom:5px !important;}.sc-var-attrs-in:checked ~ .sc-var-attrs{display:none;}.sc-var-data-in:checked ~ .sc-var-data{display:block;}.sc-var-data > table{float:right;}.sc-var-name span,.sc-var-data{padding-left:25px !important;}.sc-var-attrs,.sc-var-data{grid-column:1 / -1;}dl.sc-attrs{padding:0;margin:0;display:grid;grid-template-columns:125px auto;}.sc-attrs dt,dd{padding:0;margin:0;float:left;padding-right:10px;width:auto;}.sc-attrs dt{font-weight:normal;grid-column:1;}.sc-attrs dt:hover span{display:inline-block;padding-right:10px;}.sc-attrs dd{grid-column:2;white-space:pre-wrap;word-break:break-all;}.sc-icon-database,.sc-icon-file-text2{display:inline-block;vertical-align:middle;width:1em;height:1.5em !important;stroke-width:0;stroke:currentColor;fill:currentColor;}label.sc-hide-icon svg{opacity:0;}.sc-standalone-var-name{grid-column:1/3;}.sc-standalone-var-name span{padding-left:25px;padding-right:10px;}.sc-title{font-weight:bold;font-size:1.5em;}.sc-subtitle{font-weight:normal;font-style:italic;text-align:left;font-size:1.2em;padding:1px;}.sc-label{fill:var(--sc-font-color0,#444444);text-anchor:middle;}.sc-name{fill:var(--sc-font-color0,#111111);}.sc-inset-line{stroke:var(--sc-font-color1);stroke-width:0.05;stroke-dasharray:0.2,0.2;}.sc-log-wrap{height:25ex;resize:vertical;overflow-y:scroll;display:flex;flex-direction:column-reverse;border:1px solid;border-color:var(--jp-border-color2);background-color:var(--sc-background-color1);}div.sc-log{line-height:2.5ex;}table.sc-log{table-layout:auto;border-collapse:collapse;}tr.sc-log:nth-child(even){background-color:var(--sc-background-color0);}tr.sc-log > td{vertical-align:top;padding-bottom:0.5ex;}.sc-log-time-stamp{min-width:22ch;font-family:var(--jp-code-font-family);color:var(--sc-font-color2);}.sc-log-level{min-width:10ch;}tr.sc-log-debug td.sc-log-level{color:var(--jp-accent-color1);}tr.sc-log-info td.sc-log-level{color:var(--jp-info-color1);}tr.sc-log-warning td.sc-log-level{color:var(--jp-warn-color1);}tr.sc-log-error td.sc-log-level{font-weight:bold;color:var(--jp-error-color2);}tr.sc-log-critical td.sc-log-level{font-weight:bold;color:var(--sc-background-color0);background-color:var(--jp-error-color1);}.sc-log-message{white-space:pre-wrap;width:100%;}.sc-log-html-payload{white-space:normal;}.sc-log-name{padding-right:0.5em;text-align:right;white-space:pre-wrap;color:var(--sc-font-color3);}</style><div class='sc-wrap sc-root'><div class='sc-header'><div class='sc-obj-type'>scipp.DataArray (132.01 MB)</div></div><ul class='sc-sections'><li class='sc-section-item'><input id='section-757f37c2-c422-406e-8b25-1bea9173fc99' class='sc-section-summary-in' type='checkbox' disabled ><label for='section-757f37c2-c422-406e-8b25-1bea9173fc99' class='sc-section-summary' >Dimensions:</label><div class='sc-section-inline-details'><ul class='sc-dim-list'><li><span class='sc-has-index'>module</span>: 14</li><li><span class='sc-has-index'>segment</span>: 6</li><li><span class='sc-has-index'>counter</span>: 2</li><li><span class='sc-has-index'>wire</span>: 32</li><li><span class='sc-has-index'>strip</span>: 256</li></ul></div><div class='sc-section-details'></div></li><li class='sc-section-item'><input id='section-2b360744-c8b3-436b-8c87-849d5cb8a48c' class='sc-section-summary-in' type='checkbox'  checked><label for='section-2b360744-c8b3-436b-8c87-849d5cb8a48c' class='sc-section-summary'  title='Expand/collapse section'>Coordinates: <span>(12)</span></label><div class='sc-section-inline-details'></div><div class='sc-section-details'><ul class='sc-var-list'><li class='sc-var-item'><div class='sc-var-name'><span class='sc-aligned'>Ltotal</span></div><div class='sc-var-dims'>(module, segment, counter, wire, strip)</div><div class='sc-var-dtype'>float64</div><div class='sc-var-unit'>m</div><div class='sc-value-preview sc-preview'><span><div>78.094, 78.087, ..., nan, nan</div></span></div><input id='attrs-d1078d93-9c40-473f-9835-8aa61209d71d' class='sc-var-attrs-in' type='checkbox' disabled><label for='attrs-d1078d93-9c40-473f-9835-8aa61209d71d' class='sc-hide-icon' title='Show/Hide attributes'><svg class='icon sc-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2c402e47-49f6-4674-b836-bf97c3ae4511' class='sc-var-data-in' type='checkbox'><label for='data-2c402e47-49f6-4674-b836-bf97c3ae4511' title='Show/Hide data repr'><svg class='icon sc-icon-database'><use xlink:href='#icon-database'></use></svg></label><pre class='sc-var-data'>Values:<br>array([[[[[78.09353192, 78.08724455, 78.08007163, ..., 78.07881498,
           78.0822229 , 78.0961299 ],
          [78.11211562, 78.10224832, 78.0970006 , ..., 78.0890558 ,
           78.11010604, 78.11545208],
          [78.13157461, 78.11268494, 78.11260326, ..., 78.10500882,
           78.11358997, 78.12061625],
          ...,
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [78.58232161,         nan,         nan, ...,         nan,
                   nan,         nan],
          [78.58439177,         nan,         nan, ...,         nan,
                   nan,         nan]],

         [[78.09562756, 78.0906564 , 78.08714016, ..., 78.08105659,
           78.08411444, 78.09686108],
          [78.11584058, 78.10475828, 78.09368879, ..., 78.09470906,
                   nan, 78.10590356],
          [78.12995439, 78.11726431, 78.1073029 , ..., 78.11180777,
           78.12124673, 78.13089495],
          ...,
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan]]],


        [[[78.09666379, 78.08506182, 78.07834251, ..., 78.07052851,
           78.0862317 , 78.09467171],
          [78.11778202, 78.10494508, 78.09033609, ...,         nan,
           78.10518863, 78.10910583],
          [78.12678381, 78.12100735, 78.11016968, ..., 78.11671669,
           78.11461074, 78.13695345],
          ...,
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [78.58007696, 78.5800502 ,         nan, ..., 78.56872863,
                   nan,         nan]],

         [[78.0918974 , 78.08393601, 78.07577368, ..., 78.07631989,
           78.08148493, 78.09804977],
          [78.12142753,         nan, 78.09591705, ..., 78.10006498,
                   nan, 78.12167241],
          [78.12450571, 78.12410123, 78.11582984, ..., 78.10950341,
           78.12887402, 78.125578  ],
          ...,
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan, 78.5726663 , ...,         nan,
                   nan,         nan]]],


        [[[78.09825732, 78.08428361, 78.07974809, ..., 78.0772432 ,
           78.08200152, 78.09489719],
          [78.11538007, 78.1008633 , 78.08706413, ..., 78.09290815,
           78.10241374, 78.10487638],
          [78.12716345, 78.12075022, 78.11371519, ..., 78.11643254,
           78.12495359, 78.12834606],
          ...,
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan, 78.56476232,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan]],

         [[78.09832608, 78.08454577, 78.0731779 , ..., 78.0769811 ,
           78.07687784, 78.09592803],
          [78.11861393, 78.09769811, 78.09670356, ..., 78.09701443,
           78.107023  , 78.11383831],
          [78.12999897, 78.12352999, 78.11056968, ..., 78.10843182,
           78.11739872,         nan],
          ...,
          [78.56269283,         nan,         nan, ...,         nan,
                   nan, 78.55314306],
          [        nan, 78.55170333, 78.55308413, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan]]],


        [[[78.09550552, 78.08521319, 78.07389579, ..., 78.07852434,
           78.08649906, 78.09067007],
          [78.11491606, 78.10025391, 78.09735902, ..., 78.095549  ,
           78.10267154, 78.11599041],
          [78.12986598, 78.11477834, 78.10410277, ..., 78.10399251,
           78.11567056, 78.12234179],
          ...,
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ..., 78.55879894,
                   nan,         nan]],

         [[78.09756815, 78.08818705, 78.07490663, ..., 78.07724517,
                   nan, 78.10844817],
          [78.11142262, 78.10829302, 78.09523166, ...,         nan,
                   nan, 78.11328071],
          [78.12182547, 78.11850694, 78.10964661, ..., 78.10940647,
           78.1131038 ,         nan],
          ...,
          [78.56171664,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan, 78.57633871, ...,         nan,
                   nan,         nan]]],


        [[[78.09753546, 78.08328423, 78.07307496, ..., 78.07843776,
           78.0852982 , 78.0982067 ],
          [78.12105514, 78.10275222, 78.09772051, ..., 78.09117731,
           78.10177913, 78.11254353],
          [78.12947303, 78.1182776 , 78.10668863, ..., 78.10556816,
                   nan, 78.12843155],
          ...,
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan]],

         [[78.09642175, 78.08667098, 78.07847736, ..., 78.07679129,
           78.0913415 , 78.09601817],
          [78.11359311, 78.1046185 , 78.09212086, ..., 78.0974291 ,
           78.09623198, 78.10770553],
          [78.12802759, 78.12156504, 78.1154692 , ..., 78.10734669,
                   nan, 78.1307899 ],
          ...,
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan]]],


        [[[78.09261629, 78.08442844, 78.07820029, ..., 78.0877764 ,
           78.08841451, 78.09903279],
          [78.11472846, 78.09580409, 78.08793942, ...,         nan,
           78.10635032, 78.11774171],
          [78.1315256 , 78.12275745, 78.11234304, ..., 78.11064015,
           78.11421356, 78.12882173],
          ...,
          [78.55486544, 78.54073713, 78.52764431, ..., 78.53173516,
           78.54787797, 78.55283595],
          [78.5781029 , 78.55704622, 78.56070883, ...,         nan,
                   nan,         nan],
          [78.59350621, 78.58505854, 78.56210171, ...,         nan,
                   nan, 78.59544187]],

         [[78.0944726 , 78.08624281, 78.07831263, ...,         nan,
           78.09098196, 78.09482332],
          [78.11297099, 78.10258443, 78.09358953, ..., 78.08747797,
           78.11193613, 78.11255626],
          [78.13379674, 78.12016925, 78.1152532 , ..., 78.11491187,
           78.1199969 , 78.13722645],
          ...,
          [        nan,         nan,         nan, ..., 78.54077595,
                   nan,         nan],
          [78.57556264, 78.55507605, 78.55507031, ...,         nan,
                   nan, 78.58067774],
          [78.60143138,         nan,         nan, ...,         nan,
                   nan, 78.58617001]]]],



       [[[[78.0986271 , 78.0891695 , 78.07759664, ..., 78.07463229,
           78.08656751,         nan],
          [78.11425253, 78.10246359, 78.09522743, ...,         nan,
           78.10091709, 78.11050867],
          [78.13096533, 78.12192857, 78.10361806, ...,         nan,
                   nan, 78.13215085],
          ...,
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [78.59530131, 78.58355562,         nan, ...,         nan,
                   nan,         nan]],

         [[78.1009973 , 78.08669826, 78.08129096, ..., 78.07064883,
                   nan, 78.09960862],
          [78.11031814, 78.10142293, 78.08970023, ..., 78.09939266,
           78.10251595, 78.10496555],
          [78.12883485, 78.12215636, 78.11138644, ...,         nan,
                   nan, 78.13376798],
          ...,
          [78.57315242,         nan,         nan, ...,         nan,
                   nan,         nan],
          [78.57281039,         nan, 78.55501879, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan, 78.59200565]]],


        [[[78.09824258, 78.08409799, 78.07314041, ..., 78.07837256,
           78.08267103, 78.0972629 ],
          [78.11134343, 78.1013329 , 78.09220451, ..., 78.08526527,
           78.10334996, 78.10980917],
          [78.13197175, 78.1181209 , 78.10890212, ..., 78.11323099,
           78.12005321, 78.13058005],
          ...,
          [78.56411737,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan]],

         [[78.09609079, 78.0847431 , 78.0785323 , ..., 78.07573612,
           78.08308196, 78.09658766],
          [78.1171468 , 78.10223877, 78.0939443 , ..., 78.09771554,
                   nan, 78.11432422],
          [78.12883896, 78.11849704, 78.11087846, ...,         nan,
                   nan, 78.12266728],
          ...,
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan]]],


        [[[78.09839683, 78.08445785, 78.07356488, ..., 78.07487628,
           78.08456536, 78.09734945],
          [78.11367449, 78.10633582, 78.09198138, ...,         nan,
           78.10888029, 78.11596889],
          [78.12033625, 78.11959622, 78.11503345, ...,         nan,
                   nan, 78.12390651],
          ...,
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan]],

         [[78.10214627, 78.08538804, 78.07787748, ..., 78.07793813,
           78.08399054, 78.10729176],
          [78.11698983, 78.10346883, 78.09127647, ..., 78.0985825 ,
           78.10519957, 78.11597861],
          [78.13190055, 78.11846676, 78.10188986, ..., 78.10210821,
           78.11800568, 78.12753663],
          ...,
          [        nan,         nan, 78.53378185, ...,         nan,
                   nan, 78.57077099],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [78.58726774,         nan,         nan, ...,         nan,
                   nan,         nan]]],


        [[[78.0990167 , 78.08477373, 78.07657852, ..., 78.0737939 ,
           78.08093863, 78.09888502],
          [78.11120978, 78.10062186, 78.09415335, ..., 78.09450234,
                   nan, 78.11118568],
          [78.127957  , 78.12051866, 78.10880671, ...,         nan,
           78.10987613, 78.13150699],
          ...,
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [78.5749323 , 78.56003254, 78.55535975, ...,         nan,
                   nan,         nan],
          [78.59091784, 78.5910816 ,         nan, ...,         nan,
                   nan,         nan]],

         [[78.10331419, 78.08954841, 78.0801283 , ..., 78.07510993,
                   nan, 78.09332644],
          [78.11014519, 78.10450609, 78.09142354, ..., 78.0987913 ,
           78.10108182, 78.11884304],
          [78.13147304, 78.1156144 , 78.11310492, ..., 78.11315582,
           78.12089618, 78.12707776],
          ...,
          [78.55863641,         nan, 78.52395385, ...,         nan,
                   nan,         nan],
          [78.57914293,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan]]],


        [[[78.0955861 , 78.08807754, 78.07630668, ..., 78.07662161,
           78.07729044, 78.10341765],
          [78.11176077, 78.10367727, 78.09485484, ..., 78.08226568,
           78.1115086 , 78.11040814],
          [78.13059305, 78.12429991, 78.1067779 , ...,         nan,
           78.11123094, 78.12280359],
          ...,
          [        nan,         nan, 78.53225321, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan]],

         [[78.10172735, 78.08995884, 78.08140178, ..., 78.08125198,
           78.08894668,         nan],
          [78.11689287, 78.10252847, 78.0916671 , ..., 78.08989849,
                   nan, 78.12183584],
          [78.13062056, 78.12208436,         nan, ..., 78.11422124,
                   nan, 78.13234556],
          ...,
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan]]],


        [[[78.09340023, 78.08280846, 78.07478919, ...,         nan,
           78.08166084, 78.09629413],
          [78.11314262, 78.10097613, 78.09461915, ..., 78.08632514,
                   nan, 78.12299834],
          [78.12802485, 78.1199669 , 78.10428404, ...,         nan,
           78.12189691, 78.13403348],
          ...,
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan, 78.58599462,         nan, ...,         nan,
                   nan,         nan]],

         [[78.09928196, 78.0874412 , 78.07566916, ...,         nan,
           78.08464634, 78.1011004 ],
          [78.11935365, 78.10365072, 78.09464119, ..., 78.09568734,
           78.10088574, 78.11276724],
          [78.1303223 , 78.11965106, 78.1154324 , ..., 78.11218822,
                   nan, 78.12662078],
          ...,
          [78.57211419,         nan,         nan, ...,         nan,
                   nan,         nan],
          [78.57250505,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan]]]],



       [[[[78.09907883, 78.07917446, 78.07662726, ..., 78.07229022,
           78.08149671, 78.08823262],
          [78.11253151, 78.09825617, 78.08757297, ..., 78.09223617,
                   nan, 78.12361634],
          [78.13110229, 78.11596566, 78.10797539, ..., 78.11159684,
           78.11171989, 78.12617354],
          ...,
          [        nan,         nan,         nan, ...,         nan,
                   nan, 78.55719549],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
           78.58644824, 78.58280182]],

         [[78.0982578 , 78.08892425, 78.08853396, ..., 78.07918763,
           78.08470932, 78.09943736],
          [78.11667459, 78.10435745, 78.09880102, ..., 78.09069539,
                   nan, 78.11240715],
          [78.13486315, 78.1216596 , 78.11107971, ...,         nan,
           78.121272  , 78.12992055],
          ...,
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan]]],


        [[[78.09179633, 78.08687495, 78.07792211, ..., 78.07802825,
           78.08171417, 78.10387699],
          [78.11643681, 78.10134395, 78.09320572, ..., 78.08757279,
           78.10594709, 78.10926382],
          [78.1239915 , 78.11863128, 78.10943857, ..., 78.10772672,
           78.10990677, 78.12672568],
          ...,
          [        nan, 78.55362564,         nan, ...,         nan,
                   nan,         nan],
          [78.58274769, 78.55323887,         nan, ...,         nan,
                   nan,         nan],
          [78.58482583,         nan,         nan, ...,         nan,
                   nan,         nan]],

         [[78.09714021, 78.08525934, 78.07139042, ..., 78.07209742,
           78.0833164 , 78.09429493],
          [78.1150939 , 78.10782561, 78.09438256, ..., 78.10031067,
           78.11293236, 78.11414014],
          [78.1320731 , 78.11659208, 78.10796348, ..., 78.10029331,
           78.11622968, 78.13692871],
          ...,
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan, 78.57894885],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan]]],


        [[[78.09528693, 78.08207512, 78.0798045 , ..., 78.07741306,
           78.08552518, 78.08419324],
          [78.11376297, 78.09991444, 78.09831816, ..., 78.09014644,
                   nan, 78.11377405],
          [78.12998236, 78.12137937, 78.11096907, ..., 78.110247  ,
                   nan, 78.13505972],
          ...,
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [78.60310577,         nan,         nan, ...,         nan,
                   nan, 78.60007002]],

         [[78.10289205, 78.09057887, 78.07936357, ..., 78.07278444,
           78.08694023, 78.08998778],
          [78.11413502, 78.10045375, 78.09501143, ...,         nan,
           78.11134402, 78.11346667],
          [78.13398423, 78.12711195, 78.1074799 , ..., 78.1109577 ,
                   nan, 78.13740336],
          ...,
          [        nan,         nan,         nan, ..., 78.54346847,
           78.5421962 ,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [78.59816089,         nan,         nan, ...,         nan,
                   nan,         nan]]],


        [[[78.09172287, 78.08738461, 78.08266798, ..., 78.07880844,
           78.08493703, 78.09127466],
          [78.11405263, 78.10041477, 78.09472348, ...,         nan,
                   nan, 78.11862754],
          [78.12878156, 78.12089576, 78.11523426, ...,         nan,
                   nan, 78.13143949],
          ...,
          [        nan, 78.53588134, 78.53831146, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan]],

         [[78.09522049, 78.09019074, 78.07718295, ..., 78.07889846,
           78.08157509, 78.09790134],
          [78.11644111, 78.11204717, 78.10076185, ..., 78.09382338,
                   nan, 78.11774109],
          [78.12744137, 78.12408283, 78.11246526, ..., 78.10773452,
                   nan, 78.12030313],
          ...,
          [        nan,         nan,         nan, ...,         nan,
                   nan, 78.56388677],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan]]],


        [[[78.09530903, 78.08389538, 78.07992276, ..., 78.0805208 ,
           78.09169779, 78.09924692],
          [78.11037916, 78.10649002, 78.09316229, ..., 78.09359875,
           78.10134483, 78.10586951],
          [78.13152588, 78.11290339, 78.10983758, ..., 78.11465918,
                   nan, 78.12996768],
          ...,
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan, 78.55075812, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan]],

         [[78.09605101, 78.09003811, 78.08216557, ..., 78.07599861,
           78.08801885, 78.08882629],
          [78.10964957, 78.1083536 , 78.09231931, ..., 78.09381329,
           78.09561804, 78.11759174],
          [78.12837521, 78.11959327, 78.11838482, ..., 78.11103852,
           78.11284492, 78.12557815],
          ...,
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [78.58582132, 78.56220785, 78.56222387, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan, 78.60420252]]],


        [[[78.09824136, 78.08824553, 78.07539549, ..., 78.07509184,
                   nan, 78.0949705 ],
          [78.10999014, 78.10203439, 78.09503949, ...,         nan,
           78.10076008, 78.10100233],
          [78.1318335 , 78.12414748, 78.11308544, ...,         nan,
           78.12270698, 78.12350984],
          ...,
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [78.57811842,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan]],

         [[78.09397561, 78.08512425, 78.07656848, ...,         nan,
           78.09441412, 78.10090837],
          [78.11970885, 78.10260845, 78.08837998, ...,         nan,
           78.09453209, 78.11884638],
          [78.12939622, 78.12020055,         nan, ...,         nan,
           78.1249103 , 78.12499935],
          ...,
          [        nan,         nan,         nan, ...,         nan,
                   nan, 78.56453494],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan]]]],



       ...,



       [[[[78.09450157, 78.08973286, 78.0736328 , ..., 78.08298428,
           78.08700417, 78.096074  ],
          [78.11526821, 78.1056822 , 78.1049537 , ...,         nan,
           78.11124344, 78.11479961],
          [78.12594446, 78.11569418, 78.1104385 , ..., 78.11293725,
           78.12636949, 78.13107094],
          ...,
          [        nan,         nan, 78.53900342, ...,         nan,
                   nan, 78.56114375],
          [78.57679788,         nan, 78.54651765, ...,         nan,
                   nan,         nan],
          [78.58320878,         nan, 78.57018007, ...,         nan,
                   nan,         nan]],

         [[78.09702532, 78.09072283, 78.07449239, ..., 78.07461631,
                   nan, 78.10082567],
          [78.11752015, 78.10762526, 78.09412618, ..., 78.09494318,
           78.10960903,         nan],
          [78.12978108, 78.12246651, 78.10205744, ..., 78.11813124,
           78.11348024, 78.13470563],
          ...,
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [78.59829551,         nan, 78.5714681 , ...,         nan,
                   nan,         nan]]],


        [[[78.09612124, 78.08317731, 78.07497645, ..., 78.07349967,
           78.09304805, 78.08982707],
          [78.1101565 , 78.10537742, 78.08657346, ..., 78.08993959,
           78.09294874, 78.11380256],
          [78.12923026, 78.11865197, 78.11390603, ...,         nan,
           78.1265596 , 78.12310561],
          ...,
          [        nan,         nan,         nan, ...,         nan,
           78.54769249,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan]],

         [[78.08825772, 78.08824795, 78.0755086 , ..., 78.08185197,
           78.09667479, 78.09021422],
          [78.1209123 , 78.10081568, 78.0870305 , ...,         nan,
           78.11137558, 78.11656613],
          [78.13539407, 78.12618147, 78.10409142, ..., 78.11620673,
           78.11607734, 78.12721197],
          ...,
          [78.56717585,         nan, 78.54406734, ...,         nan,
                   nan,         nan],
          [        nan,         nan, 78.54760285, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan]]],


        [[[78.09407955, 78.08637466, 78.07069134, ..., 78.07450422,
           78.07797323,         nan],
          [78.11403958, 78.10040729, 78.09723073, ..., 78.09465767,
           78.10018475, 78.12223787],
          [78.12617034, 78.12294287, 78.11055774, ..., 78.09783202,
           78.11686555, 78.1259093 ],
          ...,
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan]],

         [[78.09575543, 78.08414666, 78.07771115, ..., 78.08227481,
           78.0846468 , 78.09539139],
          [78.12329043, 78.09742468, 78.09336977, ..., 78.09943303,
                   nan,         nan],
          [78.13047455, 78.13130975, 78.11398496, ..., 78.10588554,
           78.12892463,         nan],
          ...,
          [        nan, 78.54421637,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ..., 78.57302038,
                   nan,         nan]]],


        [[[78.09561716, 78.08250372, 78.07655867, ..., 78.07511789,
           78.08415783,         nan],
          [78.11946196, 78.1065404 , 78.09227274, ..., 78.08986789,
           78.10665184, 78.12033138],
          [78.13310426,         nan, 78.10676906, ..., 78.10796045,
           78.11065932, 78.12297316],
          ...,
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
           78.57071071,         nan],
          [        nan,         nan,         nan, ...,         nan,
           78.57243342,         nan]],

         [[78.09649841, 78.08484865, 78.07416746, ..., 78.0766282 ,
           78.07747163, 78.09589421],
          [78.11209454, 78.09975086, 78.0981994 , ...,         nan,
                   nan, 78.12613309],
          [78.12769938, 78.12364792, 78.10691128, ..., 78.11690813,
                   nan, 78.13176963],
          ...,
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [78.59764752,         nan,         nan, ...,         nan,
                   nan,         nan]]],


        [[[78.09725759, 78.08404447, 78.07278078, ..., 78.07570992,
           78.07722915, 78.10017795],
          [78.11107488, 78.10334442, 78.0937145 , ..., 78.09419655,
           78.10408108,         nan],
          [78.13415475, 78.11813363, 78.11102704, ...,         nan,
                   nan, 78.13469862],
          ...,
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ..., 78.57696996,
           78.57644205,         nan]],

         [[78.09889515, 78.08882964, 78.07717163, ...,         nan,
           78.08899045, 78.10026688],
          [78.11139631, 78.10299715, 78.08832018, ...,         nan,
           78.10640257, 78.11854288],
          [78.13484282, 78.12121628, 78.10973131, ..., 78.1176805 ,
           78.11560863, 78.123899  ],
          ...,
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ..., 78.57731453,
                   nan,         nan]]],


        [[[78.09329835, 78.08503715, 78.07624265, ..., 78.08918245,
           78.08874622, 78.09502412],
          [78.10971698, 78.10390068, 78.09144057, ...,         nan,
           78.10975651,         nan],
          [78.12846731, 78.12141653, 78.11277476, ...,         nan,
           78.12756013, 78.12975659],
          ...,
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan, 78.55215182, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan]],

         [[78.09349604, 78.08504676, 78.07684253, ...,         nan,
           78.09027118, 78.09737639],
          [78.11548744, 78.0993476 , 78.09043448, ...,         nan,
           78.10660019, 78.11650227],
          [78.13571764,         nan,         nan, ..., 78.10763069,
           78.12000157, 78.13764717],
          ...,
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan, 78.54557784, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan]]]],



       [[[[78.09621685, 78.08552698, 78.07779344, ..., 78.08044069,
           78.08214636, 78.09630481],
          [78.11323335, 78.10401571, 78.09697751, ...,         nan,
                   nan, 78.1147461 ],
          [78.13336548, 78.1119361 , 78.11515343, ...,         nan,
                   nan, 78.13297049],
          ...,
          [        nan, 78.55485264,         nan, ...,         nan,
           78.54641026,         nan],
          [        nan, 78.55571103,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan]],

         [[78.09635051, 78.09124139, 78.07232057, ..., 78.07827495,
           78.09213445, 78.09767129],
          [78.1189891 , 78.11003926, 78.09610071, ..., 78.09109153,
           78.10655445, 78.1102424 ],
          [78.13533471, 78.12652708, 78.10951426, ..., 78.108232  ,
           78.11310845, 78.13629027],
          ...,
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan]]],


        [[[78.08556842, 78.08546567, 78.08178241, ..., 78.08092892,
           78.08308133, 78.09753045],
          [78.1196619 , 78.10051269, 78.09275877, ..., 78.1015975 ,
           78.10249126, 78.11254227],
          [78.12827284, 78.12025612, 78.11270834, ...,         nan,
           78.12690005, 78.13147028],
          ...,
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [78.57385635,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan]],

         [[78.09345851, 78.08587096, 78.07669876, ..., 78.08179874,
           78.0829517 , 78.10548205],
          [78.1148462 , 78.11233843, 78.10034666, ...,         nan,
           78.10635267, 78.11452483],
          [78.13038147, 78.11469042, 78.10637028, ..., 78.11669527,
           78.12134184, 78.12840974],
          ...,
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ..., 78.574662  ,
           78.57336056,         nan]]],


        [[[78.09694905, 78.08087508, 78.07826885, ...,         nan,
           78.08604625, 78.0909026 ],
          [78.11254132, 78.10668221, 78.09492959, ...,         nan,
           78.10091957, 78.11680355],
          [78.1276421 , 78.11898383, 78.10414461, ...,         nan,
           78.11723959, 78.13330506],
          ...,
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan]],

         [[78.09928016, 78.08632587, 78.08204318, ..., 78.07937135,
           78.08116728, 78.09378703],
          [78.10834198, 78.10825224, 78.08977742, ..., 78.09794866,
           78.10572942, 78.11186327],
          [78.12980918, 78.12086728, 78.11412379, ..., 78.11869903,
           78.12986938, 78.12869423],
          ...,
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [78.58720631,         nan,         nan, ...,         nan,
                   nan,         nan],
          [78.58832547,         nan,         nan, ...,         nan,
                   nan,         nan]]],


        [[[78.09703734, 78.08326347, 78.07926793, ...,         nan,
           78.09615192, 78.09892167],
          [78.11279979, 78.0997954 , 78.09110308, ...,         nan,
           78.10343808, 78.10890008],
          [78.13140289, 78.12364484, 78.10838369, ...,         nan,
           78.12085649, 78.13166756],
          ...,
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan, 78.58199573],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan]],

         [[78.09764723, 78.08659825, 78.08042187, ...,         nan,
           78.08449508, 78.10005754],
          [78.11248305, 78.10378078, 78.09506101, ..., 78.09867176,
           78.10398685,         nan],
          [78.13386017, 78.11925215, 78.11050574, ...,         nan,
                   nan, 78.13489562],
          ...,
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [78.57623604,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan]]],


        [[[78.0994971 , 78.08556509, 78.06980182, ...,         nan,
           78.08830596, 78.09304459],
          [78.1111834 , 78.10420303, 78.10285764, ...,         nan,
           78.10316749,         nan],
          [78.1277361 , 78.12003616, 78.1118    , ...,         nan,
                   nan, 78.13158635],
          ...,
          [78.56728503,         nan,         nan, ..., 78.53195486,
                   nan,         nan],
          [78.56894433,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan, 78.58202681,         nan, ...,         nan,
                   nan,         nan]],

         [[78.10006087, 78.08353853, 78.07851   , ..., 78.07299751,
           78.10054983, 78.09462173],
          [78.11544464, 78.10937449, 78.09825514, ..., 78.08626719,
           78.09932231,         nan],
          [78.13105738, 78.11781539, 78.11484289, ..., 78.11386811,
                   nan, 78.13331186],
          ...,
          [        nan,         nan, 78.54478747, ...,         nan,
                   nan,         nan],
          [78.57590049, 78.57493968,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan]]],


        [[[78.09708389, 78.08696649, 78.07843329, ...,         nan,
           78.09042216, 78.09922597],
          [78.10996578, 78.1020436 , 78.09543474, ...,         nan,
           78.10580336, 78.10603592],
          [78.12909433, 78.11849344, 78.10658737, ..., 78.11308526,
           78.11031556,         nan],
          ...,
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan, 78.57010483, ...,         nan,
                   nan,         nan]],

         [[78.10177149, 78.0883202 , 78.07861608, ..., 78.08092996,
                   nan, 78.10001749],
          [78.11365757, 78.10166419, 78.09720799, ..., 78.08601717,
           78.10206256, 78.1114669 ],
          [78.12955615, 78.12269453, 78.11639905, ...,         nan,
                   nan,         nan],
          ...,
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan]]]],



       [[[[78.09196649, 78.08740449, 78.07422869, ..., 78.06741033,
                   nan, 78.09010962],
          [78.11343662, 78.09941154, 78.09295358, ...,         nan,
           78.10440633, 78.11785903],
          [78.12655075, 78.12057169, 78.10871618, ..., 78.11039814,
           78.11156915, 78.12763731],
          ...,
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan]],

         [[78.09806538, 78.09005639, 78.07617592, ..., 78.08794906,
           78.08424651, 78.09597876],
          [78.1138803 , 78.10501612, 78.09484666, ..., 78.08882731,
           78.10963204, 78.11672408],
          [78.13532319, 78.11640787, 78.11299295, ..., 78.1100485 ,
           78.11456831, 78.12497918],
          ...,
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan, 78.57171276],
          [        nan,         nan,         nan, ..., 78.57305965,
                   nan,         nan]]],


        [[[78.09783647, 78.08486368, 78.0702799 , ..., 78.07371125,
           78.08460948, 78.09728023],
          [78.11173439, 78.10120026, 78.09617158, ...,         nan,
           78.10857113, 78.1117292 ],
          [78.12865977, 78.11680508, 78.11256731, ..., 78.114917  ,
           78.11734797,         nan],
          ...,
          [        nan,         nan,         nan, ..., 78.52604634,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan]],

         [[78.09808576, 78.0866746 , 78.07437078, ..., 78.07798901,
           78.08126021,         nan],
          [78.11440867, 78.1117017 ,         nan, ...,         nan,
           78.10138904,         nan],
          [78.12609999, 78.11496217, 78.11424865, ..., 78.1149037 ,
           78.1144613 , 78.12215024],
          ...,
          [        nan,         nan,         nan, ...,         nan,
           78.54972977,         nan],
          [        nan,         nan,         nan, ...,         nan,
           78.5497558 ,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan]]],


        [[[78.09510947, 78.08457203, 78.07519769, ..., 78.07817899,
                   nan, 78.10796821],
          [78.11375918, 78.11031903, 78.08256074, ..., 78.08212001,
           78.10454048, 78.11284972],
          [        nan, 78.11566813, 78.11802146, ..., 78.10677561,
                   nan, 78.12801082],
          ...,
          [        nan, 78.54395318,         nan, ...,         nan,
                   nan, 78.5633376 ],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan]],

         [[78.0935739 , 78.0882053 , 78.07817731, ..., 78.07650416,
           78.09116611, 78.0945846 ],
          [78.11158636, 78.10525026, 78.09129563, ..., 78.10569157,
           78.10739932, 78.12198405],
          [78.12842762, 78.12029525, 78.11307193, ...,         nan,
           78.12297117, 78.12148154],
          ...,
          [        nan,         nan,         nan, ...,         nan,
           78.54149934,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan]]],


        [[[78.09480687, 78.08250793, 78.07336538, ..., 78.08022603,
           78.08597946, 78.0965098 ],
          [78.11399259, 78.10139834, 78.0868675 , ..., 78.08910131,
           78.10725646, 78.11360603],
          [78.12856611, 78.12294801, 78.11320879, ..., 78.11671867,
           78.12749329, 78.13696618],
          ...,
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan]],

         [[78.09991502, 78.08943464, 78.07254043, ...,         nan,
                   nan, 78.10119318],
          [78.11148319, 78.10648595, 78.09872417, ..., 78.09078723,
                   nan, 78.1141551 ],
          [78.13543278, 78.11905429, 78.10782815, ..., 78.11244286,
           78.12143902, 78.12992446],
          ...,
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [78.5882003 ,         nan,         nan, ...,         nan,
                   nan,         nan],
          [78.59092606,         nan,         nan, ...,         nan,
                   nan,         nan]]],


        [[[78.09504902, 78.08490105, 78.0730371 , ...,         nan,
           78.07927356, 78.10006863],
          [78.11105633, 78.10230698, 78.09109662, ...,         nan,
           78.10015484, 78.11976011],
          [78.13000782, 78.12152126, 78.10689148, ..., 78.10920019,
           78.13078101, 78.12496646],
          ...,
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
           78.59104462,         nan]],

         [[78.09588075, 78.08489429, 78.07616996, ..., 78.07815091,
           78.09518083, 78.10030234],
          [78.12035031, 78.10566426, 78.09807599, ..., 78.09214794,
           78.10114889, 78.11705393],
          [78.13109474, 78.12280073, 78.11840502, ...,         nan,
           78.11872619, 78.13413465],
          ...,
          [78.55977206,         nan, 78.53273945, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan, 78.58923629]]],


        [[[78.0983407 , 78.08337553, 78.0750513 , ..., 78.07763044,
                   nan, 78.09054101],
          [78.11521563, 78.10174248, 78.09945285, ..., 78.09806893,
           78.10061451, 78.11182136],
          [78.12889792, 78.11543335, 78.11479541, ..., 78.11331097,
           78.115445  , 78.1305957 ],
          ...,
          [78.55095519,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan],
          [        nan,         nan, 78.55854625, ...,         nan,
                   nan,         nan]],

         [[78.09378314, 78.08160338, 78.0753767 , ..., 78.07212289,
                   nan, 78.10129169],
          [        nan, 78.10355889, 78.09585075, ...,         nan,
           78.1035306 , 78.10522435],
          [78.13009749, 78.12487997, 78.12118423, ...,         nan,
           78.12283078, 78.12986585],
          ...,
          [        nan,         nan, 78.53731547, ...,         nan,
                   nan,         nan],
          [        nan,         nan,         nan, ...,         nan,
           78.56174732,         nan],
          [        nan,         nan,         nan, ...,         nan,
                   nan,         nan]]]]], shape=(14, 6, 2, 32, 256))</pre></span></li><li class='sc-var-item'><div class='sc-var-name'><span class='sc-aligned'>counter</span></div><div class='sc-var-dims'>(counter)</div><div class='sc-var-dtype'>int64</div><div class='sc-var-unit'></div><div class='sc-value-preview sc-preview'><span><div>1, 2</div></span></div><input id='attrs-2304bfd9-a076-4727-9431-abeb8704ed4f' class='sc-var-attrs-in' type='checkbox' disabled><label for='attrs-2304bfd9-a076-4727-9431-abeb8704ed4f' class='sc-hide-icon' title='Show/Hide attributes'><svg class='icon sc-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d3ce4eba-9493-4c34-9cf9-aea018ddcc2b' class='sc-var-data-in' type='checkbox'><label for='data-d3ce4eba-9493-4c34-9cf9-aea018ddcc2b' title='Show/Hide data repr'><svg class='icon sc-icon-database'><use xlink:href='#icon-database'></use></svg></label><pre class='sc-var-data'>Values:<br>array([1, 2])</pre></span></li><li class='sc-var-item'><div class='sc-var-name'><span class='sc-aligned'>detector</span></div><div class='sc-var-dims'>()</div><div class='sc-var-dtype'>string</div><div class='sc-var-unit'></div><div class='sc-value-preview sc-preview'><span><div>mantle</div></span></div><input id='attrs-d5412fe1-1a40-4cf1-983f-69eb4a19c274' class='sc-var-attrs-in' type='checkbox' disabled><label for='attrs-d5412fe1-1a40-4cf1-983f-69eb4a19c274' class='sc-hide-icon' title='Show/Hide attributes'><svg class='icon sc-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d8688426-9fca-4c13-8fb2-6992f64e96de' class='sc-var-data-in' type='checkbox'><label for='data-d8688426-9fca-4c13-8fb2-6992f64e96de' title='Show/Hide data repr'><svg class='icon sc-icon-database'><use xlink:href='#icon-database'></use></svg></label><pre class='sc-var-data'>Values:<br>&#x27;mantle&#x27;</pre></span></li><li class='sc-var-item'><div class='sc-var-name'><span class='sc-aligned'>gravity</span></div><div class='sc-var-dims'>()</div><div class='sc-var-dtype'>vector3</div><div class='sc-var-unit'>m/s^2</div><div class='sc-value-preview sc-preview'><span><div>[ 0.      -9.80665  0.     ]</div></span></div><input id='attrs-636c1d3c-d9c9-44da-86ba-e1d39fe3e594' class='sc-var-attrs-in' type='checkbox' disabled><label for='attrs-636c1d3c-d9c9-44da-86ba-e1d39fe3e594' class='sc-hide-icon' title='Show/Hide attributes'><svg class='icon sc-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1c0ae0b3-e868-4fdc-9044-46ee801fcdaf' class='sc-var-data-in' type='checkbox'><label for='data-1c0ae0b3-e868-4fdc-9044-46ee801fcdaf' title='Show/Hide data repr'><svg class='icon sc-icon-database'><use xlink:href='#icon-database'></use></svg></label><pre class='sc-var-data'>Values:<br>array([ 0.     , -9.80665,  0.     ])</pre></span></li><li class='sc-var-item'><div class='sc-var-name'><span class='sc-aligned'>module</span></div><div class='sc-var-dims'>(module)</div><div class='sc-var-dtype'>int64</div><div class='sc-var-unit'></div><div class='sc-value-preview sc-preview'><span><div>1, 2, ..., 13, 14</div></span></div><input id='attrs-12763b95-261f-4405-a00d-65942e1dc380' class='sc-var-attrs-in' type='checkbox' disabled><label for='attrs-12763b95-261f-4405-a00d-65942e1dc380' class='sc-hide-icon' title='Show/Hide attributes'><svg class='icon sc-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5b8f71c5-4ec1-4a7e-b45c-d3e5c6c9b2c0' class='sc-var-data-in' type='checkbox'><label for='data-5b8f71c5-4ec1-4a7e-b45c-d3e5c6c9b2c0' title='Show/Hide data repr'><svg class='icon sc-icon-database'><use xlink:href='#icon-database'></use></svg></label><pre class='sc-var-data'>Values:<br>array([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14])</pre></span></li><li class='sc-var-item'><div class='sc-var-name'><span>position</span></div><div class='sc-var-dims'>(module, segment, counter, wire, strip)</div><div class='sc-var-dtype'>vector3</div><div class='sc-var-unit'>mm</div><div class='sc-value-preview sc-preview'><span><div>[  943.7585       552.66233333 -1089.20833333], [  943.48333333   555.36133333 -1079.13555556], ..., [nan nan nan], [nan nan nan]</div></span></div><input id='attrs-4a7ec457-7bef-4543-84b9-0c4b98773172' class='sc-var-attrs-in' type='checkbox' disabled><label for='attrs-4a7ec457-7bef-4543-84b9-0c4b98773172' class='sc-hide-icon' title='Show/Hide attributes'><svg class='icon sc-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-accf9f7e-5dc9-4460-866f-fbe6063c4ca3' class='sc-var-data-in' type='checkbox'><label for='data-accf9f7e-5dc9-4460-866f-fbe6063c4ca3' title='Show/Hide data repr'><svg class='icon sc-icon-database'><use xlink:href='#icon-database'></use></svg></label><pre class='sc-var-data'>Values:<br>array([[[[[[  943.7585    ,   552.66233333, -1089.20833333],
           [  943.48333333,   555.36133333, -1079.13555556],
           [  944.11566667,   556.27933333, -1067.85666667],
           ...,
           [  947.012     ,   554.43675   ,  1064.445     ],
           [  945.733     ,   552.822     ,  1071.3       ],
           [  943.1545    ,   551.926     ,  1093.78      ]],

          [[  954.46685714,   559.72742857, -1102.68      ],
           [  954.3395    ,   559.125125  , -1089.0775    ],
           [  957.28466667,   558.15733333, -1079.48      ],
           ...,
           [  955.5875    ,   557.8255    ,  1069.755     ],
           [  959.648     ,   558.686     ,  1095.845     ],
           [  956.812     ,   561.6388    ,  1104.406     ]],

          [[  965.91225   ,   567.2715    , -1116.51      ],
           [  961.55      ,   563.0085    , -1095.64      ],
           [  966.6275    ,   564.838     , -1090.1       ],
           ...,
           [  960.344     ,   566.3735    ,  1083.98      ],
           [  964.031     ,   563.107     ,  1094.7       ],
           [  959.5145    ,   564.2135    ,  1108.075     ]],

          ...,

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[ 1208.1       ,   780.487     , -1435.85      ],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[ 1210.24      ,   784.138     , -1434.99      ],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]]],


         [[[  948.94075   ,   544.87675   , -1091.5975    ],
           [  957.30933333,   545.48116667, -1076.86166667],
           [  956.67075   ,   544.61525   , -1072.835     ],
           ...,
           [  954.50125   ,   543.526     ,  1066.6025    ],
           [  952.9452    ,   540.314     ,  1073.994     ],
           [  950.52225   ,   546.33975   ,  1091.2375    ]],

          [[  963.12233333,   552.16283333, -1104.25      ],
           [  961.96985714,   553.15042857, -1088.99571429],
           [  963.465     ,   549.47642857, -1073.67857143],
           ...,
           [  962.70266667,   551.06133333,  1075.01666667],
           [           nan,            nan,            nan],
           [  954.355     ,   552.892     ,  1097.43      ]],

          [[  970.058875  ,   559.058125  , -1114.7625    ],
           [  967.87466667,   559.47233333, -1098.42      ],
           [  969.8565    ,   559.079     , -1082.59      ],
           ...,
           [  970.156     ,   559.2805    ,  1088.69      ],
           [  972.35733333,   560.00766667,  1099.87666667],
           [  968.502     ,   564.218     ,  1114.85      ]],

          ...,

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]]]],



        [[[[  933.14990909,   572.25009091, -1092.67090909],
           [  929.8486    ,   574.0592    , -1078.078     ],
           [  933.1602    ,   572.899     , -1066.222     ],
           ...,
           [  929.42933333,   573.42033333,  1057.99666667],
           [  928.435     ,   574.584     ,  1080.68      ],
           [  932.618     ,   574.103     ,  1089.33      ]],

          [[  943.7562    ,   584.0246    , -1107.33      ],
           [  946.643     ,   579.7925    , -1088.835     ],
           [  941.6582    ,   579.7454    , -1072.292     ],
           ...,
           [           nan,            nan,            nan],
           [  945.445     ,   578.6965    ,  1090.805     ],
           [  936.961     ,   583.839     ,  1100.93      ]],

          [[  949.5524    ,   588.9338    , -1112.544     ],
           [  951.399     ,   588.36975   , -1103.0525    ],
           [  953.6445    ,   586.8415    , -1086.42      ],
           ...,
           [  955.6155    ,   588.0475    ,  1093.435     ],
           [  951.338     ,   587.767     ,  1094.3       ],
           [  956.72      ,   589.3565    ,  1120.61      ]],

          ...,

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[ 1199.93      ,   800.337     , -1428.58      ],
           [ 1200.08      ,   800.758     , -1428.18      ],
           [           nan,            nan,            nan],
           ...,
           [ 1198.1       ,   813.427     ,  1406.47      ],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]]],


         [[[  937.78925   ,   561.96975   , -1087.285     ],
           [  941.5055    ,   560.1185    , -1073.6825    ],
           [  938.25633333,   563.996     , -1062.81166667],
           ...,
           [  939.76625   ,   562.1355    ,  1063.2475    ],
           [  938.25433333,   561.01666667,  1072.56      ],
           [  942.725     ,   565.401     ,  1089.97666667]],

          [[  951.17      ,   575.247     , -1110.74333333],
           [           nan,            nan,            nan],
           [  955.413     ,   571.467     , -1072.6       ],
           ...,
           [  951.3095    ,   574.507     ,  1080.58      ],
           [           nan,            nan,            nan],
           [  955.696     ,   572.194     ,  1108.78      ]],

          [[  957.07375   ,   576.713     , -1109.27      ],
           [  960.956     ,   580.88333333, -1103.14666667],
           [  962.056     ,   581.33733333, -1090.1       ],
           ...,
           [  956.60866667,   582.08966667,  1085.41333333],
           [  962.6695    ,   579.4415    ,  1109.215     ],
           [  957.458     ,   581.0445    ,  1108.2       ]],

          ...,

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [ 1210.29      ,   799.945     , -1409.42      ],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]]]],



        [[[[  918.77175   ,   597.875     , -1093.39125   ],
           [  919.43722222,   593.46633333, -1075.38777778],
           [  920.2915    ,   595.48033333, -1067.05      ],
           ...,
           [  919.541     ,   590.06      ,  1067.12      ],
           [  919.0695    ,   590.565     ,  1074.045     ],
           [  920.9835    ,   594.074     ,  1088.84      ]],

          [[  927.98416667,   603.28666667, -1106.935     ],
           [  930.1882    ,   599.8448    , -1086.33      ],
           [  925.30783333,   600.71733333, -1070.285     ],
           ...,
           [  928.473     ,   601.362     ,  1075.5775    ],
           [  928.9155    ,   601.5375    ,  1088.695     ],
           [  927.7705    ,   599.0255    ,  1094.555     ]],

          [[  936.2225    ,   608.456875  , -1113.8725    ],
           [  937.887     ,   610.5835    , -1102.185     ],
           [  942.567     ,   608.1452    , -1089.464     ],
           ...,
           [  942.466     ,   608.5275    ,  1093.235     ],
           [  941.43466667,   610.44133333,  1105.23333333],
           [  940.2755    ,   611.6125    ,  1110.4       ]],

          ...,

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [ 1175.6       ,   820.312     , -1415.74      ],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]]],


         [[[  928.26233333,   585.13655556, -1092.36333333],
           [  927.08677778,   584.37744444, -1074.17111111],
           [  924.32985714,   583.18128571, -1060.93571429],
           ...,
           [  924.654     ,   582.61      ,  1066.42      ],
           [  925.217     ,   581.316     ,  1066.49      ],
           [  927.92      ,   584.1365    ,  1089.79      ]],

          [[  937.86883333,   594.3395    , -1108.02166667],
           [  931.854     ,   595.1505    , -1082.965     ],
           [  936.69466667,   593.09466667, -1078.48666667],
           ...,
           [  942.337     ,   592.493     ,  1074.34      ],
           [  939.04225   ,   593.25825   ,  1091.13      ],
           [  942.201     ,   592.037     ,  1098.79      ]],

          [[  948.43433333,   598.464     , -1112.97333333],
           [  948.91225   ,   601.065     , -1101.945     ],
           [  946.09866667,   597.96366667, -1087.52666667],
           ...,
           [  946.051     ,   597.525     ,  1084.74      ],
           [  947.778     ,   599.05      ,  1095.26      ],
           [           nan,            nan,            nan]],

          ...,

          [[ 1174.695     ,   803.7825    , -1423.01      ],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [ 1164.97      ,   808.629     ,  1414.76      ]],

          [[           nan,            nan,            nan],
           [ 1178.66      ,   811.808     , -1399.48      ],
           [ 1182.86      ,   810.845     , -1398.47      ],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]]]],



        [[[[  907.60909091,   612.82245455, -1090.54181818],
           [  905.26942857,   614.76      , -1076.77142857],
           [  904.8874    ,   614.5998    , -1060.992     ],
           ...,
           [  907.5575    ,   614.9125    ,  1065.18      ],
           [  903.90333333,   614.45966667,  1079.92      ],
           [  903.595     ,   612.6095    ,  1087.1475    ]],

          [[  916.8122    ,   621.5236    , -1105.498     ],
           [  912.9895    ,   624.712     , -1086.035     ],
           [  918.632375  ,   622.751375  , -1078.24625   ],
           ...,
           [  917.6438    ,   619.0106    ,  1078.646     ],
           [  916.9995    ,   622.6215    ,  1087.31      ],
           [  914.6115    ,   625.1265    ,  1106.81      ]],

          [[  923.742     ,   629.727625  , -1116.2975    ],
           [  921.9395    ,   627.561     , -1097.6       ],
           [  920.95875   ,   626.6035    , -1083.715     ],
           ...,
           [  918.158     ,   629.99      ,  1083.97      ],
           [  919.2105    ,   631.6065    ,  1098.84      ],
           [  918.217     ,   628.007     ,  1111.19      ]],

          ...,

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [ 1156.11      ,   860.02      ,  1399.66      ],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]]],


         [[[  915.55815385,   604.83453846, -1091.28153846],
           [  912.83633333,   606.159     , -1079.5       ],
           [  913.4772    ,   603.8924    , -1061.232     ],
           ...,
           [  915.356     ,   605.666     ,  1061.965     ],
           [           nan,            nan,            nan],
           [  921.013     ,   606.782     ,  1101.05      ]],

          [[  923.84075   ,   610.88275   , -1100.6275    ],
           [  925.919     ,   615.816     , -1091.66      ],
           [  923.7158    ,   612.1052    , -1076.948     ],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [  922.89966667,   612.259     ,  1103.28666667]],

          [[  933.512     ,   615.885     , -1104.48      ],
           [  929.876     ,   620.98716667, -1099.96333333],
           [  932.06666667,   619.372     , -1086.33666667],
           ...,
           [  933.01      ,   620.32566667,  1084.63666667],
           [  932.156     ,   615.725     ,  1093.28      ],
           [           nan,            nan,            nan]],

          ...,

          [[ 1152.58      ,   833.086     , -1422.86      ],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [ 1176.01      ,   851.06      , -1413.77      ],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]]]],



        [[[[  893.5846    ,   632.7046    , -1093.644     ],
           [  891.2728    ,   633.0642    , -1075.092     ],
           [  890.683     ,   630.933     , -1062.245     ],
           ...,
           [  896.759     ,   631.949     ,  1064.23      ],
           [  894.3545    ,   633.475     ,  1075.165     ],
           [  895.175     ,   629.642     ,  1095.06      ]],

          [[  905.1215    ,   643.1115    , -1111.475     ],
           [  902.0385    ,   642.635     , -1088.295     ],
           [  906.366     ,   638.38233333, -1080.00333333],
           ...,
           [  902.9335    ,   638.31266667,  1073.54333333],
           [  899.674     ,   644.0125    ,  1088.05      ],
           [  900.621     ,   639.238     ,  1105.35      ]],

          [[  912.69266667,   645.09833333, -1116.05333333],
           [  913.66925   ,   646.28325   , -1098.645     ],
           [  909.0326    ,   649.5786    , -1083.968     ],
           ...,
           [  911.0195    ,   644.2105    ,  1083.895     ],
           [           nan,            nan,            nan],
           [  905.682     ,   650.32      ,  1117.26      ]],

          ...,

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]]],


         [[[  902.07888889,   622.71833333, -1090.82333333],
           [  902.94875   ,   623.286125  , -1075.8975    ],
           [  901.78255556,   624.76744444, -1064.28222222],
           ...,
           [  901.55266667,   622.70233333,  1063.26666667],
           [  900.931     ,   628.2825    ,  1081.35      ],
           [  901.437     ,   625.185     ,  1089.37      ]],

          [[  910.8575    ,   633.648     , -1101.65875   ],
           [  909.66383333,   633.4775    , -1089.98      ],
           [  909.9362    ,   630.4464    , -1073.634     ],
           ...,
           [  910.55      ,   640.265     ,  1074.94      ],
           [  903.066     ,   633.474     ,  1083.52      ],
           [  909.444     ,   626.675     ,  1098.47      ]],

          [[  920.648     ,   637.336     , -1111.92666667],
           [  920.64533333,   640.3225    , -1101.00666667],
           [  924.949     ,   641.131     , -1088.17      ],
           ...,
           [  918.0305    ,   641.356     ,  1082.225     ],
           [           nan,            nan,            nan],
           [  919.796     ,   637.171     ,  1116.64      ]],

          ...,

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]]]],



        [[[[  879.15975   ,   650.463125  , -1087.9525    ],
           [  878.23842857,   651.173     , -1076.63428571],
           [  877.711     ,   654.25322222, -1066.28888889],
           ...,
           [  880.137     ,   659.566     ,  1074.75      ],
           [  879.4955    ,   653.1225    ,  1080.11      ],
           [  878.481     ,   654.086     ,  1095.42      ]],

          [[  886.9964    ,   662.1734    , -1105.956     ],
           [  882.702     ,   661.308     , -1083.06      ],
           [  882.49866667,   661.74966667, -1071.7       ],
           ...,
           [           nan,            nan,            nan],
           [  888.2286    ,   663.5682    ,  1092.224     ],
           [  888.56833333,   663.99666667,  1107.86666667]],

          [[  897.31114286,   668.83871429, -1117.45714286],
           [  898.04833333,   671.425     , -1102.84333333],
           [  898.0785    ,   669.8995    , -1088.855     ],
           ...,
           [  895.88533333,   670.456     ,  1087.87666667],
           [  894.23033333,   665.09666667,  1097.61666667],
           [  895.26633333,   668.98033333,  1115.18666667]],

          ...,

          [[ 1107.554     ,   889.0462    , -1415.064     ],
           [ 1104.48      ,   890.14033333, -1396.71333333],
           [ 1107.92      ,   883.92      , -1379.23      ],
           ...,
           [ 1112.55      ,   888.906     ,  1378.17      ],
           [ 1110.76      ,   887.156     ,  1403.81      ],
           [ 1103.12      ,   889.561     ,  1415.33      ]],

          [[ 1120.3       ,   898.1505    , -1432.29      ],
           [ 1112.325     ,   903.6465    , -1405.13      ],
           [ 1114.78      ,   907.108     , -1406.19      ],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[ 1127.066     ,   908.7336    , -1442.166     ],
           [ 1126.455     ,   909.7515    , -1430.005     ],
           [ 1115.6       ,   908.087     , -1406.9       ],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [ 1124.3175    ,   911.918     ,  1445.0425    ]]],


         [[[  887.36525   ,   642.794     , -1088.4825    ],
           [  888.31766667,   643.05216667, -1075.83333333],
           [  889.2335    ,   642.89016667, -1063.81166667],
           ...,
           [           nan,            nan,            nan],
           [  889.084     ,   643.61366667,  1081.62666667],
           [  888.087     ,   642.424     ,  1088.61      ]],

          [[  892.98866667,   651.81766667, -1104.8       ],
           [  895.23225   ,   652.75525   , -1087.6525    ],
           [  898.2365    ,   650.667     , -1073.5325    ],
           ...,
           [  890.648     ,   653.166     ,  1069.56      ],
           [  898.2165    ,   655.9375    ,  1096.63      ],
           [  900.962     ,   650.987     ,  1098.21      ]],

          [[  905.732375  ,   661.89575   , -1118.01375   ],
           [  905.261     ,   662.374     , -1098.724     ],
           [  905.95033333,   661.22233333, -1091.81333333],
           ...,
           [  908.958     ,   660.052     ,  1089.53      ],
           [  905.811     ,   657.692     ,  1100.835     ],
           [  907.583     ,   664.8715    ,  1119.61      ]],

          ...,

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [ 1119.49      ,   879.8       ,  1391.36      ],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[ 1128.14      ,   886.577     , -1429.75      ],
           [ 1120.41      ,   893.578     , -1402.33      ],
           [ 1121.72      ,   893.804     , -1401.13      ],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [ 1125.795     ,   890.598     ,  1436.34      ]],

          [[ 1138.06      ,   897.769     , -1451.62      ],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [ 1131.05      ,   894.342     ,  1437.66      ]]]]],




       [[[[[ 1010.06444444,   427.725     , -1093.19111111],
           [ 1009.0375    ,   428.511     , -1080.4       ],
           [ 1007.386     ,   428.387     , -1065.462     ],
           ...,
           [ 1007.085     ,   429.607     ,  1061.        ],
           [ 1009.84333333,   423.974     ,  1077.73      ],
           [           nan,            nan,            nan]],

          [[ 1020.775     ,   430.267625  , -1104.43375   ],
           [ 1020.15833333,   429.90683333, -1088.39333333],
           [ 1020.754     ,   432.2172    , -1076.558     ],
           ...,
           [           nan,            nan,            nan],
           [ 1017.975     ,   427.9215    ,  1089.015     ],
           [ 1018.08      ,   430.408     ,  1101.56666667]],

          [[ 1030.54714286,   437.96285714, -1116.07      ],
           [ 1035.51      ,   436.593     , -1099.12      ],
           [ 1027.2525    ,   434.70525   , -1081.44      ],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [ 1029.        ,   437.178     ,  1119.48      ]],

          ...,

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[ 1308.6       ,   622.894     , -1443.2       ],
           [ 1309.8       ,   611.637     , -1430.27      ],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]]],


         [[[ 1017.06555556,   417.277     , -1094.09777778],
           [ 1013.375     ,   417.84466667, -1076.995     ],
           [ 1015.62      ,   418.07025   , -1067.045     ],
           ...,
           [ 1014.79      ,   411.635     ,  1055.05      ],
           [           nan,            nan,            nan],
           [ 1019.41      ,   413.787     ,  1091.27      ]],

          [[ 1022.68285714,   420.72714286, -1100.77285714],
           [ 1023.712     ,   423.2694    , -1086.172     ],
           [ 1022.52      ,   421.43375   , -1071.225     ],
           ...,
           [ 1030.22      ,   420.774     ,  1078.06      ],
           [ 1021.63      ,   419.851     ,  1091.01      ],
           [ 1019.54      ,   424.161     ,  1094.78      ]],

          [[ 1032.52666667,   432.43533333, -1113.37666667],
           [ 1033.84      ,   430.37066667, -1103.46333333],
           [ 1036.345     ,   429.22325   , -1086.1325    ],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [ 1037.20666667,   429.36      ,  1117.21666667]],

          ...,

          [[ 1296.43      ,   601.014     , -1432.2       ],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[ 1297.17      ,   601.291     , -1430.93      ],
           [           nan,            nan,            nan],
           [ 1306.64      ,   596.291     , -1399.01      ],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [ 1316.64      ,   602.416     ,  1439.91      ]]]],



        [[[[  998.57214286,   448.835     , -1094.74      ],
           [  996.7796    ,   447.6334    , -1076.806     ],
           [  997.227     ,   448.27183333, -1060.44666667],
           ...,
           [ 1000.22066667,   448.88466667,  1064.88666667],
           [  997.59766667,   446.35833333,  1074.54333333],
           [ 1000.90428571,   446.88385714,  1092.02      ]],

          [[ 1009.9875    ,   451.5815    , -1101.7225    ],
           [ 1009.055     ,   452.375     , -1088.025     ],
           [ 1007.082     ,   456.0708    , -1075.258     ],
           ...,
           [ 1007.72      ,   447.019     ,  1068.51      ],
           [ 1012.415     ,   450.909     ,  1088.39      ],
           [ 1006.51      ,   453.9945    ,  1101.74      ]],

          [[ 1022.12      ,   459.0386    , -1116.776     ],
           [ 1019.58      ,   459.067     , -1099.41666667],
           [ 1018.835     ,   456.9685    , -1087.81      ],
           ...,
           [ 1022.13      ,   456.411     ,  1091.16      ],
           [ 1022.17      ,   457.361     ,  1100.48      ],
           [ 1020.85      ,   455.833     ,  1117.28      ]],

          ...,

          [[ 1280.12      ,   629.617     , -1421.81      ],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]]],


         [[[ 1004.93666667,   436.23133333, -1090.96333333],
           [ 1003.37866667,   437.9605    , -1075.57333333],
           [ 1006.245     ,   436.27366667, -1064.68166667],
           ...,
           [ 1006.67      ,   434.4465    ,  1061.01      ],
           [ 1001.835     ,   435.765     ,  1075.535     ],
           [ 1005.473     ,   437.41366667,  1090.7       ]],

          [[ 1017.148     ,   445.8496    , -1105.702     ],
           [ 1013.13      ,   446.3512    , -1088.018     ],
           [ 1017.06666667,   442.64516667, -1073.96666667],
           ...,
           [ 1021.29      ,   442.757     ,  1075.34      ],
           [           nan,            nan,            nan],
           [ 1015.81      ,   445.2595    ,  1103.17      ]],

          [[ 1024.31      ,   451.60083333, -1113.36333333],
           [ 1021.66      ,   451.4135    , -1101.19      ],
           [ 1028.245     ,   448.4555    , -1085.33      ],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [ 1019.71      ,   450.499     ,  1109.29      ]],

          ...,

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]]]],



        [[[[  990.21675   ,   471.040125  , -1093.2175    ],
           [  989.4225    ,   467.03133333, -1075.865     ],
           [  987.73428571,   468.78042857, -1061.07285714],
           ...,
           [  988.12866667,   469.56933333,  1062.24      ],
           [  989.532     ,   468.899     ,  1075.105     ],
           [  988.46      ,   469.8065    ,  1093.855     ]],

          [[  999.1675    ,   476.73316667, -1104.295     ],
           [ 1000.4095    ,   477.347     , -1092.475     ],
           [  999.5524    ,   474.9488    , -1073.79      ],
           ...,
           [           nan,            nan,            nan],
           [ 1003.96      ,   474.13433333,  1094.24333333],
           [ 1002.69825   ,   476.31825   ,  1104.525     ]],

          [[ 1004.19      ,   480.027     , -1107.76      ],
           [ 1011.25333333,   482.38933333, -1099.22666667],
           [ 1012.68      ,   480.199     , -1092.345     ],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [ 1005.21      ,   478.621     ,  1112.5       ]],

          ...,

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]]],


         [[[  997.2465    ,   459.7845    , -1096.93      ],
           [  995.54366667,   457.79133333, -1075.51666667],
           [  997.52514286,   459.006     , -1062.38714286],
           ...,
           [  994.19166667,   461.12266667,  1064.68      ],
           [  993.614     ,   461.152     ,  1073.87      ],
           [  998.371     ,   466.899     ,  1100.19      ]],

          [[ 1007.55545455,   464.27827273, -1106.67727273],
           [ 1007.085     ,   466.3665    , -1086.99      ],
           [ 1005.808     ,   464.41      , -1071.544     ],
           ...,
           [ 1005.685     ,   467.2095    ,  1080.935     ],
           [ 1004.29675   ,   469.75975   ,  1090.5775    ],
           [ 1005.41      ,   464.974     ,  1106.905     ]],

          [[ 1015.566     ,   474.4294    , -1116.222     ],
           [ 1014.55      ,   473.3295    , -1098.515     ],
           [ 1012.1       ,   468.663     , -1079.06      ],
           ...,
           [ 1014.29      ,   467.757     ,  1077.71      ],
           [ 1014.84      ,   467.839     ,  1099.94      ],
           [ 1013.515     ,   473.025     ,  1112.5       ]],

          ...,

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [ 1261.85      ,   652.841     , -1384.53      ],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [ 1273.61      ,   647.428     ,  1429.08      ]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[ 1280.94      ,   665.292     , -1437.72      ],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]]]],



        [[[[  980.97833333,   490.41766667, -1093.90333333],
           [  975.84033333,   492.454     , -1077.38333333],
           [  979.66042857,   490.76528571, -1062.94714286],
           ...,
           [  976.96875   ,   491.193     ,  1061.23      ],
           [  977.717     ,   490.18366667,  1071.24333333],
           [  979.2194    ,   490.0332    ,  1095.464     ]],

          [[  988.4264    ,   495.533     , -1102.196     ],
           [  990.46875   ,   493.81325   , -1086.07      ],
           [  990.56433333,   493.02733333, -1077.08666667],
           ...,
           [  990.079     ,   498.291     ,  1075.61      ],
           [           nan,            nan,            nan],
           [  987.731     ,   495.6       ,  1102.755     ]],

          [[  999.09716667,   503.48      , -1112.77166667],
           [  999.57466667,   503.39333333, -1101.805     ],
           [  998.254     ,   502.86933333, -1086.50333333],
           ...,
           [           nan,            nan,            nan],
           [  992.83      ,   505.056     ,  1091.98      ],
           [  998.569     ,   509.745     ,  1115.43      ]],

          ...,

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[ 1248.08      ,   696.543     , -1434.39      ],
           [ 1250.475     ,   697.584     , -1410.645     ],
           [ 1252.58      ,   696.701     , -1402.54      ],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[ 1266.08      ,   704.932     , -1437.17      ],
           [ 1265.96      ,   706.232     , -1436.87      ],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]]],


         [[[  989.0358    ,   482.1916    , -1096.396     ],
           [  988.78614286,   482.99114286, -1076.67571429],
           [  985.52157143,   483.52485714, -1065.94714286],
           ...,
           [  985.23142857,   479.13485714,  1060.99428571],
           [           nan,            nan,            nan],
           [  979.847     ,   483.222     ,  1090.07      ]],

          [[  994.67742857,   484.02785714, -1100.17571429],
           [  995.33516667,   488.80283333, -1089.435     ],
           [  990.62942857,   488.99485714, -1074.95285714],
           ...,
           [  997.527     ,   484.883     ,  1081.01      ],
           [  996.9655    ,   485.007     ,  1084.75      ],
           [  995.55      ,   491.7515    ,  1108.3       ]],

          [[ 1005.65283333,   495.56366667, -1115.40833333],
           [ 1001.5064    ,   496.7002    , -1096.094     ],
           [ 1004.6314    ,   495.4382    , -1090.208     ],
           ...,
           [ 1008.98      ,   492.485     ,  1087.6       ],
           [ 1005.35      ,   490.35      ,  1102.97      ],
           [ 1005.72666667,   491.03466667,  1111.11333333]],

          ...,

          [[ 1248.98      ,   681.135     , -1418.        ],
           [           nan,            nan,            nan],
           [ 1251.54      ,   668.962     , -1372.09      ],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[ 1259.25      ,   686.268     , -1435.53      ],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]]]],



        [[[[  967.28966667,   511.517     , -1091.57555556],
           [  967.24716667,   514.285     , -1079.64166667],
           [  968.4316    ,   511.5726    , -1063.036     ],
           ...,
           [  965.904     ,   514.53633333,  1064.35666667],
           [  965.228     ,   508.271     ,  1068.93      ],
           [  974.241     ,   509.948     ,  1097.23      ]],

          [[  977.13175   ,   517.5475    , -1102.93      ],
           [  978.219     ,   519.02875   , -1089.775     ],
           [  979.84725   ,   518.04575   , -1076.1525    ],
           ...,
           [  971.536     ,   519.315     ,  1065.02      ],
           [  983.40466667,   518.45433333,  1096.55333333],
           [  979.7546    ,   517.3702    ,  1098.764     ]],

          [[  990.4165    ,   522.492     , -1115.505     ],
           [  991.76      ,   524.773     , -1104.285     ],
           [  988.6525    ,   521.411     , -1083.63      ],
           ...,
           [           nan,            nan,            nan],
           [  984.77      ,   520.417     ,  1094.        ],
           [  984.4235    ,   522.2695    ,  1109.89      ]],

          ...,

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [ 1228.9       ,   719.886     , -1378.73      ],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]]],


         [[[  976.9487    ,   502.5242    , -1095.855     ],
           [  977.89372727,   501.25245455, -1078.86181818],
           [  977.709     ,   498.886     , -1067.89      ],
           ...,
           [  976.4585    ,   500.946     ,  1067.855     ],
           [  980.78      ,   501.295     ,  1074.77      ],
           [           nan,            nan,            nan]],

          [[  984.74071429,   510.25771429, -1106.83142857],
           [  985.9076    ,   506.7122    , -1087.002     ],
           [  982.46766667,   510.42866667, -1072.82666667],
           ...,
           [  984.569     ,   505.546     ,  1070.67      ],
           [           nan,            nan,            nan],
           [  990.613     ,   511.231     ,  1108.15      ]],

          [[  993.8452    ,   517.0502    , -1115.03      ],
           [  994.3932    ,   514.8742    , -1103.42      ],
           [           nan,            nan,            nan],
           ...,
           [  993.624     ,   522.87      ,  1089.085     ],
           [           nan,            nan,            nan],
           [  996.34425   ,   514.95575   ,  1116.215     ]],

          ...,

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]]]],



        [[[[  956.12777778,   531.12522222, -1088.94888889],
           [  955.046     ,   532.62984615, -1074.10153846],
           [  955.0441    ,   531.2288    , -1063.329     ],
           ...,
           [           nan,            nan,            nan],
           [  956.409     ,   529.1115    ,  1072.99      ],
           [  954.871     ,   534.55466667,  1092.47333333]],

          [[  964.895     ,   541.80928571, -1104.00857143],
           [  967.951     ,   535.71666667, -1087.01666667],
           [  969.065     ,   537.57666667, -1075.99833333],
           ...,
           [  965.272     ,   533.426     ,  1069.58      ],
           [           nan,            nan,            nan],
           [  971.125     ,   540.641     ,  1113.08      ]],

          [[  974.46275   ,   546.027     , -1114.6475    ],
           [  978.6       ,   543.57225   , -1100.7575    ],
           [  975.551     ,   541.54766667, -1082.04666667],
           ...,
           [           nan,            nan,            nan],
           [  978.1155    ,   549.769     ,  1100.865     ],
           [  981.679     ,   547.224     ,  1116.25      ]],

          ...,

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [ 1233.56      ,   760.406     , -1430.17      ],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]]],


         [[[  965.32583333,   522.52083333, -1093.34      ],
           [  964.6895    ,   523.4265    , -1076.62625   ],
           [  962.40585714,   522.50785714, -1062.27428571],
           ...,
           [           nan,            nan,            nan],
           [  958.025     ,   525.006     ,  1077.82      ],
           [  962.74      ,   526.4175    ,  1096.325     ]],

          [[  974.5538    ,   534.1522    , -1108.06      ],
           [  971.8102    ,   531.6024    , -1089.41      ],
           [  970.735     ,   531.70066667, -1077.44333333],
           ...,
           [  974.816     ,   532.563     ,  1074.83      ],
           [  968.904     ,   533.905     ,  1086.93      ],
           [  973.94766667,   528.48133333,  1101.98666667]],

          [[  983.601     ,   536.226625  , -1114.63375   ],
           [  982.27733333,   540.69433333, -1098.44666667],
           [  983.59866667,   539.752     , -1091.68666667],
           ...,
           [  982.919     ,   542.20175   ,  1086.425     ],
           [           nan,            nan,            nan],
           [  979.3605    ,   536.579     ,  1112.955     ]],

          ...,

          [[ 1224.15      ,   737.302     , -1430.66      ],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[ 1225.15      ,   738.09      , -1429.95      ],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]]]]],




       [[[[[ 1055.82166667,   292.39      , -1095.16833333],
           [ 1052.05857143,   289.42785714, -1071.34428571],
           [ 1053.376     ,   293.4206    , -1065.314     ],
           ...,
           [ 1050.68333333,   291.37766667,  1062.32333333],
           [ 1052.31      ,   290.8445    ,  1074.0275    ],
           [ 1051.395     ,   290.018     ,  1084.72      ]],

          [[ 1066.53285714,   296.61914286, -1102.73714286],
           [ 1062.43      ,   299.80733333, -1085.56666667],
           [ 1064.554     ,   293.5094    , -1069.91      ],
           ...,
           [ 1068.75      ,   292.064     ,  1072.83      ],
           [           nan,            nan,            nan],
           [ 1069.67      ,   303.668     ,  1113.49      ]],

          [[ 1079.32714286,   300.19785714, -1115.71428571],
           [ 1077.8       ,   296.071     , -1096.785     ],
           [ 1076.042     ,   299.8746    , -1086.046     ],
           ...,
           [ 1073.77      ,   305.472     ,  1091.92      ],
           [ 1074.85      ,   300.547     ,  1092.4       ],
           [ 1073.984     ,   301.4904    ,  1113.546     ]],

          ...,

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [ 1348.77      ,   434.338     ,  1421.62      ]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [ 1378.16      ,   446.356     ,  1431.28      ],
           [ 1372.82      ,   446.094     ,  1431.31      ]]],


         [[[ 1061.01111111,   281.23366667, -1091.90888889],
           [ 1060.77545455,   280.965     , -1078.93545455],
           [ 1065.36      ,   284.589     , -1072.895     ],
           ...,
           [ 1062.264     ,   277.7928    ,  1064.35      ],
           [ 1059.855     ,   276.918     ,  1074.875     ],
           [ 1062.5475    ,   281.07075   ,  1092.13      ]],

          [[ 1074.7375    ,   285.37125   , -1103.6175    ],
           [ 1070.04833333,   287.4085    , -1090.14666667],
           [ 1072.35      ,   285.49333333, -1080.43666667],
           ...,
           [ 1070.        ,   289.21      ,  1070.14      ],
           [           nan,            nan,            nan],
           [ 1070.4975    ,   285.861     ,  1101.56      ]],

          [[ 1086.45      ,   293.1155    , -1116.02      ],
           [ 1083.675     ,   288.192     , -1101.23      ],
           [ 1081.885     ,   291.2145    , -1087.055     ],
           ...,
           [           nan,            nan,            nan],
           [ 1083.97      ,   287.6425    ,  1100.53      ],
           [ 1079.28      ,   292.902     ,  1116.025     ]],

          ...,

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]]]],



        [[[[ 1047.22555556,   314.32588889, -1087.03888889],
           [ 1046.9925    ,   314.852125  , -1080.12      ],
           [ 1050.685     ,   312.488     , -1064.405     ],
           ...,
           [ 1050.01      ,   315.2635    ,  1064.405     ],
           [ 1045.53      ,   314.68      ,  1074.24      ],
           [ 1054.21      ,   313.929     ,  1097.55333333]],

          [[ 1063.052     ,   317.8556    , -1105.718     ],
           [ 1060.462     ,   315.6798    , -1087.398     ],
           [ 1059.614     ,   317.8846    , -1075.942     ],
           ...,
           [ 1055.365     ,   316.8935    ,  1072.34      ],
           [ 1062.55      ,   319.21975   ,  1090.8975    ],
           [ 1058.72333333,   317.35833333,  1099.86      ]],

          [[ 1067.33666667,   321.37733333, -1111.28666667],
           [ 1068.95      ,   322.38966667, -1101.82333333],
           [ 1070.904     ,   321.6204    , -1087.002     ],
           ...,
           [ 1067.4       ,   319.936     ,  1088.49      ],
           [ 1067.615     ,   319.2095    ,  1091.61      ],
           [ 1068.275     ,   319.227     ,  1114.875     ]],

          ...,

          [[           nan,            nan,            nan],
           [ 1352.48      ,   458.988     , -1405.22      ],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[ 1357.74      ,   467.735     , -1438.69      ],
           [ 1353.09      ,   460.121     , -1403.71      ],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[ 1361.05      ,   469.638     , -1437.88      ],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]]],


         [[[ 1053.135     ,   306.302     , -1091.205     ],
           [ 1053.954     ,   301.5524    , -1074.834     ],
           [ 1050.365     ,   303.3465    , -1057.99      ],
           ...,
           [ 1048.55      ,   304.928     ,  1060.35      ],
           [ 1052.39666667,   298.38633333,  1074.47      ],
           [ 1053.682     ,   300.3252    ,  1088.304     ]],

          [[ 1065.46      ,   309.10433333, -1103.97833333],
           [ 1067.83      ,   308.149     , -1091.606     ],
           [ 1065.055     ,   309.195     , -1074.79      ],
           ...,
           [ 1067.18      ,   316.165     ,  1079.18      ],
           [ 1066.77      ,   313.035     ,  1098.53      ],
           [ 1063.475     ,   310.9225    ,  1104.03      ]],

          [[ 1075.01      ,   316.0288    , -1116.886     ],
           [ 1071.89666667,   315.25833333, -1098.11666667],
           [ 1074.71      ,   312.57866667, -1083.76333333],
           ...,
           [ 1067.99      ,   316.79      ,  1078.17      ],
           [ 1070.89      ,   317.59      ,  1097.91      ],
           [ 1077.03666667,   315.76066667,  1121.88666667]],

          ...,

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [ 1360.23      ,   455.173     ,  1435.        ]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]]]],



        [[[[ 1041.105     ,   336.59233333, -1091.2       ],
           [ 1040.85375   ,   336.0695    , -1072.81625   ],
           [ 1041.73166667,   337.96966667, -1068.11666667],
           ...,
           [ 1044.89      ,   333.8565    ,  1062.89      ],
           [ 1037.54      ,   339.231     ,  1079.94      ],
           [ 1036.43      ,   337.964     ,  1079.51      ]],

          [[ 1053.52333333,   340.91366667, -1104.18333333],
           [ 1051.9125    ,   340.625     , -1086.135     ],
           [ 1056.4525    ,   340.35125   , -1079.5175    ],
           ...,
           [ 1054.79      ,   339.238     ,  1069.76      ],
           [           nan,            nan,            nan],
           [ 1052.02      ,   341.922     ,  1105.32      ]],

          [[ 1061.926     ,   346.4208    , -1117.43      ],
           [ 1065.36      ,   347.585     , -1101.556     ],
           [ 1066.40166667,   344.61983333, -1086.57666667],
           ...,
           [ 1065.095     ,   343.4545    ,  1087.19      ],
           [           nan,            nan,            nan],
           [ 1063.885     ,   353.4075    ,  1120.565     ]],

          ...,

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[ 1361.17      ,   499.826     , -1453.49      ],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [ 1360.65      ,   497.345     ,  1450.54      ]]],


         [[[ 1048.435     ,   327.81575   , -1097.63125   ],
           [ 1050.19857143,   325.20671429, -1079.21571429],
           [ 1048.3625    ,   324.27225   , -1065.24      ],
           ...,
           [ 1045.18      ,   320.702     ,  1060.01      ],
           [ 1042.99      ,   329.323     ,  1079.77      ],
           [ 1044.13      ,   324.85766667,  1084.35333333]],

          [[ 1055.37166667,   335.2145    , -1104.69      ],
           [ 1057.58142857,   330.35271429, -1084.57142857],
           [ 1056.75      ,   331.7455    , -1077.165     ],
           ...,
           [           nan,            nan,            nan],
           [ 1062.895     ,   329.524     ,  1095.2       ],
           [ 1058.14666667,   333.006     ,  1101.75333333]],

          [[ 1066.35333333,   342.025     , -1120.23      ],
           [ 1071.93      ,   341.91      , -1105.145     ],
           [ 1065.22      ,   341.923     , -1083.57666667],
           ...,
           [ 1070.74      ,   334.389     ,  1085.49      ],
           [           nan,            nan,            nan],
           [ 1071.64      ,   336.324     ,  1121.75      ]],

          ...,

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [ 1343.91      ,   477.187     ,  1392.88      ],
           [ 1342.63      ,   474.506     ,  1393.21      ],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[ 1360.9       ,   494.06      , -1448.73      ],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]]]],



        [[[[ 1032.4175    ,   359.238125  , -1087.185     ],
           [ 1034.758     ,   360.2996    , -1078.43      ],
           [ 1036.33833333,   360.237     , -1070.18833333],
           ...,
           [ 1033.68      ,   356.856     ,  1068.37      ],
           [ 1032.53333333,   361.061     ,  1076.82      ],
           [ 1031.12666667,   358.2       ,  1088.11666667]],

          [[ 1044.668     ,   366.3034    , -1104.876     ],
           [ 1043.14      ,   365.308     , -1087.28777778],
           [ 1045.238     ,   362.86      , -1077.952     ],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [ 1047.9375    ,   364.39275   ,  1108.89      ]],

          [[ 1055.12333333,   368.59      , -1115.08166667],
           [ 1056.81      ,   366.471     , -1102.98      ],
           [ 1061.095     ,   369.462     , -1089.74      ],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [ 1056.522     ,   369.4894    ,  1117.224     ]],

          ...,

          [[           nan,            nan,            nan],
           [ 1317.82      ,   521.562     , -1391.06      ],
           [ 1322.1       ,   520.895     , -1390.72      ],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]]],


         [[[ 1039.103     ,   348.4076    , -1089.304     ],
           [ 1040.87      ,   348.4318    , -1080.45      ],
           [ 1039.105     ,   350.3915    , -1062.90833333],
           ...,
           [ 1039.175     ,   345.6385    ,  1066.855     ],
           [ 1037.87      ,   347.131     ,  1071.47      ],
           [ 1039.08      ,   349.5458    ,  1092.762     ]],

          [[ 1051.97333333,   354.178     , -1105.28166667],
           [ 1053.73      ,   354.1825    , -1097.36      ],
           [ 1054.1725    ,   354.888     , -1080.5725    ],
           ...,
           [ 1051.865     ,   356.77425   ,  1072.2325    ],
           [           nan,            nan,            nan],
           [ 1051.16      ,   358.8225    ,  1106.4       ]],

          [[ 1059.53333333,   359.09766667, -1112.09666667],
           [ 1063.84333333,   364.1       , -1101.54666667],
           [ 1060.23      ,   360.575     , -1089.585     ],
           ...,
           [ 1059.36666667,   357.813     ,  1084.55      ],
           [           nan,            nan,            nan],
           [ 1058.67      ,   355.477     ,  1103.95      ]],

          ...,

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [ 1329.99      ,   508.197     ,  1424.29      ]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]]]],



        [[[[ 1026.6425    ,   381.7205    , -1090.08      ],
           [ 1024.58      ,   382.92566667, -1075.37833333],
           [ 1027.112     ,   383.8561    , -1066.939     ],
           ...,
           [ 1026.94      ,   385.374     ,  1067.415     ],
           [ 1030.07      ,   388.096     ,  1079.43      ],
           [ 1027.722     ,   382.9992    ,  1094.196     ]],

          [[ 1037.57166667,   384.8085    , -1100.06833333],
           [ 1037.9025    ,   389.142     , -1092.6975    ],
           [ 1037.73      ,   386.77311111, -1074.65      ],
           ...,
           [ 1032.795     ,   390.2945    ,  1078.75      ],
           [ 1033.66      ,   389.46033333,  1089.28333333],
           [ 1030.90333333,   389.25833333,  1098.38333333]],

          [[ 1048.218     ,   391.4314    , -1117.696     ],
           [ 1042.865     ,   395.893     , -1094.7       ],
           [ 1049.7175    ,   392.10225   , -1085.1       ],
           ...,
           [ 1047.1       ,   398.902     ,  1092.07      ],
           [           nan,            nan,            nan],
           [ 1048.382     ,   392.4612    ,  1114.974     ]],

          ...,

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [ 1321.45      ,   559.771     , -1394.08      ],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]]],


         [[[ 1032.31090909,   370.18745455, -1089.75636364],
           [ 1034.06166667,   369.54883333, -1079.75333333],
           [ 1035.13125   ,   371.847875  , -1066.66      ],
           ...,
           [ 1030.975     ,   369.811     ,  1062.545     ],
           [ 1033.72      ,   370.488     ,  1076.87666667],
           [ 1027.34666667,   371.96233333,  1083.6       ]],

          [[ 1042.57833333,   375.47233333, -1097.52333333],
           [ 1044.72555556,   375.77111111, -1093.53111111],
           [ 1041.08285714,   376.43242857, -1073.86857143],
           ...,
           [ 1038.975     ,   379.8335    ,  1076.855     ],
           [ 1036.94      ,   379.793     ,  1081.41      ],
           [ 1043.81333333,   378.37466667,  1106.63      ]],

          [[ 1053.69      ,   380.015     , -1112.0225    ],
           [ 1052.656     ,   379.621     , -1100.648     ],
           [ 1059.275     ,   382.4875    , -1091.545     ],
           ...,
           [ 1056.62      ,   381.12      ,  1084.04      ],
           [ 1049.645     ,   382.319     ,  1092.96      ],
           [ 1050.71      ,   378.521     ,  1111.385     ]],

          ...,

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[ 1332.22      ,   543.33      , -1440.33      ],
           [ 1332.26      ,   542.833     , -1406.91      ],
           [ 1334.79      ,   540.636     , -1405.38      ],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [ 1345.52      ,   545.253     ,  1453.28      ]]]],



        [[[[ 1018.24      ,   405.298     , -1093.605     ],
           [ 1019.26666667,   404.7995    , -1078.625     ],
           [ 1016.84857143,   403.999     , -1062.84285714],
           ...,
           [ 1012.34      ,   405.222     ,  1066.24      ],
           [           nan,            nan,            nan],
           [ 1014.8       ,   404.0315    ,  1092.645     ]],

          [[ 1028.59833333,   409.46983333, -1099.04      ],
           [ 1027.168     ,   409.791     , -1088.948     ],
           [ 1030.27      ,   407.29025   , -1076.9425    ],
           ...,
           [           nan,            nan,            nan],
           [ 1026.55      ,   409.4845    ,  1087.83      ],
           [ 1026.42      ,   403.151     ,  1090.66      ]],

          [[ 1041.19      ,   414.23371429, -1116.48142857],
           [ 1041.95      ,   413.4025    , -1105.16      ],
           [ 1042.65666667,   414.094     , -1088.40666667],
           ...,
           [           nan,            nan,            nan],
           [ 1040.17      ,   412.294     ,  1105.2       ],
           [ 1038.4       ,   412.8945    ,  1107.78      ]],

          ...,

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[ 1305.61      ,   586.975     , -1436.7       ],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]]],


         [[[ 1022.418     ,   393.5288    , -1087.96      ],
           [ 1022.05428571,   392.02271429, -1076.25714286],
           [ 1023.884     ,   393.5838    , -1061.68      ],
           ...,
           [           nan,            nan,            nan],
           [ 1031.2       ,   393.163     ,  1080.4       ],
           [ 1024.54      ,   394.399     ,  1095.48333333]],

          [[ 1036.21      ,   401.513875  , -1108.62125   ],
           [ 1033.195     ,   401.775     , -1087.05      ],
           [ 1030.30333333,   399.878     , -1070.13333333],
           ...,
           [           nan,            nan,            nan],
           [ 1031.96      ,   393.363     ,  1079.77      ],
           [ 1034.98      ,   400.646     ,  1108.86333333]],

          [[ 1043.49125   ,   404.653875  , -1114.39375   ],
           [ 1043.91166667,   404.29216667, -1101.05666667],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [ 1050.33      ,   405.351     ,  1101.29      ],
           [ 1039.405     ,   408.948     ,  1110.415     ]],

          ...,

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [ 1308.03      ,   563.164     ,  1424.87      ]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]]]]],




       ...,




       [[[[[  677.49972727,  -858.79718182, -1090.38818182],
           [  679.755     ,  -859.7535    , -1081.45      ],
           [  677.95542857,  -857.77185714, -1061.16      ],
           ...,
           [  682.31      ,  -858.264     ,  1071.39      ],
           [  684.182     ,  -857.6065    ,  1076.47      ],
           [  678.40183333,  -857.723     ,  1092.89833333]],

          [[  687.69325   ,  -869.93275   , -1104.69875   ],
           [  690.054     ,  -866.585     , -1092.24666667],
           [  693.995     ,  -869.1       , -1086.7       ],
           ...,
           [           nan,            nan,            nan],
           [  691.637     ,  -867.888     ,  1098.13      ],
           [  688.01733333,  -868.78033333,  1104.74      ]],

          [[  693.929     ,  -873.2644    , -1113.316     ],
           [  695.46133333,  -873.87466667, -1097.30333333],
           [  693.12966667,  -877.35433333, -1088.48      ],
           ...,
           [  694.907     ,  -878.347     ,  1090.13      ],
           [  702.0305    ,  -876.675     ,  1106.135     ],
           [  701.5115    ,  -872.612     ,  1116.34      ]],

          ...,

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [  930.568     , -1077.25      , -1389.14      ],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [  927.854     , -1075.51      ,  1423.75      ]],

          [[  932.98      , -1085.57      , -1434.92      ],
           [           nan,            nan,            nan],
           [  931.669     , -1091.7       , -1387.9       ],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[  935.825     , -1096.05      , -1434.17      ],
           [           nan,            nan,            nan],
           [  942.56      , -1102.5       , -1406.13      ],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]]],


         [[[  671.67714286,  -865.714     , -1092.09714286],
           [  670.934     ,  -869.6935    , -1080.42      ],
           [  670.90028571,  -864.23857143, -1061.63142857],
           ...,
           [  669.645     ,  -866.661     ,  1060.62666667],
           [           nan,            nan,            nan],
           [  673.218     ,  -868.48      ,  1094.34      ]],

          [[  683.38533333,  -873.106     , -1108.05666667],
           [  683.27475   ,  -876.62875   , -1091.2625    ],
           [  682.0814    ,  -875.7544    , -1073.38      ],
           ...,
           [  681.0315    ,  -875.4175    ,  1075.495     ],
           [  685.08      ,  -879.033     ,  1091.03      ],
           [           nan,            nan,            nan]],

          [[  688.08233333,  -886.50133333, -1111.92      ],
           [  690.5754    ,  -883.879     , -1102.05      ],
           [  689.01      ,  -875.052     , -1080.94      ],
           ...,
           [  694.969     ,  -880.709     ,  1095.63      ],
           [  688.5095    ,  -880.9365    ,  1092.875     ],
           [  688.183     ,  -886.998     ,  1118.45      ]],

          ...,

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[  931.792     , -1108.79      , -1448.4       ],
           [           nan,            nan,            nan],
           [  942.634     , -1103.33      , -1407.28      ],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]]]],



        [[[[  699.12528571,  -841.68085714, -1092.37714286],
           [  697.48342857,  -843.01985714, -1073.99571429],
           [  697.55709091,  -843.13454545, -1062.11636364],
           ...,
           [  696.901     ,  -840.482     ,  1062.53      ],
           [  702.006     ,  -848.994     ,  1080.46      ],
           [  697.132     ,  -837.961     ,  1087.61      ]],

          [[  706.36616667,  -850.34366667, -1100.93166667],
           [  706.6305    ,  -852.869375  , -1092.01      ],
           [  704.196     ,  -847.119     , -1071.24      ],
           ...,
           [  704.159     ,  -851.01733333,  1073.00666667],
           [  701.968     ,  -850.7       ,  1079.        ],
           [  704.187     ,  -854.9165    ,  1103.955     ]],

          [[  713.72466667,  -861.85216667, -1114.35      ],
           [  714.03257143,  -860.16828571, -1100.42571429],
           [  716.41616667,  -861.86033333, -1090.755     ],
           ...,
           [           nan,            nan,            nan],
           [  721.2035    ,  -859.4925    ,  1107.555     ],
           [  714.816     ,  -857.828     ,  1108.075     ]],

          ...,

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [  952.877     , -1055.86      ,  1402.84      ],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]]],


         [[[  689.511     ,  -846.593     , -1083.555     ],
           [  691.8068    ,  -852.6228    , -1077.332     ],
           [  690.82757143,  -850.88385714, -1061.09857143],
           ...,
           [  688.6295    ,  -855.7275    ,  1067.75      ],
           [  691.507     ,  -859.454     ,  1084.14      ],
           [  687.241     ,  -850.023     ,  1085.09      ]],

          [[  703.182     ,  -862.6805    , -1108.64      ],
           [  696.94633333,  -859.47466667, -1086.55333333],
           [  695.55666667,  -858.11333333, -1068.78666667],
           ...,
           [           nan,            nan,            nan],
           [  699.2965    ,  -865.795     ,  1095.115     ],
           [  705.4725    ,  -858.1545    ,  1104.54      ]],

          [[  708.18128571,  -871.64785714, -1119.01      ],
           [  709.276     ,  -870.99425   , -1105.7325    ],
           [  703.7275    ,  -870.0695    , -1078.4       ],
           ...,
           [  710.964     ,  -870.1085    ,  1091.075     ],
           [  704.2155    ,  -869.961     ,  1095.375     ],
           [  706.5925    ,  -866.456     ,  1112.465     ]],

          ...,

          [[  944.293     , -1068.22      , -1426.96      ],
           [           nan,            nan,            nan],
           [  940.074     , -1075.22      , -1391.57      ],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [  943.027     , -1075.66      , -1394.3       ],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]]]],



        [[[[  714.4874    ,  -827.6199    , -1090.291     ],
           [  715.27633333,  -828.67766667, -1078.01666667],
           [  713.4562    ,  -825.0174    , -1059.636     ],
           ...,
           [  712.01475   ,  -827.53075   ,  1064.115     ],
           [  711.14433333,  -828.015     ,  1069.28333333],
           [           nan,            nan,            nan]],

          [[  725.84983333,  -835.694     , -1104.97833333],
           [  727.74614286,  -833.79142857, -1085.79      ],
           [  726.57383333,  -839.03483333, -1077.97666667],
           ...,
           [  725.61466667,  -835.65666667,  1077.55666667],
           [  723.75133333,  -837.35066667,  1085.40333333],
           [  731.646     ,  -836.576     ,  1112.1       ]],

          [[  732.1798    ,  -841.9434    , -1113.264     ],
           [  733.3645    ,  -849.2185    , -1102.34      ],
           [  729.4395    ,  -846.0375    , -1089.715     ],
           ...,
           [  732.816     ,  -836.659     ,  1076.46      ],
           [  731.951     ,  -844.525     ,  1098.2225    ],
           [  732.85233333,  -841.39033333,  1112.87      ]],

          ...,

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]]],


         [[[  707.09116667,  -835.38683333, -1091.56333333],
           [  707.28957143,  -835.76628571, -1074.63571429],
           [  707.2915    ,  -837.806     , -1063.82375   ],
           ...,
           [  706.197     ,  -839.745     ,  1069.57      ],
           [  707.597     ,  -837.44533333,  1073.84      ],
           [  702.711     ,  -838.278     ,  1091.66      ]],

          [[  720.39      ,  -849.486     , -1111.15      ],
           [  713.914     ,  -846.134     , -1081.16      ],
           [  716.46971429,  -845.75514286, -1073.94571429],
           ...,
           [  720.64      ,  -850.635     ,  1076.03      ],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[  726.42933333,  -851.97255556, -1115.50111111],
           [  730.367     ,  -855.781     , -1111.19      ],
           [  729.13333333,  -853.62816667, -1088.91333333],
           ...,
           [  723.8225    ,  -854.872     ,  1079.84      ],
           [  727.259     ,  -857.821     ,  1108.26      ],
           [           nan,            nan,            nan]],

          ...,

          [[           nan,            nan,            nan],
           [  956.865     , -1048.03      , -1401.05      ],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [  981.049     , -1069.21      ,  1409.59      ],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]]]],



        [[[[  732.224     ,  -813.8306    , -1091.082     ],
           [  731.69183333,  -810.94633333, -1074.97      ],
           [  732.30622222,  -812.625     , -1064.77666667],
           ...,
           [  734.5636    ,  -808.9594    ,  1063.948     ],
           [  735.98725   ,  -809.15725   ,  1075.745     ],
           [           nan,            nan,            nan]],

          [[  744.55925   ,  -822.953625  , -1109.77      ],
           [  744.435     ,  -827.857     , -1087.79      ],
           [  741.8045    ,  -819.967     , -1075.1675    ],
           ...,
           [  742.613     ,  -819.176     ,  1071.76      ],
           [  741.161     ,  -824.4915    ,  1092.73      ],
           [  745.08525   ,  -825.198     ,  1108.98      ]],

          [[  753.835875  ,  -828.23375   , -1118.91875   ],
           [           nan,            nan,            nan],
           [  746.278     ,  -827.941     , -1086.79      ],
           ...,
           [  746.587     ,  -827.486     ,  1088.63      ],
           [  746.676     ,  -829.039     ,  1091.25      ],
           [  746.91566667,  -826.11733333,  1110.80666667]],

          ...,

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [ 1009.05      , -1025.15      ,  1419.21      ],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [ 1011.86      , -1024.42      ,  1420.19      ],
           [           nan,            nan,            nan]]],


         [[[  726.00371429,  -820.70257143, -1091.34      ],
           [  725.98283333,  -819.733     , -1075.52166667],
           [  724.438     ,  -819.05616667, -1061.80166667],
           ...,
           [  723.021     ,  -824.12225   ,  1062.3825    ],
           [  726.472     ,  -815.657     ,  1067.76      ],
           [  725.293     ,  -820.3455    ,  1091.225     ]],

          [[  735.768     ,  -828.007     , -1101.44857143],
           [  734.191     ,  -826.9975    , -1085.71      ],
           [  736.93633333,  -833.271     , -1076.80333333],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [  739.563     ,  -834.587     ,  1113.87      ]],

          [[  744.2075    ,  -837.6105    , -1110.72      ],
           [  746.723     ,  -838.101     , -1102.88666667],
           [  743.59975   ,  -836.168     , -1082.5225    ],
           ...,
           [  747.338     ,  -843.108     ,  1088.97      ],
           [           nan,            nan,            nan],
           [  745.47      ,  -836.72366667,  1116.31666667]],

          ...,

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[ 1005.64      , -1046.49      , -1444.44      ],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]]]],



        [[[[  751.55722222,  -797.55677778, -1092.27777778],
           [  749.6361    ,  -796.3471    , -1075.718     ],
           [  750.04375   ,  -794.4745    , -1060.71      ],
           ...,
           [  748.346     ,  -795.245     ,  1065.53      ],
           [  747.0805    ,  -795.2115    ,  1068.615     ],
           [  748.759     ,  -800.336     ,  1096.3       ]],

          [[  758.8098    ,  -803.0701    , -1102.833     ],
           [  757.03333333,  -806.636     , -1090.46666667],
           [  759.07625   ,  -808.5825    , -1073.8025    ],
           ...,
           [  760.146     ,  -809.218     ,  1073.26      ],
           [  762.142     ,  -804.717     ,  1089.375     ],
           [           nan,            nan,            nan]],

          [[  770.3735    ,  -813.7205    , -1119.79      ],
           [  769.62433333,  -812.52366667, -1098.42      ],
           [  768.8976    ,  -815.338     , -1086.658     ],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [  776.28      ,  -810.356     ,  1118.92      ]],

          ...,

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [ 1034.39      , -1015.61      ,  1416.75      ],
           [ 1034.58      , -1013.16      ,  1417.61      ],
           [           nan,            nan,            nan]]],


         [[[  745.042375  ,  -807.302125  , -1091.9025    ],
           [  743.63566667,  -806.9185    , -1078.835     ],
           [  743.60445455,  -806.00954545, -1062.85181818],
           ...,
           [           nan,            nan,            nan],
           [  742.425     ,  -805.904     ,  1080.655     ],
           [  745.5225    ,  -808.189     ,  1092.865     ]],

          [[  754.01271429,  -811.181     , -1100.64      ],
           [  751.2825    ,  -813.74183333, -1088.66833333],
           [  748.647     ,  -814.624     , -1068.805     ],
           ...,
           [           nan,            nan,            nan],
           [  751.979     ,  -813.153     ,  1093.48      ],
           [  755.0535    ,  -814.94825   ,  1107.285     ]],

          [[  763.88633333,  -823.89433333, -1117.76666667],
           [  761.97425   ,  -822.91975   , -1100.4175    ],
           [  761.32633333,  -821.55516667, -1085.445     ],
           ...,
           [  770.033     ,  -819.336     ,  1092.41      ],
           [  759.098     ,  -821.45      ,  1095.5       ],
           [  760.167     ,  -814.8105    ,  1111.48      ]],

          ...,

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [ 1033.94      , -1017.73      ,  1416.05      ],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]]]],



        [[[[  768.05472727,  -778.18518182, -1089.16909091],
           [  766.99475   ,  -779.278625  , -1077.39625   ],
           [  769.6555    ,  -780.15375   , -1062.265     ],
           ...,
           [  770.243     ,  -787.162     ,  1075.26      ],
           [  770.052     ,  -785.62      ,  1075.9       ],
           [  768.515     ,  -775.442     ,  1093.24      ]],

          [[  777.86775   ,  -786.58175   , -1099.5125    ],
           [  779.217     ,  -787.88725   , -1089.34      ],
           [  777.0576    ,  -785.4028    , -1074.878     ],
           ...,
           [           nan,            nan,            nan],
           [  783.265     ,  -786.234     ,  1095.98      ],
           [           nan,            nan,            nan]],

          [[  784.913     ,  -797.852     , -1113.06      ],
           [  788.3145    ,  -796.81275   , -1101.3625    ],
           [  786.8215    ,  -798.876     , -1088.565     ],
           ...,
           [           nan,            nan,            nan],
           [  788.381     ,  -800.261     ,  1107.58      ],
           [  785.14466667,  -796.954     ,  1115.36666667]],

          ...,

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [ 1045.93      ,  -986.631     , -1393.27      ],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]]],


         [[[  760.77675   ,  -787.983375  , -1087.51125   ],
           [  760.05518182,  -786.64245455, -1076.97636364],
           [  760.91575   ,  -788.39275   , -1063.34      ],
           ...,
           [           nan,            nan,            nan],
           [  764.434     ,  -791.0465    ,  1078.11      ],
           [  761.065     ,  -786.735     ,  1093.71      ]],

          [[  769.9332    ,  -798.662     , -1104.578     ],
           [  769.526     ,  -789.949     , -1088.25      ],
           [  767.783     ,  -797.59866667, -1071.11333333],
           ...,
           [           nan,            nan,            nan],
           [  772.138     ,  -796.71      ,  1091.815     ],
           [  770.603     ,  -797.261     ,  1106.56      ]],

          [[  781.25775   ,  -805.65925   , -1120.29      ],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [  781.769     ,  -800.97566667,  1083.27666667],
           [  780.99      ,  -802.374     ,  1100.525     ],
           [  782.138     ,  -809.306     ,  1119.78      ]],

          ...,

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [ 1033.5       ,  -993.338     , -1388.34      ],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]]]]],




       [[[[[  564.81071429,  -937.25657143, -1092.39428571],
           [  564.96433333,  -938.21683333, -1076.29333333],
           [  564.248     ,  -936.80725   , -1066.85      ],
           ...,
           [  563.1795    ,  -939.0665    ,  1069.22      ],
           [  561.5065    ,  -937.9375    ,  1073.525     ],
           [  562.1622    ,  -938.7856    ,  1092.572     ]],

          [[  569.85971429,  -947.51171429, -1105.07      ],
           [  568.4385    ,  -952.1135    , -1088.725     ],
           [  566.926     ,  -951.411     , -1080.07      ],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [  568.2825    ,  -949.7515    ,  1106.1       ]],

          [[  578.0595    ,  -958.63366667, -1119.78333333],
           [  570.642     ,  -956.538     , -1095.01      ],
           [  581.092125  ,  -959.845375  , -1091.2075    ],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [  574.713     ,  -960.387     ,  1119.445     ]],

          ...,

          [[           nan,            nan,            nan],
           [  786.015     , -1191.21      , -1408.06      ],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [  783.375     , -1188.82      ,  1399.53      ],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [  787.132     , -1191.61      , -1408.32      ],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]]],


         [[[  552.5968    ,  -946.1142    , -1091.194     ],
           [  553.1366    ,  -949.542     , -1080.664     ],
           [  553.62177778,  -944.10055556, -1058.12888889],
           ...,
           [  551.54466667,  -948.31333333,  1064.01333333],
           [  557.327     ,  -947.702     ,  1081.4       ],
           [  556.635     ,  -942.149     ,  1094.44      ]],

          [[  564.10683333,  -956.8595    , -1108.12      ],
           [  561.12633333,  -961.43066667, -1092.93666667],
           [  558.43      ,  -958.9025    , -1076.61      ],
           ...,
           [  555.382     ,  -955.204     ,  1074.29      ],
           [  564.05375   ,  -954.82425   ,  1092.2525    ],
           [  557.744     ,  -957.9185    ,  1098.03      ]],

          [[  570.1218    ,  -966.9368    , -1119.5       ],
           [  569.35766667,  -967.847     , -1106.59      ],
           [  568.48633333,  -965.402     , -1084.85333333],
           ...,
           [  570.085     ,  -958.462     ,  1088.32      ],
           [  565.2695    ,  -961.2365    ,  1095.355     ],
           [  569.716     ,  -971.623     ,  1117.        ]],

          ...,

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]]]],



        [[[[  578.75266667,  -924.77233333, -1080.65333333],
           [  584.1435    ,  -926.3123    , -1076.279     ],
           [  586.68525   ,  -925.92825   , -1069.96      ],
           ...,
           [  588.066     ,  -927.447     ,  1066.66      ],
           [  581.238     ,  -923.138     ,  1077.18      ],
           [  583.2165    ,  -925.69425   ,  1094.44      ]],

          [[  591.99325   ,  -940.148     , -1108.83      ],
           [  587.9585    ,  -936.93475   , -1086.53      ],
           [  589.43766667,  -938.10633333, -1073.60333333],
           ...,
           [  590.451     ,  -939.95      ,  1084.12      ],
           [  589.464     ,  -940.937     ,  1085.08      ],
           [  586.2155    ,  -938.5715    ,  1103.165     ]],

          [[  597.31783333,  -944.52516667, -1114.46333333],
           [  598.215     ,  -945.29666667, -1101.93333333],
           [  596.619     ,  -950.28066667, -1087.69      ],
           ...,
           [           nan,            nan,            nan],
           [  596.454     ,  -950.131     ,  1108.2       ],
           [  598.8655    ,  -947.7115    ,  1115.46      ]],

          ...,

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[  809.777     , -1178.17      , -1432.54      ],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]]],


         [[[  572.20966667,  -934.59633333, -1086.90833333],
           [  573.269     ,  -934.3034    , -1075.797     ],
           [  571.758     ,  -932.83      , -1064.7675    ],
           ...,
           [  571.83      ,  -936.619     ,  1068.72      ],
           [  569.1945    ,  -935.566     ,  1072.695     ],
           [  579.8955    ,  -935.458     ,  1099.165     ]],

          [[  582.211     ,  -943.28825   , -1104.5275    ],
           [  582.5975    ,  -950.5415    , -1094.51      ],
           [  584.957     ,  -946.991     , -1079.17      ],
           ...,
           [           nan,            nan,            nan],
           [  579.619     ,  -948.043     ,  1089.72      ],
           [  583.4455    ,  -943.388     ,  1103.335     ]],

          [[  592.7784    ,  -949.2594    , -1115.852     ],
           [  588.98333333,  -948.35566667, -1096.34666667],
           [  591.3745    ,  -947.043     , -1084.285     ],
           ...,
           [  594.625     ,  -952.0125    ,  1092.99      ],
           [  590.5525    ,  -952.9925    ,  1100.985     ],
           [  587.16233333,  -953.659     ,  1112.27333333]],

          ...,

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [  814.677     , -1200.12      ,  1412.54      ],
           [  813.093     , -1196.        ,  1415.08      ],
           [           nan,            nan,            nan]]]],



        [[[[  603.7845    ,  -913.3015    , -1092.875     ],
           [  603.00471429,  -910.68757143, -1072.66571429],
           [  603.317     ,  -913.8102    , -1066.098     ],
           ...,
           [           nan,            nan,            nan],
           [  599.5915    ,  -913.87575   ,  1079.24      ],
           [  602.188     ,  -914.781     ,  1083.94      ]],

          [[  609.06157143,  -924.192     , -1102.92714286],
           [  610.6876    ,  -923.8064    , -1094.03      ],
           [  612.655     ,  -925.6135    , -1074.57      ],
           ...,
           [           nan,            nan,            nan],
           [  613.162     ,  -919.421     ,  1088.14      ],
           [  607.861     ,  -927.252     ,  1107.06      ]],

          [[  618.0952    ,  -931.7793    , -1112.969     ],
           [  617.51025   ,  -933.21275   , -1099.775     ],
           [  618.09066667,  -928.944     , -1081.84666667],
           ...,
           [           nan,            nan,            nan],
           [  618.6995    ,  -931.5475    ,  1098.03      ],
           [  617.0875    ,  -934.2735    ,  1119.46      ]],

          ...,

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]]],


         [[[  594.0734    ,  -922.7572    , -1093.556     ],
           [  591.13166667,  -922.109     , -1077.3       ],
           [  595.16      ,  -925.28433333, -1066.20333333],
           ...,
           [  594.413     ,  -919.903     ,  1067.44      ],
           [  594.1732    ,  -916.4866    ,  1073.072     ],
           [  594.456     ,  -920.25766667,  1087.67      ]],

          [[  600.98      ,  -928.69166667, -1097.62666667],
           [  600.85025   ,  -935.26725   , -1091.9725    ],
           [  596.375     ,  -931.525     , -1071.22      ],
           ...,
           [  601.402     ,  -936.923     ,  1075.47      ],
           [  600.171     ,  -934.2       ,  1089.66      ],
           [  599.551     ,  -929.3245    ,  1102.865     ]],

          [[  609.894     ,  -936.189     , -1116.86      ],
           [  607.15333333,  -942.70633333, -1100.13333333],
           [  613.25475   ,  -941.21175   , -1088.3575    ],
           ...,
           [  611.202     ,  -946.369     ,  1091.62      ],
           [  614.227     ,  -941.253     ,  1110.295     ],
           [  608.139     ,  -942.8555    ,  1110.615     ]],

          ...,

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[  831.093     , -1175.28      , -1441.6       ],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[  832.517     , -1176.2       , -1441.61      ],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]]]],



        [[[[  622.394375  ,  -902.112875  , -1091.8525    ],
           [  620.567     ,  -898.8044    , -1076.078     ],
           [  621.76625   ,  -903.534375  , -1065.68875   ],
           ...,
           [           nan,            nan,            nan],
           [  623.032     ,  -909.546     ,  1084.04      ],
           [  620.2535    ,  -903.76575   ,  1094.3725    ]],

          [[  629.38166667,  -910.16833333, -1103.54666667],
           [  632.837     ,  -904.751     , -1087.57      ],
           [  629.47457143,  -909.76557143, -1072.88714286],
           ...,
           [           nan,            nan,            nan],
           [  629.61066667,  -910.14      ,  1090.14      ],
           [  627.52833333,  -908.03966667,  1100.83666667]],

          [[  637.719     ,  -921.159     , -1116.07142857],
           [  638.7295    ,  -920.67025   , -1104.875     ],
           [  638.363     ,  -918.00975   , -1085.5       ],
           ...,
           [           nan,            nan,            nan],
           [  645.056     ,  -918.802     ,  1098.77      ],
           [  638.562     ,  -924.859     ,  1112.9       ]],

          ...,

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [  860.491     , -1149.5       ,  1437.78      ]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]]],


         [[[  616.459     ,  -909.00125   , -1090.37      ],
           [  611.848     ,  -909.70028571, -1076.67142857],
           [  613.6993    ,  -909.155     , -1067.24      ],
           ...,
           [           nan,            nan,            nan],
           [  615.138     ,  -903.295     ,  1077.19      ],
           [  613.59566667,  -910.18966667,  1094.41      ]],

          [[  622.53166667,  -918.19988889, -1100.32555556],
           [  621.9418    ,  -917.6225    , -1088.757     ],
           [  622.16822222,  -918.20577778, -1075.64777778],
           ...,
           [  621.3885    ,  -921.8805    ,  1078.145     ],
           [  619.288     ,  -920.3045    ,  1088.3       ],
           [           nan,            nan,            nan]],

          [[  628.85      ,  -928.72      , -1118.32      ],
           [  629.53175   ,  -924.319     , -1100.8525    ],
           [  627.0772    ,  -927.6504    , -1086.93      ],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [  637.593     ,  -926.279     ,  1116.86      ]],

          ...,

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[  851.399     , -1151.26      , -1433.65      ],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]]]],



        [[[[  644.01      ,  -888.8855    , -1093.652     ],
           [  642.35      ,  -886.501     , -1076.78333333],
           [  640.49575   ,  -882.65325   , -1058.53      ],
           ...,
           [           nan,            nan,            nan],
           [  645.244     ,  -883.808     ,  1081.17      ],
           [  638.751     ,  -884.31      ,  1091.32      ]],

          [[  648.407875  ,  -895.848625  , -1101.96      ],
           [  650.31033333,  -896.398     , -1090.465     ],
           [  650.959     ,  -903.559     , -1082.22      ],
           ...,
           [           nan,            nan,            nan],
           [  647.477     ,  -898.76      ,  1088.73      ],
           [           nan,            nan,            nan]],

          [[  658.05871429,  -904.46357143, -1112.72428571],
           [  655.4032    ,  -905.7418    , -1102.312     ],
           [  657.68625   ,  -907.0675    , -1088.07      ],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [  659.2045    ,  -902.6155    ,  1118.995     ]],

          ...,

          [[  883.057     , -1118.51      , -1427.79      ],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [  884.198     , -1116.71      ,  1378.15      ],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[  885.564     , -1120.63      , -1426.92      ],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [  899.601     , -1136.87      , -1423.86      ],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]]],


         [[[  632.28525   ,  -899.29125   , -1092.785     ],
           [  631.84075   ,  -895.016375  , -1073.0625    ],
           [  632.1995    ,  -893.95483333, -1066.54166667],
           ...,
           [  630.9365    ,  -892.3045    ,  1060.77      ],
           [  635.497     ,  -902.613     ,  1088.87      ],
           [  628.021     ,  -894.822     ,  1091.21      ]],

          [[  642.1045    ,  -905.286625  , -1103.98125   ],
           [  645.18375   ,  -905.1095    , -1093.6925    ],
           [  644.61742857,  -905.06142857, -1078.15857143],
           ...,
           [  638.407     ,  -902.846     ,  1066.5       ],
           [  637.281     ,  -901.38      ,  1087.1       ],
           [           nan,            nan,            nan]],

          [[  649.47175   ,  -912.6195    , -1115.82      ],
           [  648.64525   ,  -912.62875   , -1097.4575    ],
           [  650.353     ,  -917.859     , -1087.8       ],
           ...,
           [  651.4765    ,  -912.024     ,  1090.63      ],
           [           nan,            nan,            nan],
           [  648.34166667,  -914.979     ,  1117.74      ]],

          ...,

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [  876.533     , -1126.25      , -1393.71      ],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[  884.634     , -1135.01      , -1425.99      ],
           [  883.789     , -1136.        , -1424.36      ],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]]]],



        [[[[  662.070125  ,  -874.58225   , -1090.98      ],
           [  660.17225   ,  -873.9375    , -1078.2725    ],
           [  662.37442857,  -870.95471429, -1067.14857143],
           ...,
           [           nan,            nan,            nan],
           [  664.338     ,  -870.604     ,  1083.33      ],
           [  663.1135    ,  -873.197     ,  1094.49      ]],

          [[  668.6618    ,  -881.0194    , -1100.086     ],
           [  668.30025   ,  -879.54      , -1090.24      ],
           [  672.09133333,  -882.01633333, -1076.43333333],
           ...,
           [           nan,            nan,            nan],
           [  672.692     ,  -885.956     ,  1087.7       ],
           [  668.024     ,  -876.308     ,  1098.67      ]],

          [[  675.7475    ,  -889.70575   , -1115.9425    ],
           [  678.7665    ,  -890.2205    , -1098.615     ],
           [  677.30733333,  -887.689     , -1084.54      ],
           ...,
           [  674.0255    ,  -892.0855    ,  1092.295     ],
           [  673.536     ,  -889.346     ,  1090.87      ],
           [           nan,            nan,            nan]],

          ...,

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [  922.981     , -1112.1       , -1411.44      ],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]]],


         [[[  653.75633333,  -884.1235    , -1094.95333333],
           [  651.02828571,  -884.41742857, -1077.21714286],
           [  650.9175    ,  -882.44      , -1065.0225    ],
           ...,
           [  654.4695    ,  -884.9755    ,  1064.065     ],
           [           nan,            nan,            nan],
           [  652.306     ,  -881.32066667,  1095.59333333]],

          [[  659.5552    ,  -891.7114    , -1102.208     ],
           [  654.655     ,  -889.363     , -1090.01      ],
           [  660.319     ,  -893.47066667, -1076.82      ],
           ...,
           [  659.3625    ,  -884.531     ,  1068.735     ],
           [  657.88733333,  -892.20766667,  1086.3       ],
           [  664.323     ,  -885.657     ,  1101.12      ]],

          [[  670.9565    ,  -896.172     , -1114.31166667],
           [  668.9995    ,  -902.14175   , -1100.885     ],
           [  670.186     ,  -901.10625   , -1092.        ],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          ...,

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]]]]],




       [[[[[  435.518625  , -1002.463     , -1087.681875  ],
           [  437.847     , -1002.7043    , -1080.04      ],
           [  434.4048    , -1002.3634    , -1062.936     ],
           ...,
           [  433.618     , -1000.86133333,  1054.88666667],
           [           nan,            nan,            nan],
           [  433.3285    , -1001.915     ,  1086.43      ]],

          [[  442.1734    , -1013.432     , -1105.338     ],
           [  441.202     , -1013.105     , -1086.11      ],
           [  441.2836    , -1015.618     , -1074.474     ],
           ...,
           [           nan,            nan,            nan],
           [  447.798     , -1013.91      ,  1089.79      ],
           [  441.888     , -1016.52      ,  1108.875     ]],

          [[  447.45733333, -1024.78666667, -1111.35333333],
           [  448.123     , -1024.695     , -1102.67      ],
           [  450.513     , -1021.66      , -1087.58666667],
           ...,
           [  447.8045    , -1022.835     ,  1090.01      ],
           [  442.41      , -1024.12      ,  1092.68      ],
           [  443.695     , -1024.71      ,  1114.47      ]],

          ...,

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]]],


         [[[  426.06328571, -1009.57428571, -1093.49714286],
           [  425.2992    , -1012.222     , -1079.954     ],
           [  421.4055    , -1010.925     , -1062.855     ],
           ...,
           [  433.582     , -1013.82      ,  1072.13      ],
           [  424.001     , -1007.495     ,  1076.61      ],
           [  425.62233333, -1009.78666667,  1090.51666667]],

          [[  433.03085714, -1021.29      , -1102.34857143],
           [  430.398     , -1021.7375    , -1090.36      ],
           [  432.7868    , -1021.378     , -1075.19      ],
           ...,
           [  433.258     , -1015.1       ,  1072.31      ],
           [  430.5965    , -1024.97      ,  1093.835     ],
           [  430.8512    , -1022.784     ,  1105.85      ]],

          [[  438.8254    , -1033.92      , -1118.79      ],
           [  435.79433333, -1030.22      , -1096.52333333],
           [  438.14575   , -1032.505     , -1088.535     ],
           ...,
           [  438.93266667, -1028.46333333,  1087.82      ],
           [  438.89366667, -1028.44666667,  1094.32333333],
           [  436.742     , -1025.9       ,  1112.36      ]],

          ...,

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [  614.742     , -1291.08      ,  1429.17      ]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [  625.518     , -1308.44      ,  1410.49      ],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]]]],



        [[[[  457.784     ,  -996.0533    , -1092.753     ],
           [  455.6032    ,  -993.8222    , -1077.288     ],
           [  458.533     ,  -989.10875   , -1059.5575    ],
           ...,
           [  453.43666667,  -993.44333333,  1062.62      ],
           [  460.08533333,  -993.74133333,  1075.09333333],
           [  461.367     ,  -993.338     ,  1092.93      ]],

          [[  463.97133333, -1004.82033333, -1101.85333333],
           [  463.01657143, -1004.80285714, -1087.29428571],
           [  463.930625  , -1006.745     , -1077.905     ],
           ...,
           [           nan,            nan,            nan],
           [  463.9005    , -1008.57      ,  1093.95      ],
           [  459.636     , -1003.695     ,  1104.685     ]],

          [[  470.0645    , -1013.85125   , -1115.03875   ],
           [  472.3935    , -1012.5575    , -1098.385     ],
           [  473.5095    , -1013.9125    , -1090.59      ],
           ...,
           [  467.245     , -1018.28      ,  1092.59      ],
           [  472.255     , -1009.77      ,  1101.78      ],
           [           nan,            nan,            nan]],

          ...,

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [  638.671     , -1267.34      ,  1375.03      ],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]]],


         [[[  449.34276923, -1001.14792308, -1091.95384615],
           [  446.647     , -1001.3748    , -1076.626     ],
           [  446.71916667,  -998.68733333, -1061.495     ],
           ...,
           [  447.14466667, -1000.31466667,  1064.98      ],
           [  445.526     ,  -998.861     ,  1071.7       ],
           [           nan,            nan,            nan]],

          [[  453.43177778, -1011.95444444, -1103.50444444],
           [  457.9475    , -1015.685     , -1094.34      ],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [  449.649     , -1011.01      ,  1087.42      ],
           [           nan,            nan,            nan]],

          [[  457.5974    , -1019.05      , -1111.86      ],
           [  460.837     , -1018.784     , -1094.904     ],
           [  461.10116667, -1023.45833333, -1089.4       ],
           ...,
           [  459.727     , -1021.74      ,  1092.53      ],
           [  457.226     , -1021.65      ,  1093.03      ],
           [  461.98      , -1014.36      ,  1108.74      ]],

          ...,

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [  642.31      , -1276.34      ,  1399.04      ],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [  642.616     , -1276.15      ,  1399.11      ],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]]]],



        [[[[  480.357875  ,  -983.76125   , -1090.33625   ],
           [  478.55233333,  -981.52833333, -1078.19333333],
           [  477.14375   ,  -984.979125  , -1062.25125   ],
           ...,
           [  481.329     ,  -985.78033333,  1063.90333333],
           [           nan,            nan,            nan],
           [  484.318     ,  -989.022     ,  1102.06      ]],

          [[  483.3154    ,  -996.2274    , -1104.21      ],
           [  485.18933333, -1000.49666667, -1094.62      ],
           [  483.2855    ,  -990.2045    , -1065.21      ],
           ...,
           [  485.522     ,  -988.513     ,  1065.13      ],
           [  484.347     , -1000.        ,  1087.2       ],
           [  484.8425    ,  -992.994     ,  1105.165     ]],

          [[           nan,            nan,            nan],
           [  487.72925   , -1005.525     , -1096.52      ],
           [  494.8925    , -1007.45      , -1094.905     ],
           ...,
           [  488.082     , -1005.51      ,  1083.64      ],
           [           nan,            nan,            nan],
           [  497.866     , -1002.77      ,  1112.07      ]],

          ...,

          [[           nan,            nan,            nan],
           [  675.619     , -1248.62      , -1400.12      ],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [  677.902     , -1252.73      ,  1422.9       ]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]]],


         [[[  467.967625  ,  -990.0165    , -1087.885     ],
           [  468.2928    ,  -993.0032    , -1077.368     ],
           [  469.88085714,  -990.95185714, -1064.21428571],
           ...,
           [  468.667     ,  -990.9       ,  1062.395     ],
           [  472.208     ,  -989.2245    ,  1083.35      ],
           [  468.981     ,  -993.145     ,  1086.03      ]],

          [[  475.0288    , -1000.644     , -1100.732     ],
           [  475.695     , -1003.7105    , -1088.615     ],
           [  472.9926    , -1001.0144    , -1072.306     ],
           ...,
           [  484.096     , -1002.04      ,  1087.08      ],
           [  478.1625    , -1003.71      ,  1090.605     ],
           [  476.0655    , -1007.165     ,  1109.105     ]],

          [[  481.2735    , -1010.69666667, -1112.79      ],
           [  481.843     , -1011.34272727, -1100.38181818],
           [  482.47633333, -1011.78666667, -1089.35666667],
           ...,
           [           nan,            nan,            nan],
           [  487.934     , -1008.82      ,  1103.83      ],
           [  476.199     , -1008.83      ,  1106.82      ]],

          ...,

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [  654.132     , -1259.37      ,  1397.2       ],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]]]],



        [[[[  500.28842857,  -973.01071429, -1090.59142857],
           [  497.068     ,  -973.29566667, -1074.33666667],
           [  499.9622    ,  -971.9763    , -1061.104     ],
           ...,
           [  502.5822    ,  -973.1296    ,  1068.654     ],
           [  503.72333333,  -973.61566667,  1075.90333333],
           [  502.449     ,  -972.7848    ,  1092.212     ]],

          [[  503.5905    ,  -985.01575   , -1105.5375    ],
           [  506.0845    ,  -983.12      , -1088.205     ],
           [  502.352     ,  -981.092     , -1071.01      ],
           ...,
           [  509.2155    ,  -979.7985    ,  1072.16      ],
           [  511.537     ,  -981.211     ,  1095.72      ],
           [  513.4045    ,  -983.259     ,  1102.035     ]],

          [[  514.426     ,  -993.30583333, -1113.81333333],
           [  511.4795    ,  -997.4175    , -1103.5       ],
           [  515.848     ,  -998.693     , -1086.34      ],
           ...,
           [  513.445     ,  -999.466     ,  1091.81      ],
           [  511.893     ,  -998.683     ,  1108.64      ],
           [  512.069     ,  -998.051     ,  1122.56      ]],

          ...,

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]]],


         [[[  491.53925   ,  -981.83458333, -1093.90416667],
           [  488.5928    ,  -982.9854    , -1079.294     ],
           [  487.55283333,  -980.99683333, -1057.38666667],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [  490.1955    ,  -982.3605    ,  1095.845     ]],

          [[  497.840125  ,  -989.195875  , -1100.8525    ],
           [  498.351     ,  -991.22066667, -1091.685     ],
           [  499.58733333,  -993.91466667, -1077.54      ],
           ...,
           [  500.627     ,  -986.066     ,  1072.88      ],
           [           nan,            nan,            nan],
           [  495.0325    ,  -993.023     ,  1102.465     ]],

          [[  504.507     , -1002.6024    , -1119.758     ],
           [  503.52266667, -1000.61966667, -1098.70666667],
           [  505.11375   ,  -999.18275   , -1083.2       ],
           ...,
           [  502.668     , -1003.87      ,  1086.645     ],
           [  506.05366667, -1001.98933333,  1099.70333333],
           [  502.631     , -1001.1515    ,  1114.1       ]],

          ...,

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[  699.449     , -1258.66      , -1442.5       ],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[  703.876     , -1258.43      , -1444.4       ],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]]]],



        [[[[  522.63733333,  -961.88433333, -1090.32333333],
           [  522.35066667,  -961.62033333, -1076.27      ],
           [  522.263     ,  -960.35933333, -1060.46833333],
           ...,
           [           nan,            nan,            nan],
           [  518.168     ,  -960.0535    ,  1071.67      ],
           [  521.622     ,  -964.086     ,  1095.975     ]],

          [[  528.0936    ,  -972.8188    , -1100.744     ],
           [  528.16      ,  -971.29025   , -1089.6325    ],
           [  527.91571429,  -972.94328571, -1072.22428571],
           ...,
           [           nan,            nan,            nan],
           [  523.7085    ,  -974.756     ,  1085.615     ],
           [  527.89675   ,  -978.09025   ,  1108.5175    ]],

          [[  535.2805    ,  -982.7095    , -1115.42875   ],
           [  535.965     ,  -983.2282    , -1102.58      ],
           [  533.803     ,  -982.927     , -1082.968     ],
           ...,
           [  541.892     ,  -981.275     ,  1083.77      ],
           [  538.904     ,  -986.248     ,  1111.65      ],
           [  532.0212    ,  -980.8184    ,  1111.516     ]],

          ...,

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [  737.905     , -1248.44      ,  1436.23      ],
           [           nan,            nan,            nan]]],


         [[[  511.18566667,  -970.447     , -1089.34333333],
           [  512.6568    ,  -968.1954    , -1075.026     ],
           [  513.2108    ,  -966.9882    , -1063.364     ],
           ...,
           [  510.928     ,  -970.462     ,  1064.14333333],
           [  512.914     ,  -977.579     ,  1081.13      ],
           [  513.27166667,  -969.54      ,  1095.43666667]],

          [[  525.128     ,  -979.685     , -1109.26      ],
           [  525.06333333,  -978.29566667, -1089.65      ],
           [  522.55866667,  -979.917     , -1078.53333333],
           ...,
           [  514.283     ,  -980.1955    ,  1073.755     ],
           [  514.873     ,  -980.598     ,  1086.        ],
           [  523.069     ,  -977.327     ,  1107.65      ]],

          [[  529.50166667,  -989.015     , -1114.15333333],
           [  527.4645    ,  -991.0865    , -1101.4675    ],
           [  526.946     ,  -993.976     , -1092.81      ],
           ...,
           [           nan,            nan,            nan],
           [  529.314     ,  -984.451     ,  1100.72      ],
           [  526.708     ,  -996.037     ,  1113.54      ]],

          ...,

          [[  719.8905    , -1226.36      , -1420.205     ],
           [           nan,            nan,            nan],
           [  712.711     , -1235.04      , -1377.67      ],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [  735.856     , -1247.43      ,  1435.59      ]]]],



        [[[[  542.029     ,  -951.3346    , -1094.772     ],
           [  540.7905    ,  -950.202125  , -1075.12875   ],
           [  543.51261538,  -949.19030769, -1062.73846154],
           ...,
           [  546.37      ,  -949.768     ,  1064.46      ],
           [           nan,            nan,            nan],
           [  542.576     ,  -945.908     ,  1088.18      ]],

          [[  547.3626    ,  -963.3666    , -1105.54      ],
           [  547.25633333,  -962.57783333, -1087.13333333],
           [  547.55666667,  -965.75566667, -1080.88      ],
           ...,
           [  549.58633333,  -963.858     ,  1079.56      ],
           [  545.889     ,  -964.64      ,  1084.38      ],
           [  548.4695    ,  -960.387     ,  1102.78      ]],

          [[  557.474     ,  -969.78366667, -1114.29833333],
           [  555.466     ,  -965.6665    , -1099.785     ],
           [  555.106     ,  -974.258     , -1091.45      ],
           ...,
           [  559.95325   ,  -972.64025   ,  1088.285     ],
           [  559.835     ,  -966.364     ,  1096.97      ],
           [  562.511     ,  -970.89      ,  1113.21      ]],

          ...,

          [[  746.8545    , -1204.44      , -1412.57      ],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [  760.937     , -1227.1       , -1396.23      ],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]]],


         [[[  531.313     ,  -956.38975   , -1089.17      ],
           [  533.4215    ,  -953.57925   , -1073.2925    ],
           [  530.5145    ,  -958.12275   , -1061.7575    ],
           ...,
           [  528.432     ,  -957.681     ,  1058.52      ],
           [           nan,            nan,            nan],
           [  531.055     ,  -963.04      ,  1094.09333333]],

          [[           nan,            nan,            nan],
           [  542.3512    ,  -964.207     , -1090.736     ],
           [  541.7365    ,  -966.25      , -1078.21      ],
           ...,
           [           nan,            nan,            nan],
           [  543.5225    ,  -963.978     ,  1090.315     ],
           [  538.6965    ,  -964.471     ,  1094.68      ]],

          [[  547.4695    ,  -977.21683333, -1114.465     ],
           [  548.0585    ,  -979.87325   , -1104.4125    ],
           [  551.46466667,  -980.02366667, -1097.29666667],
           ...,
           [           nan,            nan,            nan],
           [  551.346     ,  -973.411     ,  1105.57      ],
           [  551.53433333,  -974.734     ,  1114.30666667]],

          ...,

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [  749.519     , -1215.74      , -1381.89      ],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [  754.327     , -1220.94      ,  1409.76      ],
           [           nan,            nan,            nan]],

          [[           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           ...,
           [           nan,            nan,            nan],
           [           nan,            nan,            nan],
           [           nan,            nan,            nan]]]]]],
      shape=(14, 6, 2, 32, 256, 3))</pre></span></li><li class='sc-var-item'><div class='sc-var-name'><span>sample_position</span></div><div class='sc-var-dims'>()</div><div class='sc-var-dtype'>vector3</div><div class='sc-var-unit'>mm</div><div class='sc-value-preview sc-preview'><span><div>[0. 0. 0.]</div></span></div><input id='attrs-533f5a14-d0e9-45f4-9764-8af3b99b90ee' class='sc-var-attrs-in' type='checkbox' disabled><label for='attrs-533f5a14-d0e9-45f4-9764-8af3b99b90ee' class='sc-hide-icon' title='Show/Hide attributes'><svg class='icon sc-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fae48681-c097-49bb-95eb-b329855a5eb7' class='sc-var-data-in' type='checkbox'><label for='data-fae48681-c097-49bb-95eb-b329855a5eb7' title='Show/Hide data repr'><svg class='icon sc-icon-database'><use xlink:href='#icon-database'></use></svg></label><pre class='sc-var-data'>Values:<br>array([0., 0., 0.])</pre></span></li><li class='sc-var-item'><div class='sc-var-name'><span class='sc-aligned'>segment</span></div><div class='sc-var-dims'>(segment)</div><div class='sc-var-dtype'>int64</div><div class='sc-var-unit'></div><div class='sc-value-preview sc-preview'><span><div>1, 2, ..., 5, 6</div></span></div><input id='attrs-bdce30c4-58c8-4e8f-b73e-3324d2bd2809' class='sc-var-attrs-in' type='checkbox' disabled><label for='attrs-bdce30c4-58c8-4e8f-b73e-3324d2bd2809' class='sc-hide-icon' title='Show/Hide attributes'><svg class='icon sc-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-969fefbd-3832-40d9-9bc6-7db6b089ecc2' class='sc-var-data-in' type='checkbox'><label for='data-969fefbd-3832-40d9-9bc6-7db6b089ecc2' title='Show/Hide data repr'><svg class='icon sc-icon-database'><use xlink:href='#icon-database'></use></svg></label><pre class='sc-var-data'>Values:<br>array([1, 2, 3, 4, 5, 6])</pre></span></li><li class='sc-var-item'><div class='sc-var-name'><span>source_position</span></div><div class='sc-var-dims'>()</div><div class='sc-var-dtype'>vector3</div><div class='sc-var-unit'>mm</div><div class='sc-value-preview sc-preview'><span><div>[-3.478e+00  0.000e+00 -7.655e+04]</div></span></div><input id='attrs-658fc1b6-2c7a-4a73-9737-cb7b8cdcd69b' class='sc-var-attrs-in' type='checkbox' disabled><label for='attrs-658fc1b6-2c7a-4a73-9737-cb7b8cdcd69b' class='sc-hide-icon' title='Show/Hide attributes'><svg class='icon sc-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1ad1e540-35e5-43e2-840b-07447b7d598f' class='sc-var-data-in' type='checkbox'><label for='data-1ad1e540-35e5-43e2-840b-07447b7d598f' title='Show/Hide data repr'><svg class='icon sc-icon-database'><use xlink:href='#icon-database'></use></svg></label><pre class='sc-var-data'>Values:<br>array([-3.478e+00,  0.000e+00, -7.655e+04])</pre></span></li><li class='sc-var-item'><div class='sc-var-name'><span class='sc-aligned'>strip</span></div><div class='sc-var-dims'>(strip)</div><div class='sc-var-dtype'>int64</div><div class='sc-var-unit'></div><div class='sc-value-preview sc-preview'><span><div>1, 2, ..., 255, 256</div></span></div><input id='attrs-63a3459c-5bbb-49c1-863a-e6bc8aeaa6bf' class='sc-var-attrs-in' type='checkbox' disabled><label for='attrs-63a3459c-5bbb-49c1-863a-e6bc8aeaa6bf' class='sc-hide-icon' title='Show/Hide attributes'><svg class='icon sc-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-81124e00-bfa1-4901-908b-08e100e4b953' class='sc-var-data-in' type='checkbox'><label for='data-81124e00-bfa1-4901-908b-08e100e4b953' title='Show/Hide data repr'><svg class='icon sc-icon-database'><use xlink:href='#icon-database'></use></svg></label><pre class='sc-var-data'>Values:<br>array([  1,   2,   3,   4,   5,   6,   7,   8,   9,  10,  11,  12,  13,
        14,  15,  16,  17,  18,  19,  20,  21,  22,  23,  24,  25,  26,
        27,  28,  29,  30,  31,  32,  33,  34,  35,  36,  37,  38,  39,
        40,  41,  42,  43,  44,  45,  46,  47,  48,  49,  50,  51,  52,
        53,  54,  55,  56,  57,  58,  59,  60,  61,  62,  63,  64,  65,
        66,  67,  68,  69,  70,  71,  72,  73,  74,  75,  76,  77,  78,
        79,  80,  81,  82,  83,  84,  85,  86,  87,  88,  89,  90,  91,
        92,  93,  94,  95,  96,  97,  98,  99, 100, 101, 102, 103, 104,
       105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117,
       118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130,
       131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143,
       144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156,
       157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169,
       170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182,
       183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195,
       196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208,
       209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221,
       222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234,
       235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247,
       248, 249, 250, 251, 252, 253, 254, 255, 256])</pre></span></li><li class='sc-var-item'><div class='sc-var-name'><span class='sc-aligned'>two_theta</span></div><div class='sc-var-dims'>(module, segment, counter, wire, strip)</div><div class='sc-var-dtype'>float64</div><div class='sc-var-unit'>rad</div><div class='sc-value-preview sc-preview'><span><div>2.354, 2.349, ..., nan, nan</div></span></div><input id='attrs-1d24f1b5-ddb7-4734-974f-64a79d85724a' class='sc-var-attrs-in' type='checkbox' disabled><label for='attrs-1d24f1b5-ddb7-4734-974f-64a79d85724a' class='sc-hide-icon' title='Show/Hide attributes'><svg class='icon sc-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b858e965-0d4b-4559-a6bc-66e51aa16d4d' class='sc-var-data-in' type='checkbox'><label for='data-b858e965-0d4b-4559-a6bc-66e51aa16d4d' title='Show/Hide data repr'><svg class='icon sc-icon-database'><use xlink:href='#icon-database'></use></svg></label><pre class='sc-var-data'>Values:<br>array([[[[[2.354111  , 2.3489499 , 2.34323632, ..., 0.8005903 ,
           0.79650678, 0.78490048],
          [2.35443442, 2.34841574, 2.34306328, ..., 0.80223663,
           0.7919694 , 0.78764711],
          [2.35451844, 2.34773346, 2.34282446, ..., 0.79942735,
           0.79519205, 0.787624  ],
          ...,
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [2.3553089 ,        nan,        nan, ...,        nan,
                  nan,        nan],
          [2.35369704,        nan,        nan, ...,        nan,
                  nan,        nan]],

         [[2.3549424 , 2.3447032 , 2.34327696, ..., 0.80004687,
           0.7952553 , 0.78769506],
          [2.35347946, 2.34675351, 2.33991123, ..., 0.80103612,
                  nan, 0.78786428],
          [2.3539789 , 2.34734798, 2.33941315, ..., 0.79945345,
           0.79535589, 0.78804926],
          ...,
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan]]],


        [[[2.35525507, 2.3493847 , 2.3428459 , ..., 0.80121263,
           0.79050135, 0.78802727],
          [2.3550206 , 2.34649148, 2.34076652, ...,        nan,
           0.79340163, 0.78674125],
          [2.35399627, 2.3491432 , 2.34105316, ..., 0.79827558,
           0.79618989, 0.7867269 ],
          ...,
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [2.35136064, 2.3510964 ,        nan, ..., 0.7999567 ,
                  nan,        nan]],

         [[2.35340676, 2.34608845, 2.3413664 , ..., 0.80009777,
           0.79488372, 0.7896071 ],
          [2.3557744 ,        nan, 2.33754806, ..., 0.79938593,
                  nan, 0.78766021],
          [2.35250334, 2.34729054, 2.34082036, ..., 0.80094675,
           0.79180328, 0.79064278],
          ...,
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan, 2.34170285, ...,        nan,
                  nan,        nan]]],


        [[[2.35488578, 2.3474244 , 2.34270727, ..., 0.79714709,
           0.79385686, 0.78862014],
          [2.35619633, 2.34681113, 2.3410125 , ..., 0.79939875,
           0.79355018, 0.7898146 ],
          [2.35494624, 2.34852974, 2.34156624, ..., 0.79827761,
           0.79289862, 0.79041796],
          ...,
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan, 2.34992104,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan]],

         [[2.35390392, 2.34614547, 2.34130487, ..., 0.79761993,
           0.79748985, 0.78841609],
          [2.3551146 , 2.34577233, 2.34235489, ..., 0.80308835,
           0.79426809, 0.79167962],
          [2.35235511, 2.3465774 , 2.34179309, ..., 0.80088237,
           0.79707343,        nan],
          ...,
          [2.35603144,        nan,        nan, ...,        nan,
                  nan, 0.78654338],
          [       nan, 2.3449593 , 2.34358087, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan]]],


        [[[2.35405848, 2.3480938 , 2.34089997, ..., 0.7997372 ,
           0.79137021, 0.78744271],
          [2.35519518, 2.346931  , 2.34172704, ..., 0.79829084,
           0.79496437, 0.78582327],
          [2.35540853, 2.3481764 , 2.34241766, ..., 0.79880196,
           0.79279072, 0.78592129],
          ...,
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ..., 0.7998828 ,
                  nan,        nan]],

         [[2.35340577, 2.34867995, 2.34047604, ..., 0.80185608,
                  nan, 0.78621215],
          [2.3530232 , 2.34692453, 2.34189294, ...,        nan,
                  nan, 0.78727602],
          [2.34990641, 2.34795073, 2.34130499, ..., 0.80158091,
           0.79616023,        nan],
          ...,
          [2.35641188,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan, 2.34293698, ...,        nan,
                  nan,        nan]]],


        [[[2.35558298, 2.34779565, 2.34257065, ..., 0.80054895,
           0.79494548, 0.78507541],
          [2.35667186, 2.34739169, 2.34308432, ..., 0.80014847,
           0.7937321 , 0.78494023],
          [2.35543893, 2.34691662, 2.34102984, ..., 0.79985511,
                  nan, 0.78433898],
          ...,
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan]],

         [[2.35372571, 2.34636409, 2.34099169, ..., 0.80038163,
           0.79316885, 0.78885809],
          [2.35257425, 2.34773141, 2.34085778, ..., 0.80280937,
           0.7943127 , 0.78807535],
          [2.35266156, 2.34696873, 2.33932901, ..., 0.80245607,
                  nan, 0.7863866 ],
          ...,
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan]]],


        [[[2.35355601, 2.34847281, 2.34299991, ..., 0.79690332,
           0.79242734, 0.78528095],
          [2.35572973, 2.34706117, 2.34174426, ...,        nan,
           0.79285919, 0.78598767],
          [2.35539802, 2.34786222, 2.34187765, ..., 0.79945591,
           0.79297187, 0.78644398],
          ...,
          [2.35433383, 2.34840997, 2.3425388 , ..., 0.8017343 ,
           0.79164503, 0.7859902 ],
          [2.35490797, 2.3462965 , 2.34524939, ...,        nan,
                  nan,        nan],
          [2.35421562, 2.34992515, 2.34506577, ...,        nan,
                  nan, 0.78626354]],

         [[2.35284437, 2.34657951, 2.34066786, ...,        nan,
           0.79268755, 0.78878386],
          [2.35580739, 2.34691811, 2.33984445, ..., 0.80142315,
           0.79242207, 0.7913927 ],
          [2.35446303, 2.34580547, 2.34270634, ..., 0.80063516,
           0.79372213, 0.78778968],
          ...,
          [       nan,        nan,        nan, ..., 0.79689752,
                  nan,        nan],
          [2.35438763, 2.34530443, 2.34447022, ...,        nan,
                  nan, 0.7850602 ],
          [2.35687535,        nan,        nan, ...,        nan,
                  nan, 0.78684051]]]],



       [[[[2.3544614 , 2.34886799, 2.34262386, ..., 0.80107444,
           0.79341145,        nan],
          [2.35465318, 2.34765835, 2.34153975, ...,        nan,
           0.79230691, 0.7870582 ],
          [2.35450698, 2.34505691, 2.34067539, ...,        nan,
                  nan, 0.78470321],
          ...,
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [2.35404928, 2.3508328 ,        nan, ...,        nan,
                  nan,        nan]],

         [[2.35376374, 2.34734283, 2.3417185 , ..., 0.80398012,
                  nan, 0.78942606],
          [2.3538542 , 2.34631071, 2.34019852, ..., 0.80122774,
           0.79151732, 0.78966392],
          [2.35344387, 2.34878628, 2.34003773, ...,        nan,
                  nan, 0.78774317],
          ...,
          [2.357283  ,        nan,        nan, ...,        nan,
                  nan,        nan],
          [2.35656382,        nan, 2.34301241, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan, 0.7881274 ]]],


        [[[2.35612311, 2.34883714, 2.34087836, ..., 0.79990446,
           0.79382711, 0.7872378 ],
          [2.35405928, 2.34804244, 2.34226906, ..., 0.80097452,
           0.79441479, 0.78645464],
          [2.35450336, 2.34770027, 2.34308369, ..., 0.7981319 ,
           0.79406975, 0.78567767],
          ...,
          [2.35447979,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan]],

         [[2.35406226, 2.34729624, 2.34131662, ..., 0.80176624,
           0.79318313, 0.78800713],
          [2.35395514, 2.34746196, 2.34000855, ..., 0.80262427,
                  nan, 0.78804176],
          [2.35342971, 2.3490508 , 2.3396376 , ...,        nan,
                  nan, 0.78782975],
          ...,
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan]]],


        [[[2.3546345 , 2.34774599, 2.34118115, ..., 0.80009744,
           0.7945277 , 0.7856187 ],
          [2.35489733, 2.34889165, 2.34108278, ...,        nan,
           0.79263491, 0.78786653],
          [2.35378296, 2.34660734, 2.34331295, ...,        nan,
                  nan, 0.78573438],
          ...,
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan]],

         [[2.35560388, 2.3468323 , 2.33964144, ..., 0.79981708,
           0.79528762, 0.78624794],
          [2.35493396, 2.34575775, 2.33949709, ..., 0.79813229,
           0.79361136, 0.78572626],
          [2.35405414, 2.34667802, 2.33962015, ..., 0.80323547,
           0.79326923, 0.78803099],
          ...,
          [       nan,        nan, 2.34325138, ...,        nan,
                  nan, 0.78523226],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [2.35418066,        nan,        nan, ...,        nan,
                  nan,        nan]]],


        [[[2.35486116, 2.34893228, 2.34097663, ..., 0.80033202,
           0.79573649, 0.78514115],
          [2.35457355, 2.34672653, 2.34269436, ..., 0.80037008,
                  nan, 0.78641678],
          [2.35345777, 2.34833286, 2.34197453, ...,        nan,
           0.7952984 , 0.7879157 ],
          ...,
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [2.35793501, 2.34868072, 2.34530833, ...,        nan,
                  nan,        nan],
          [2.35202183, 2.35173531,        nan, ...,        nan,
                  nan,        nan]],

         [[2.35436808, 2.34523649, 2.34145762, ..., 0.80138404,
                  nan, 0.78648071],
          [2.35342575, 2.34730742, 2.34248636, ..., 0.79819642,
           0.79626686, 0.78629403],
          [2.35359776, 2.34629979, 2.34260691, ..., 0.80126134,
           0.79237395, 0.78898163],
          ...,
          [2.35452224,        nan, 2.33931154, ...,        nan,
                  nan,        nan],
          [2.35664909,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan]]],


        [[[2.35494835, 2.34887714, 2.341231  , ..., 0.79927555,
           0.79551746, 0.78645169],
          [2.35488598, 2.34813928, 2.34140976, ..., 0.80224975,
           0.79221754, 0.78952841],
          [2.35423871, 2.34817931, 2.34066855, ...,        nan,
           0.79433711, 0.78737914],
          ...,
          [       nan,        nan, 2.33992388, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan]],

         [[2.35489547, 2.34696361, 2.34241928, ..., 0.79902919,
           0.79762388,        nan],
          [2.3551356 , 2.3463628 , 2.34041086, ..., 0.80193799,
                  nan, 0.78832762],
          [2.35379717, 2.34879431,        nan, ..., 0.8005998 ,
                  nan, 0.78774324],
          ...,
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan]]],


        [[[2.35395823, 2.34719215, 2.34246593, ...,        nan,
           0.79460231, 0.78620111],
          [2.35497932, 2.34735865, 2.34141924, ..., 0.80067497,
                  nan, 0.78463693],
          [2.35509386, 2.3477436 , 2.34080574, ...,        nan,
           0.79488054, 0.78877273],
          ...,
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan, 2.34958171,        nan, ...,        nan,
                  nan,        nan]],

         [[2.35417775, 2.34653418, 2.34094109, ...,        nan,
           0.79209852, 0.78578541],
          [2.35467736, 2.34782681, 2.34270999, ..., 0.80181692,
           0.79417553, 0.78812045],
          [2.35363168, 2.34587838, 2.34247888, ..., 0.80170947,
                  nan, 0.78704699],
          ...,
          [2.3567218 ,        nan,        nan, ...,        nan,
                  nan,        nan],
          [2.35603183,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan]]]],



       [[[[2.35597201, 2.34699485, 2.34310475, ..., 0.7983675 ,
           0.7935432 , 0.78808547],
          [2.35421624, 2.34776795, 2.34034614, ..., 0.80145213,
                  nan, 0.78465748],
          [2.35410112, 2.3466948 , 2.34208064, ..., 0.79642857,
           0.79607559, 0.78623059],
          ...,
          [       nan,        nan,        nan, ...,        nan,
                  nan, 0.78372002],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
           0.79138291, 0.78958829]],

         [[2.35352824, 2.34768747, 2.34244445, ..., 0.80090843,
           0.79482688, 0.78853243],
          [2.35237664, 2.34804039, 2.34278857, ..., 0.80291306,
                  nan, 0.78827241],
          [2.35201216, 2.3471022 , 2.34104915, ...,        nan,
           0.79478471, 0.78638092],
          ...,
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan]]],


        [[[2.35324229, 2.35008264, 2.34145009, ..., 0.80012294,
           0.79348854, 0.78644941],
          [2.35441901, 2.34746651, 2.34225422, ..., 0.79895619,
           0.79379307, 0.78780589],
          [2.35463069, 2.34953158, 2.34202369, ..., 0.79707858,
           0.79564672, 0.78538904],
          ...,
          [       nan, 2.34802698,        nan, ...,        nan,
                  nan,        nan],
          [2.35707056, 2.34715987,        nan, ...,        nan,
                  nan,        nan],
          [2.35548519,        nan,        nan, ...,        nan,
                  nan,        nan]],

         [[2.35360538, 2.34628926, 2.33974291, ..., 0.80005292,
           0.79430566, 0.78871643],
          [2.35370499, 2.34716472, 2.34047397, ..., 0.80079394,
           0.79133586, 0.78714682],
          [2.35453553, 2.3474939 , 2.34004672, ..., 0.80169014,
           0.7939692 , 0.7855696 ],
          ...,
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan, 0.7851344 ],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan]]],


        [[[2.35479514, 2.34648307, 2.3436398 , ..., 0.80111412,
           0.79071943, 0.79025467],
          [2.35473782, 2.34723075, 2.34226444, ..., 0.80291251,
                  nan, 0.78574844],
          [2.3563427 , 2.34756893, 2.34069165, ..., 0.79981781,
                  nan, 0.78557042],
          ...,
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [2.35734079,        nan,        nan, ...,        nan,
                  nan, 0.78471951]],

         [[2.35576034, 2.34688743, 2.34129606, ..., 0.80080215,
           0.79178519, 0.78955413],
          [2.35495804, 2.34547681, 2.34222191, ...,        nan,
           0.79332723, 0.78877221],
          [2.35631558, 2.34718694, 2.34018092, ..., 0.80177652,
                  nan, 0.78599038],
          ...,
          [       nan,        nan,        nan, ..., 0.79714416,
           0.79628849,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [2.35647056,        nan,        nan, ...,        nan,
                  nan,        nan]]],


        [[[2.35342393, 2.34821221, 2.34370606, ..., 0.79699943,
           0.79319692, 0.78694049],
          [2.35517902, 2.34795661, 2.3431147 , ...,        nan,
                  nan, 0.78562308],
          [2.35500083, 2.34914414, 2.34086496, ...,        nan,
                  nan, 0.78626927],
          ...,
          [       nan, 2.3468168 , 2.3453786 , ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan]],

         [[2.35310669, 2.34825902, 2.34055493, ..., 0.7984411 ,
           0.79593387, 0.78697045],
          [2.35402357, 2.34967721, 2.34168117, ..., 0.80298606,
                  nan, 0.78730202],
          [2.35317694, 2.34587398, 2.3424467 , ..., 0.80061363,
                  nan, 0.79112208],
          ...,
          [       nan,        nan,        nan, ...,        nan,
                  nan, 0.78517519],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan]]],


        [[[2.35375846, 2.34766013, 2.34249048, ..., 0.79896334,
           0.79513685, 0.78652968],
          [2.35317785, 2.3489932 , 2.34111524, ..., 0.79695989,
           0.79233526, 0.78697455],
          [2.35560516, 2.34674973, 2.34007723, ..., 0.79820848,
                  nan, 0.78735129],
          ...,
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan, 2.34164729, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan]],

         [[2.35298561, 2.34772226, 2.34081322, ..., 0.80053113,
           0.79511611, 0.78949576],
          [2.35134355, 2.34856536, 2.34093949, ..., 0.79880994,
           0.79582949, 0.78700026],
          [2.35252305, 2.34787682, 2.34052014, ..., 0.80311895,
           0.79627983, 0.78779114],
          ...,
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [2.35669927, 2.34501429, 2.34394351, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan, 0.7848468 ]]],


        [[[2.35508695, 2.34783997, 2.34163235, ..., 0.79657179,
                  nan, 0.78518573],
          [2.35249688, 2.34843136, 2.34200449, ...,        nan,
           0.7932795 , 0.79087008],
          [2.35432679, 2.34905282, 2.34101066, ...,        nan,
           0.79151619, 0.78971393],
          ...,
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [2.35797032,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan]],

         [[2.35268153, 2.34767606, 2.3398254 , ...,        nan,
           0.79598164, 0.78642611],
          [2.35495417, 2.34635365, 2.34004151, ...,        nan,
           0.79662702, 0.78578706],
          [2.35399831, 2.34786185,        nan, ...,        nan,
           0.79637589, 0.78829463],
          ...,
          [       nan,        nan,        nan, ...,        nan,
                  nan, 0.78509052],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan]]]],



       ...,



       [[[[2.35457504, 2.34947868, 2.34123046, ..., 0.79692125,
           0.79485368, 0.78568186],
          [2.35425908, 2.34911239, 2.344575  , ...,        nan,
           0.79064216, 0.7869416 ],
          [2.35522894, 2.34734449, 2.3427373 , ..., 0.79888204,
           0.79299021, 0.78684084],
          ...,
          [       nan,        nan, 2.34394022, ...,        nan,
                  nan, 0.78420285],
          [2.35739196,        nan, 2.33940987, ...,        nan,
                  nan,        nan],
          [2.35371569,        nan, 2.34063685, ...,        nan,
                  nan,        nan]],

         [[2.35450893, 2.34790716, 2.34111446, ..., 0.80141922,
                  nan, 0.78742848],
          [2.35585311, 2.34699768, 2.3393796 , ..., 0.80076332,
           0.79599585,        nan],
          [2.3515635 , 2.34734511, 2.34121542, ..., 0.79721015,
           0.79676806, 0.78724801],
          ...,
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [2.3561904 ,        nan, 2.34081152, ...,        nan,
                  nan,        nan]]],


        [[[2.35534659, 2.34686987, 2.34124846, ..., 0.79896619,
           0.79507362, 0.78648172],
          [2.35411397, 2.34909123, 2.34219797, ..., 0.79986197,
           0.79633513, 0.78701414],
          [2.35407724, 2.34828207, 2.34260813, ...,        nan,
           0.79184334, 0.78920814],
          ...,
          [       nan,        nan,        nan, ...,        nan,
           0.79224065,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan]],

         [[2.35235091, 2.34667372, 2.33998121, ..., 0.79951776,
           0.7940407 , 0.78904102],
          [2.35422072, 2.34705264, 2.33968589, ...,        nan,
           0.79343835, 0.78824448],
          [2.35435413, 2.34830445, 2.33767322, ..., 0.80007065,
           0.79615596, 0.78786998],
          ...,
          [2.35658607,        nan, 2.34316486, ...,        nan,
                  nan,        nan],
          [       nan,        nan, 2.34334845, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan]]],


        [[[2.35475709, 2.34849498, 2.34170979, ..., 0.79815575,
           0.79564217,        nan],
          [2.35529288, 2.34662011, 2.34157254, ..., 0.79872101,
           0.79512153, 0.78504439],
          [2.35503776, 2.3473043 , 2.34376638, ..., 0.80170221,
           0.79410223, 0.78668313],
          ...,
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan]],

         [[2.35483872, 2.34683383, 2.34106816, ..., 0.79812782,
           0.79574601, 0.78637206],
          [2.35496645, 2.34432268, 2.34036242, ..., 0.80308814,
                  nan,        nan],
          [2.35432064, 2.34995541, 2.34091676, ..., 0.8036874 ,
           0.79269401,        nan],
          ...,
          [       nan, 2.34974958,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ..., 0.79987406,
                  nan,        nan]]],


        [[[2.35448713, 2.34819154, 2.34267056, ..., 0.79869982,
           0.7936924 ,        nan],
          [2.35615757, 2.344556  , 2.34215509, ..., 0.80094332,
           0.7925997 , 0.78663846],
          [2.35571293,        nan, 2.34351492, ..., 0.79711259,
           0.79645482, 0.78667343],
          ...,
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
           0.79209608,        nan],
          [       nan,        nan,        nan, ...,        nan,
           0.79225571,        nan]],

         [[2.35415508, 2.34719302, 2.34147478, ..., 0.80109217,
           0.79671539, 0.78709305],
          [2.35334454, 2.34696312, 2.33990937, ...,        nan,
                  nan, 0.78592807],
          [2.35179783, 2.34735059, 2.33960528, ..., 0.80237389,
                  nan, 0.78730023],
          ...,
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [2.35377248,        nan,        nan, ...,        nan,
                  nan,        nan]]],


        [[[2.35452082, 2.34788653, 2.34135869, ..., 0.79762928,
           0.79577597, 0.78522232],
          [2.35524549, 2.34898427, 2.34001521, ..., 0.80230618,
           0.79399863,        nan],
          [2.35582719, 2.34681154, 2.34074028, ...,        nan,
                  nan, 0.78682128],
          ...,
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ..., 0.79683606,
           0.79598766,        nan]],

         [[2.35312628, 2.3476695 , 2.34052282, ...,        nan,
           0.7923047 , 0.78840886],
          [2.3530582 , 2.34757994, 2.33888946, ...,        nan,
           0.79176442, 0.7870269 ],
          [2.35359128, 2.34666765, 2.34046285, ..., 0.79979411,
           0.79574892, 0.78665539],
          ...,
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ..., 0.7974848 ,
                  nan,        nan]]],


        [[[2.35423314, 2.34878365, 2.34057621, ..., 0.79733719,
           0.79647873, 0.78468584],
          [2.35310805, 2.34761336, 2.34241663, ...,        nan,
           0.79163379,        nan],
          [2.35340256, 2.34738428, 2.34135509, ...,        nan,
           0.79244428, 0.78687793],
          ...,
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan, 2.3404166 , ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan]],

         [[2.35259119, 2.34839384, 2.34117645, ...,        nan,
           0.79543978, 0.78577802],
          [2.35400737, 2.34951774, 2.33964657, ...,        nan,
           0.7933908 , 0.78638109],
          [2.35528777,        nan,        nan, ..., 0.80169858,
           0.79400702, 0.7879074 ],
          ...,
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan, 2.34016904, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan]]]],



       [[[[2.3553061 , 2.34747025, 2.34378526, ..., 0.79728449,
           0.79444047, 0.78613414],
          [2.35589714, 2.3469945 , 2.3436264 , ...,        nan,
                  nan, 0.78568436],
          [2.35632727, 2.34765515, 2.34224148, ...,        nan,
                  nan, 0.7852713 ],
          ...,
          [       nan, 2.34943101,        nan, ...,        nan,
           0.79393995,        nan],
          [       nan, 2.34919089,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan]],

         [[2.35412428, 2.34780316, 2.33929936, ..., 0.80065741,
           0.79364371, 0.78531   ],
          [2.35497983, 2.34698737, 2.34105718, ..., 0.79943316,
           0.79297596, 0.79010277],
          [2.35483344, 2.34885768, 2.34007732, ..., 0.79756803,
           0.79431894, 0.78953579],
          ...,
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan]]],


        [[[2.35143173, 2.3474956 , 2.3440804 , ..., 0.79992868,
           0.79169335, 0.78521786],
          [2.35519004, 2.34722791, 2.34044233, ..., 0.7971764 ,
           0.79687431, 0.78692887],
          [2.35478762, 2.34862847, 2.34062396, ...,        nan,
           0.7914867 , 0.78788205],
          ...,
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [2.35718774,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan]],

         [[2.35207284, 2.34679695, 2.34257954, ..., 0.79860525,
           0.79571418, 0.78603484],
          [2.35437759, 2.34695296, 2.34069977, ...,        nan,
           0.79512931, 0.78803826],
          [2.35469822, 2.34712199, 2.34152509, ..., 0.79867341,
           0.79444255, 0.78880081],
          ...,
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ..., 0.79863482,
           0.79625344,        nan]]],


        [[[2.35527108, 2.34713256, 2.34279327, ...,        nan,
           0.79171388, 0.79053857],
          [2.3544004 , 2.35009153, 2.33995122, ...,        nan,
           0.79311724, 0.78612878],
          [2.35384824, 2.34749617, 2.34072804, ...,        nan,
           0.79451351, 0.78546752],
          ...,
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan]],

         [[2.35439106, 2.34787691, 2.3404937 , ..., 0.79822674,
           0.79422579, 0.78898749],
          [2.35228642, 2.34724457, 2.34016295, ..., 0.80267013,
           0.79478954, 0.78676613],
          [2.35596048, 2.34663847, 2.34034047, ..., 0.80113267,
           0.79147869, 0.79045811],
          ...,
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [2.35691664,        nan,        nan, ...,        nan,
                  nan,        nan],
          [2.35637384,        nan,        nan, ...,        nan,
                  nan,        nan]]],


        [[[2.35427999, 2.34872254, 2.34178349, ...,        nan,
           0.7938018 , 0.78617602],
          [2.35479447, 2.34862225, 2.34083469, ...,        nan,
           0.79290609, 0.78670691],
          [2.35424847, 2.34912973, 2.34135535, ...,        nan,
           0.79611187, 0.79028498],
          ...,
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan, 0.78471505],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan]],

         [[2.35253708, 2.34712823, 2.34246471, ...,        nan,
           0.79259216, 0.78687352],
          [2.35208916, 2.34716962, 2.34083973, ..., 0.8007169 ,
           0.79491447,        nan],
          [2.35470734, 2.34829066, 2.34131286, ...,        nan,
                  nan, 0.78878447],
          ...,
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [2.35678522,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan]]],


        [[[2.35433696, 2.34789013, 2.34126693, ...,        nan,
           0.79139924, 0.78516737],
          [2.35439094, 2.34844275, 2.34186572, ...,        nan,
           0.79400746,        nan],
          [2.35356851, 2.34910279, 2.3415245 , ...,        nan,
                  nan, 0.78479479],
          ...,
          [2.3571161 ,        nan,        nan, ..., 0.80186291,
                  nan,        nan],
          [2.35568369,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan, 2.34715931,        nan, ...,        nan,
                  nan,        nan]],

         [[2.35318619, 2.34578929, 2.3430436 , ..., 0.80025979,
           0.79222039, 0.78628945],
          [2.35350203, 2.3480823 , 2.3410972 , ..., 0.80344111,
           0.79304316,        nan],
          [2.35424122, 2.34615569, 2.33939818, ..., 0.799017  ,
                  nan, 0.78700556],
          ...,
          [       nan,        nan, 2.34431358, ...,        nan,
                  nan,        nan],
          [2.35161301, 2.3509502 ,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan]]],


        [[[2.35345267, 2.34835171, 2.34364572, ...,        nan,
           0.79078442, 0.78626318],
          [2.35347241, 2.34960918, 2.34131135, ...,        nan,
           0.79659674, 0.78683598],
          [2.35558885, 2.34676428, 2.34161452, ..., 0.79704049,
           0.79658297,        nan],
          ...,
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan, 2.34434109, ...,        nan,
                  nan,        nan]],

         [[2.35406013, 2.34652474, 2.34158892, ..., 0.80228696,
                  nan, 0.78576748],
          [2.35303869, 2.3496428 , 2.34054792, ..., 0.80125932,
           0.79550154, 0.78808772],
          [2.35383932, 2.34616576, 2.34217028, ...,        nan,
                  nan,        nan],
          ...,
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan]]]],



       [[[[2.35374611, 2.34969463, 2.34248562, ..., 0.8020957 ,
                  nan, 0.78775733],
          [2.3560148 , 2.3475521 , 2.34111202, ...,        nan,
           0.79384281, 0.78517139],
          [2.35309854, 2.34909513, 2.343023  , ..., 0.79741443,
           0.79575588, 0.78635492],
          ...,
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan]],

         [[2.35512651, 2.34791853, 2.34117157, ..., 0.79941037,
           0.79297116, 0.7878066 ],
          [2.35303316, 2.34784235, 2.3405693 , ..., 0.79980211,
           0.79350068, 0.78717625],
          [2.35421369, 2.34620998, 2.34120696, ..., 0.79915636,
           0.79616331, 0.78656349],
          ...,
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan, 0.78565612],
          [       nan,        nan,        nan, ..., 0.79928365,
                  nan,        nan]]],


        [[[2.35459373, 2.34880893, 2.34191135, ..., 0.79902904,
           0.79458856, 0.78644079],
          [2.35395066, 2.34748834, 2.34218414, ...,        nan,
           0.79272576, 0.78503893],
          [2.35506318, 2.3476248 , 2.34330465, ..., 0.79792852,
           0.79122886,        nan],
          ...,
          [       nan,        nan,        nan, ..., 0.80117438,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan]],

         [[2.35370508, 2.34704486, 2.34107647, ..., 0.79959835,
           0.79554683,        nan],
          [2.35373857, 2.34720578,        nan, ...,        nan,
           0.79407281,        nan],
          [2.35383585, 2.34566569, 2.34119756, ..., 0.79797409,
           0.79725178, 0.78801874],
          ...,
          [       nan,        nan,        nan, ...,        nan,
           0.795918  ,        nan],
          [       nan,        nan,        nan, ...,        nan,
           0.79588174,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan]]],


        [[[2.3541437 , 2.34982399, 2.34124006, ..., 0.80069969,
                  nan, 0.78500579],
          [2.35478772, 2.34832718, 2.33926921, ..., 0.802078  ,
           0.79625985, 0.78532084],
          [       nan, 2.34666813, 2.34375659, ..., 0.80085371,
                  nan, 0.78873496],
          ...,
          [       nan, 2.34923363,        nan, ...,        nan,
                  nan, 0.78589944],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan]],

         [[2.3528945 , 2.34674296, 2.34113812, ..., 0.80101256,
           0.79125157, 0.79099957],
          [2.35303176, 2.34612023, 2.34019494, ..., 0.79709146,
           0.79499662, 0.78758539],
          [2.35319867, 2.34722278, 2.34188887, ...,        nan,
           0.7929278 , 0.78931736],
          ...,
          [       nan,        nan,        nan, ...,        nan,
           0.79316026,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan]]],


        [[[2.35457117, 2.34761892, 2.34135701, ..., 0.79766693,
           0.79472339, 0.78659783],
          [2.3558373 , 2.34818438, 2.34181158, ..., 0.80010779,
           0.79029319, 0.78862914],
          [2.35402451, 2.34834439, 2.33911526, ..., 0.79974196,
           0.79146956, 0.78501599],
          ...,
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan]],

         [[2.35430429, 2.34771182, 2.33848477, ...,        nan,
                  nan, 0.78630206],
          [2.35320529, 2.34810488, 2.34025312, ..., 0.80051919,
                  nan, 0.78859113],
          [2.35500425, 2.34650251, 2.33965069, ..., 0.80169069,
           0.79564914, 0.7881267 ],
          ...,
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [2.35705734,        nan,        nan, ...,        nan,
                  nan,        nan],
          [2.35703704,        nan,        nan, ...,        nan,
                  nan,        nan]]],


        [[[2.35416911, 2.34785152, 2.3409837 , ...,        nan,
           0.79429753, 0.78545773],
          [2.35337787, 2.34889789, 2.34024394, ...,        nan,
           0.79491954, 0.78670047],
          [2.35455807, 2.34841565, 2.34002431, ..., 0.80224213,
           0.79084635, 0.78730825],
          ...,
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
           0.79021801,        nan]],

         [[2.35274002, 2.34672014, 2.34163639, ..., 0.80046183,
           0.79582759, 0.78609965],
          [2.35514213, 2.34678917, 2.34155188, ..., 0.80058414,
           0.79520091, 0.78575966],
          [2.35273582, 2.346624  , 2.34165292, ...,        nan,
           0.79304336, 0.79126268],
          ...,
          [2.35552545,        nan, 2.33895936, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan, 0.78978143]]],


        [[[2.35610792, 2.34778528, 2.3417758 , ..., 0.79984075,
                  nan, 0.78642789],
          [2.35505724, 2.34699618, 2.34279981, ..., 0.79906757,
           0.79632431, 0.78681832],
          [2.35424702, 2.34973906, 2.3426813 , ..., 0.80076546,
           0.79433921, 0.78934006],
          ...,
          [2.35453294,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan],
          [       nan,        nan, 2.33939339, ...,        nan,
                  nan,        nan]],

         [[2.35393105, 2.34724206, 2.34067304, ..., 0.80176528,
                  nan, 0.78795783],
          [       nan, 2.34910044, 2.34265806, ...,        nan,
           0.79281017, 0.78993921],
          [2.35364027, 2.34794842, 2.34391723, ...,        nan,
           0.7912831 , 0.7879033 ],
          ...,
          [       nan,        nan, 2.33968645, ...,        nan,
                  nan,        nan],
          [       nan,        nan,        nan, ...,        nan,
           0.79430461,        nan],
          [       nan,        nan,        nan, ...,        nan,
                  nan,        nan]]]]], shape=(14, 6, 2, 32, 256))</pre></span></li><li class='sc-var-item'><div class='sc-var-name'><span class='sc-aligned'>wire</span></div><div class='sc-var-dims'>(wire)</div><div class='sc-var-dtype'>int64</div><div class='sc-var-unit'></div><div class='sc-value-preview sc-preview'><span><div>1, 2, ..., 31, 32</div></span></div><input id='attrs-8d079700-ba17-4af3-bebc-f5a4ace9a231' class='sc-var-attrs-in' type='checkbox' disabled><label for='attrs-8d079700-ba17-4af3-bebc-f5a4ace9a231' class='sc-hide-icon' title='Show/Hide attributes'><svg class='icon sc-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ae94e251-551e-486e-809f-ffca3c90d402' class='sc-var-data-in' type='checkbox'><label for='data-ae94e251-551e-486e-809f-ffca3c90d402' title='Show/Hide data repr'><svg class='icon sc-icon-database'><use xlink:href='#icon-database'></use></svg></label><pre class='sc-var-data'>Values:<br>array([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
       18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32])</pre></span></li></ul></div></li><li class='sc-section-item'><input id='section-7cfd91a4-1038-48b7-8eb9-93c7a3768289' class='sc-section-summary-in' type='checkbox'  checked><label for='section-7cfd91a4-1038-48b7-8eb9-93c7a3768289' class='sc-section-summary'  title='Expand/collapse section'>Data: <span>(1)</span></label><div class='sc-section-inline-details'></div><div class='sc-section-details'><ul class='sc-var-list'><li class='sc-var-item'><div class='sc-var-name'><span></span></div><div class='sc-var-dims'>(module, segment, counter, wire, strip)</div><div class='sc-var-dtype'>float64</div><div class='sc-var-unit'>counts</div><div class='sc-value-preview sc-preview'><span><div>binned data [len=12, len=9, ..., len=0, len=0]</div></span></div><input id='attrs-d8b2ca60-c9d6-4a5c-a8e3-89087fb59c4e' class='sc-var-attrs-in' type='checkbox' disabled><label for='attrs-d8b2ca60-c9d6-4a5c-a8e3-89087fb59c4e' class='sc-hide-icon' title='Show/Hide attributes'><svg class='icon sc-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-852c662e-e037-45a5-b234-a7d92d1f29f6' class='sc-var-data-in' type='checkbox'><label for='data-852c662e-e037-45a5-b234-a7d92d1f29f6' title='Show/Hide data repr'><svg class='icon sc-icon-database'><use xlink:href='#icon-database'></use></svg></label><pre class='sc-var-data'>dim=&#x27;event&#x27;,
content=DataArray(
          dims=(event: 1533595),
          data=float64[counts],
          coords={&#x27;event_time_zero&#x27;:datetime64[ns], &#x27;tof&#x27;:float64[ns], &#x27;wavelength&#x27;:float64[Å]})</pre></li></ul></div></li></ul></div></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">two_theta</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="s2">&quot;two_theta&quot;</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">2.4</span><span class="p">,</span> <span class="mi">301</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;rad&quot;</span><span class="p">)</span>
<span class="n">intermediates</span><span class="p">[</span><span class="n">MaskedData</span><span class="p">[</span><span class="n">SampleRun</span><span class="p">]]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">two_theta</span><span class="o">=</span><span class="n">two_theta</span><span class="p">,</span> <span class="n">wavelength</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">norm</span><span class="o">=</span><span class="s2">&quot;log&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../../_images/user-guide_dream_dream-advanced-powder-reduction_25_0.svg" src="../../_images/user-guide_dream_dream-advanced-powder-reduction_25_0.svg" />
</div>
</div>
</section>
<section id="Process-all-detector-banks">
<h2>Process all detector banks<a class="headerlink" href="#Process-all-detector-banks" title="Link to this heading">#</a></h2>
<p>The other sections only use a single detector bank. In practice, we want to process all banks. This section demonstrates how to do this, except for the sans detector which requires a different workflow.</p>
<p>We construct the workflow as before but this time <strong>without specifying a detector name</strong>:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">workflow</span> <span class="o">=</span> <span class="n">dream</span><span class="o">.</span><span class="n">DreamGeant4Workflow</span><span class="p">(</span><span class="n">run_norm</span><span class="o">=</span><span class="n">powder</span><span class="o">.</span><span class="n">RunNormalization</span><span class="o">.</span><span class="n">proton_charge</span><span class="p">)</span>

<span class="n">workflow</span><span class="p">[</span><span class="n">Filename</span><span class="p">[</span><span class="n">SampleRun</span><span class="p">]]</span> <span class="o">=</span> <span class="n">dream</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">simulated_diamond_sample</span><span class="p">()</span>
<span class="n">workflow</span><span class="p">[</span><span class="n">Filename</span><span class="p">[</span><span class="n">VanadiumRun</span><span class="p">]]</span> <span class="o">=</span> <span class="n">dream</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">simulated_vanadium_sample</span><span class="p">()</span>
<span class="n">workflow</span><span class="p">[</span><span class="n">Filename</span><span class="p">[</span><span class="n">EmptyCanRun</span><span class="p">]]</span> <span class="o">=</span> <span class="n">dream</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">simulated_empty_can</span><span class="p">()</span>
<span class="n">workflow</span><span class="p">[</span><span class="n">CalibrationFilename</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

<span class="n">workflow</span><span class="p">[</span><span class="n">dream</span><span class="o">.</span><span class="n">InstrumentConfiguration</span><span class="p">]</span> <span class="o">=</span> <span class="n">dream</span><span class="o">.</span><span class="n">InstrumentConfiguration</span><span class="o">.</span><span class="n">high_flux</span>
<span class="c1"># We drop uncertainties where they would otherwise lead to correlations:</span>
<span class="n">workflow</span><span class="p">[</span><span class="n">UncertaintyBroadcastMode</span><span class="p">]</span> <span class="o">=</span> <span class="n">UncertaintyBroadcastMode</span><span class="o">.</span><span class="n">drop</span>
<span class="c1"># Edges for binning in d-spacing:</span>
<span class="n">workflow</span><span class="p">[</span><span class="n">DspacingBins</span><span class="p">]</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="s2">&quot;dspacing&quot;</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">2.3434</span><span class="p">,</span> <span class="mi">201</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;angstrom&quot;</span><span class="p">)</span>

<span class="c1"># Do not mask any pixels / voxels:</span>
<span class="n">workflow</span> <span class="o">=</span> <span class="n">powder</span><span class="o">.</span><span class="n">with_pixel_mask_filenames</span><span class="p">(</span><span class="n">workflow</span><span class="p">,</span> <span class="p">[])</span>
</pre></div>
</div>
</div>
<p>At this point, the workflow is incomplete because it is missing the <code class="docutils literal notranslate"><span class="pre">NexusDetectorName</span></code> parameter. This will be fixed below.</p>
<section id="1D-intensity-vs.-ToF">
<h3>1D intensity vs. ToF<a class="headerlink" href="#1D-intensity-vs.-ToF" title="Link to this heading">#</a></h3>
<p>Now, we build a parameter table (as a <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html">pandas.DataFrame</a>) with the desired detector names. (Note that we could use a simple <code class="docutils literal notranslate"><span class="pre">dict</span></code> as well if Pandas was not available.) Then we <a class="reference external" href="https://scipp.github.io/sciline/user-guide/parameter-tables.html">map</a> the workflow over those detector names to apply the workflow to each bank separately. We could do this at some intermediate step, but it is easiest to map the
final result. Finally, we combine the data arrays for the individual detectors into a single data group.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">detector_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;mantle&quot;</span><span class="p">,</span> <span class="s2">&quot;endcap_forward&quot;</span><span class="p">,</span> <span class="s2">&quot;endcap_backward&quot;</span><span class="p">,</span> <span class="s2">&quot;high_resolution&quot;</span><span class="p">]</span>
<span class="n">parameter_table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">{</span><span class="n">NeXusDetectorName</span><span class="p">:</span> <span class="n">detector_names</span><span class="p">},</span> <span class="n">index</span><span class="o">=</span><span class="n">detector_names</span>
<span class="p">)</span><span class="o">.</span><span class="n">rename_axis</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;detector&#39;</span><span class="p">)</span>

<span class="n">all_detector_workflow</span> <span class="o">=</span> <span class="n">workflow</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">mapped</span> <span class="o">=</span> <span class="n">all_detector_workflow</span><span class="p">[</span><span class="n">EmptyCanSubtractedIofDspacing</span><span class="p">[</span><span class="n">SampleRun</span><span class="p">]]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
    <span class="n">parameter_table</span>
<span class="p">)</span>
<span class="n">all_detector_workflow</span><span class="p">[</span><span class="n">EmptyCanSubtractedIofDspacing</span><span class="p">[</span><span class="n">SampleRun</span><span class="p">]]</span> <span class="o">=</span> <span class="n">mapped</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span>
    <span class="n">func</span><span class="o">=</span><span class="n">powder</span><span class="o">.</span><span class="n">grouping</span><span class="o">.</span><span class="n">collect_detectors</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<p>The graph shows all domain types that are used separately for each detector bank as a box instead of a flat square:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">all_detector_workflow</span><span class="o">.</span><span class="n">visualize</span><span class="p">(</span>
    <span class="n">EmptyCanSubtractedIofDspacing</span><span class="p">[</span><span class="n">SampleRun</span><span class="p">],</span> <span class="n">graph_attr</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;rankdir&quot;</span><span class="p">:</span> <span class="s2">&quot;LR&quot;</span><span class="p">},</span> <span class="n">compact</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../../_images/user-guide_dream_dream-advanced-powder-reduction_32_0.svg" src="../../_images/user-guide_dream_dream-advanced-powder-reduction_32_0.svg" />
</div>
</div>
<p>Now compute the result:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">all_detector_workflow</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">EmptyCanSubtractedIofDspacing</span><span class="p">[</span><span class="n">SampleRun</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><style id="scipp-style-sheet">.sc-root{--sc-background-color0:var(--jp-layout-color0,#fff);--sc-background-color1:var(--jp-layout-color1,#fcfcfc);--sc-background-color2:var(--jp-layout-color2,#efefef);--sc-inverse-background-color0:var(--jp-inverse-layout-color4,#111);--sc-font-color0:var(--jp-content-font-color0,#000);--sc-font-color1:var(--jp-content-font-color1,#555);--sc-font-color2:var(--jp-content-font-color2,#888);--sc-font-color3:var(--jp-content-font-color3,#ccc);}body.vscode-dark .sc-root{--sc-font-color0:rgba(255,255,255,1);--sc-font-color1:rgba(255,255,255,0.70);--sc-font-color2:rgba(255,255,255,0.54);--sc-font-color3:rgba(255,255,255,0.38);--sc-border-color:#1F1F1F;--sc-disabled-color:#515151;--sc-background-color0:#111111;--sc-background-color1:#111111;--sc-background-color2:#313131;}.sc-wrap{font-size:14px;min-width:300px;max-width:800px;}.sc-var-attrs .sc-wrap{padding-left:3em;}.sc-header{padding-top:6px;padding-bottom:6px;margin-bottom:4px;border-bottom:solid 1px #ddd;}.sc-header > div,.sc-header > ul{display:inline;margin-top:0;margin-bottom:0;}.sc-obj-type,.sc-array-name{margin-left:2px;margin-right:10px;}.sc-obj-type{color:var(--sc-font-color1);}.sc-underlying-size{color:var(--sc-font-color2);}.sc-sections,.reveal .sc-sections{padding-left:0 !important;display:grid;grid-template-columns:150px auto auto auto 1fr 20px 20px;}.sc-section-item{display:contents;}.sc-section-item input{display:none;}.sc-section-item input:enabled + label{cursor:pointer;color:var(--sc-font-color1);}.sc-section-item input:enabled + label:hover{color:var(--sc-font-color0);}.sc-section-summary{grid-column:1;font-weight:500;}.sc-section-summary > span{display:inline-block;padding-left:0.5em;}.sc-section-summary-in:disabled + label{color:var(--sc-font-color1);}.sc-section-summary-in + label:before{display:inline-block;content:'►';font-size:11px;width:15px;text-align:center;}.sc-section-summary-in:disabled + label:before{color:var(--sc-font-color3);}.sc-section-summary-in:checked + label:before{content:'▼';}.sc-section-summary-in:checked + label > span{display:none;}.sc-section-summary,.sc-section-inline-details{padding-top:4px;padding-bottom:4px;}.sc-section-inline-details{grid-column:2 / 6;}.sc-section-details{display:none;grid-column:1 / -1;margin-bottom:5px;}.sc-section-summary-in:checked ~ .sc-section-details{display:contents;}.sc-array-wrap{grid-column:1 / -1;display:grid;grid-template-columns:20px auto;}.sc-array-wrap > label{grid-column:1;vertical-align:top;}.sc-preview{color:var(--sc-font-color2);}.sc-array-preview,.sc-array-data{padding:0 5px !important;grid-column:2;}.sc-array-data,.sc-array-in:checked ~ .sc-array-preview{display:none;}.sc-array-in:checked ~ .sc-array-data,.sc-array-preview{display:inline-block;}.sc-dim-list{display:inline-block !important;list-style:none;padding:0 !important;margin:0;}.sc-dim-list li{display:inline-block;padding:0;margin:0!important;}.sc-dim-list:before{content:'(';}.sc-dim-list:after{content:')';}.sc-dim-list li:not(:last-child):after{content:',';padding-right:5px;}.sc-dim-list li span,.sc-standalone-var-name > span span,.sc-var-name > span span{padding:0 !important;}.sc-aligned{font-weight:bold;}.sc-var-list,.sc-var-item,.reveal .sc-var-list,.reveal .sc-var-item{display:contents;}.sc-var-item > div,.sc-var-item label,.sc-var-item > .sc-var-name span{background-color:var(--sc-background-color1);margin-bottom:0;}.sc-var-item > .sc-var-name:hover span{padding-right:5px;}.sc-var-list > li:nth-child(odd) > div,.sc-var-list > li:nth-child(odd) > label,.sc-var-list > li:nth-child(odd) > .sc-var-name span{background-color:var(--sc-background-color2);}.sc-var-name{grid-column:1;}.sc-var-dims{grid-column:2;}.sc-var-dtype{grid-column:3;text-align:right;color:var(--sc-font-color2);}.sc-var-unit{grid-column:4;text-align:left;color:var(--sc-font-color1);max-width:50pt;text-overflow:ellipsis;}.sc-value-preview{grid-column:5;}.sc-var-preview-variances{text-align:right;}.sc-sections .sc-section-item .sc-section-summary,.sc-sections .sc-section-item .sc-section-inline-details,.sc-section-item .sc-var-list .sc-var-item > div,.sc-section-item .sc-var-list .sc-var-item > label,.sc-section-details .sc-var-list .sc-var-item > div,.sc-section-details .sc-var-list .sc-var-item > label{margin-top:0;margin-bottom:0;}.sc-var-name,.sc-var-dims,.sc-var-dtype,.sc-var-unit,.sc-preview,.sc-attrs dt{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;padding-right:10px;}.sc-var-name:hover,.sc-var-dims:hover,.sc-var-dtype:hover,.sc-var-unit:hover,.sc-attrs dt:hover{overflow:visible;width:auto;z-index:1;}.sc-var-attrs{display:block;}.sc-var-data,.reveal .sc-var-data{display:none;}.sc-var-attrs,.sc-var-data{background-color:var(--sc-background-color0) !important;padding-bottom:5px !important;}.sc-var-attrs-in:checked ~ .sc-var-attrs{display:none;}.sc-var-data-in:checked ~ .sc-var-data{display:block;}.sc-var-data > table{float:right;}.sc-var-name span,.sc-var-data{padding-left:25px !important;}.sc-var-attrs,.sc-var-data{grid-column:1 / -1;}dl.sc-attrs{padding:0;margin:0;display:grid;grid-template-columns:125px auto;}.sc-attrs dt,dd{padding:0;margin:0;float:left;padding-right:10px;width:auto;}.sc-attrs dt{font-weight:normal;grid-column:1;}.sc-attrs dt:hover span{display:inline-block;padding-right:10px;}.sc-attrs dd{grid-column:2;white-space:pre-wrap;word-break:break-all;}.sc-icon-database,.sc-icon-file-text2{display:inline-block;vertical-align:middle;width:1em;height:1.5em !important;stroke-width:0;stroke:currentColor;fill:currentColor;}label.sc-hide-icon svg{opacity:0;}.sc-standalone-var-name{grid-column:1/3;}.sc-standalone-var-name span{padding-left:25px;padding-right:10px;}.sc-title{font-weight:bold;font-size:1.5em;}.sc-subtitle{font-weight:normal;font-style:italic;text-align:left;font-size:1.2em;padding:1px;}.sc-label{fill:var(--sc-font-color0,#444444);text-anchor:middle;}.sc-name{fill:var(--sc-font-color0,#111111);}.sc-inset-line{stroke:var(--sc-font-color1);stroke-width:0.05;stroke-dasharray:0.2,0.2;}.sc-log-wrap{height:25ex;resize:vertical;overflow-y:scroll;display:flex;flex-direction:column-reverse;border:1px solid;border-color:var(--jp-border-color2);background-color:var(--sc-background-color1);}div.sc-log{line-height:2.5ex;}table.sc-log{table-layout:auto;border-collapse:collapse;}tr.sc-log:nth-child(even){background-color:var(--sc-background-color0);}tr.sc-log > td{vertical-align:top;padding-bottom:0.5ex;}.sc-log-time-stamp{min-width:22ch;font-family:var(--jp-code-font-family);color:var(--sc-font-color2);}.sc-log-level{min-width:10ch;}tr.sc-log-debug td.sc-log-level{color:var(--jp-accent-color1);}tr.sc-log-info td.sc-log-level{color:var(--jp-info-color1);}tr.sc-log-warning td.sc-log-level{color:var(--jp-warn-color1);}tr.sc-log-error td.sc-log-level{font-weight:bold;color:var(--jp-error-color2);}tr.sc-log-critical td.sc-log-level{font-weight:bold;color:var(--sc-background-color0);background-color:var(--jp-error-color1);}.sc-log-message{white-space:pre-wrap;width:100%;}.sc-log-html-payload{white-space:normal;}.sc-log-name{padding-right:0.5em;text-align:right;white-space:pre-wrap;color:var(--sc-font-color3);}</style><style id="datagroup-style-sheet">.dg-root{white-space:normal;font-size:14px;min-width:300px;max-width:1200px;}.dg-root *{box-sizing:border-box;}.sc-header > label,.sc-header > label > div,.sc-header > label > div > ul{display:inline;margin-bottom:0;}.dg-header-in{display:none;}.dg-header-in + .sc-header > label:before{display:inline-block;font-size:11px;text-align:left;content:'►';}.dg-header-in:checked + .sc-header > label:before{content:'▼';}.dg-header-in ~ .dg-detail-box{display:none;}.dg-header-in:checked ~ .dg-detail-box{display:grid;}.dg-detail-box{margin-top:5px;margin-bottom:5px;column-gap:0 !important;display:grid;grid-template-columns:max-content max-content max-content max-content max-content max-content max-content;grid-template-areas:"name        parent      object-type shape       dtype       unit        preview";}.dg-detail-box *{margin-top:0;margin-bottom:0;}.dg-detail-list{display:contents;}.dg-detail-item{display:contents;list-style-type:none;}.dg-detail-item-in{display:none;}.dg-detail-item-in + .dg-detail-name > label:before{display:inline-block;font-size:14px;text-align:left;content:'►';}.dg-detail-item-in:checked + .dg-detail-name > label:before{content:'▼';}.dg-detail-item div,.dg-detail-item span,.dg-detail-item label{word-break:break-all;min-width:1em;max-width:20em;width:100%;}.dg-detail-item > div{display:contents;}.dg-detail-item > div > div > div{width:100%;}.dg-detail-item:hover > div > div{background-color:var(--sc-background-color2) !important;}.dg-detail-item > div span{padding-left:10px;padding-right:10px;}.dg-detail-item > div > div:first-of-type{grid-column-start:1;}.dg-detail-item-subsection{display:none;}.dg-detail-item-in{margin:0;}.dg-detail-item-in:checked ~ .dg-detail-item-subsection{display:contents;}.dg-detail-item .dg-detail-name{grid-area:"name";min-width:5em;}.dg-detail-name{padding-left:calc(var(--depth)*2em);}.dg-detail-name > label{padding-left:8px;}.dg-detail-name > label > span{padding-left:0.1em;}.dg-detail-item .dg-detail-parent{grid-area:"parent";text-align:right;}.dg-detail-item .dg-detail-objtype{grid-area:"objtype";text-align:left;}.dg-detail-item .dg-detail-shape{max-width:30em;grid-area:"shape";text-align:left;}.sc-header .dg-detail-shape{margin-left:1em;text-align:left;}.dg-detail-item .dg-detail-dtype{grid-area:"dtype";text-align:left;}.dg-detail-item .dg-detail-unit{grid-area:"unit";text-align:center;}.dg-detail-item .dg-detail-preview{grid-area:"preview";min-width:15em;max-width:100em !important;text-align:left;}.dg-detail-preview .sc-preview span,.dg-detail-shape span{padding:0 !important;}</style><div class='sc-root dg-root'><input class='dg-header-in' id='datagroup-view-cc3d8203-3fa8-4997-8d4c-9f06ff85e0f7' type='checkbox' checked><div class='sc-header'><label for=datagroup-view-cc3d8203-3fa8-4997-8d4c-9f06ff85e0f7 title='Expand/collapse'><div class='sc-obj-type'>scipp.DataGroup </div><div class='dg-detail-shape'>(dspacing: 200)</div></label></div><div class='dg-detail-box'><ul class='dg-detail-list'><li class='dg-detail-item'><div><div class='dg-detail-name' style='--depth: 0;'><span>mantle</span></div><div class='dg-detail-parent'><span style='opacity: 0.5;'>scipp</span></div><div class='dg-detail-objtype'><span>DataArray</span></div><div class='dg-detail-shape'>(dspacing: 200)</div><div class='dg-detail-dtype'><span>float64</span></div><div class='dg-detail-unit'><span>𝟙</span></div><div class='dg-detail-preview'><span class='sc-preview'>binned data [len=7, len=43, ..., len=5489, len=5112]</span></div></div></li><li class='dg-detail-item'><div><div class='dg-detail-name' style='--depth: 0;'><span>endcap_forward</span></div><div class='dg-detail-parent'><span style='opacity: 0.5;'>scipp</span></div><div class='dg-detail-objtype'><span>DataArray</span></div><div class='dg-detail-shape'>(dspacing: 200)</div><div class='dg-detail-dtype'><span>float64</span></div><div class='dg-detail-unit'><span>𝟙</span></div><div class='dg-detail-preview'><span class='sc-preview'>binned data [len=0, len=0, ..., len=257, len=277]</span></div></div></li><li class='dg-detail-item'><div><div class='dg-detail-name' style='--depth: 0;'><span>endcap_backward</span></div><div class='dg-detail-parent'><span style='opacity: 0.5;'>scipp</span></div><div class='dg-detail-objtype'><span>DataArray</span></div><div class='dg-detail-shape'>(dspacing: 200)</div><div class='dg-detail-dtype'><span>float64</span></div><div class='dg-detail-unit'><span>𝟙</span></div><div class='dg-detail-preview'><span class='sc-preview'>binned data [len=102, len=135, ..., len=0, len=0]</span></div></div></li><li class='dg-detail-item'><div><div class='dg-detail-name' style='--depth: 0;'><span>high_resolution</span></div><div class='dg-detail-parent'><span style='opacity: 0.5;'>scipp</span></div><div class='dg-detail-objtype'><span>DataArray</span></div><div class='dg-detail-shape'>(dspacing: 200)</div><div class='dg-detail-dtype'><span>float64</span></div><div class='dg-detail-unit'><span>𝟙</span></div><div class='dg-detail-preview'><span class='sc-preview'>binned data [len=3, len=5, ..., len=0, len=0]</span></div></div></li></ul></div></div></div></div>
</div>
<p>We can plot the detectors individually. (The range covered by the <span class="math notranslate nohighlight">\(d\)</span>-spacing bins chosen above is too wide for some banks. This leads to some bins containing NaN or INF, which is masked out by the workflow. Here, we set those values to 0 to improve the plot.)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">histograms</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">hist</span><span class="p">()</span>
<span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">histograms</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
    <span class="k">if</span> <span class="s1">&#39;zero_vanadium&#39;</span> <span class="ow">in</span> <span class="n">h</span><span class="o">.</span><span class="n">masks</span><span class="p">:</span>
        <span class="n">h</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">h</span><span class="o">.</span><span class="n">masks</span><span class="p">[</span><span class="s1">&#39;zero_vanadium&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">histograms</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../../_images/user-guide_dream_dream-advanced-powder-reduction_37_0.svg" src="../../_images/user-guide_dream_dream-advanced-powder-reduction_37_0.svg" />
</div>
</div>
</section>
<section id="2D-intensity-vs.-d-spacing-and-2θ">
<h3>2D intensity vs. d-spacing and 2θ<a class="headerlink" href="#2D-intensity-vs.-d-spacing-and-2θ" title="Link to this heading">#</a></h3>
<p>Just like before, we map the workflow over the detector names. But here we also assign different <span class="math notranslate nohighlight">\(2\theta\)</span> bins for each detector bank. Those bins are chosen arbitrarily here such that they don’t overlap. This will simplify later steps.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">detector_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;mantle&quot;</span><span class="p">,</span> <span class="s2">&quot;endcap_forward&quot;</span><span class="p">,</span> <span class="s2">&quot;endcap_backward&quot;</span><span class="p">,</span> <span class="s2">&quot;high_resolution&quot;</span><span class="p">]</span>
<span class="n">two_theta_bins</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">sc</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;two_theta&quot;</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;rad&quot;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mf">0.77</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mf">2.36</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">201</span><span class="p">),</span>
    <span class="n">sc</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;two_theta&quot;</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;rad&quot;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mf">0.24</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mf">0.71</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">101</span><span class="p">),</span>
    <span class="n">sc</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;two_theta&quot;</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;rad&quot;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mf">2.42</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mf">2.91</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">151</span><span class="p">),</span>
    <span class="n">sc</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;two_theta&quot;</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;rad&quot;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mf">2.91</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mf">3.11</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">51</span><span class="p">),</span>
<span class="p">]</span>
<span class="n">parameter_table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="n">NeXusDetectorName</span><span class="p">:</span> <span class="n">detector_names</span><span class="p">,</span>
        <span class="n">TwoThetaBins</span><span class="p">:</span> <span class="n">two_theta_bins</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="n">index</span><span class="o">=</span><span class="n">detector_names</span><span class="p">,</span>
<span class="p">)</span><span class="o">.</span><span class="n">rename_axis</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;detector&#39;</span><span class="p">)</span>

<span class="n">all_detector_workflow</span> <span class="o">=</span> <span class="n">workflow</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">mapped</span> <span class="o">=</span> <span class="n">all_detector_workflow</span><span class="p">[</span><span class="n">EmptyCanSubtractedIofDspacingTwoTheta</span><span class="p">[</span><span class="n">SampleRun</span><span class="p">]]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
    <span class="n">parameter_table</span>
<span class="p">)</span>
<span class="n">all_detector_workflow</span><span class="p">[</span><span class="n">EmptyCanSubtractedIofDspacingTwoTheta</span><span class="p">[</span><span class="n">SampleRun</span><span class="p">]]</span> <span class="o">=</span> <span class="n">mapped</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span>
    <span class="n">func</span><span class="o">=</span><span class="n">powder</span><span class="o">.</span><span class="n">grouping</span><span class="o">.</span><span class="n">collect_detectors</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">all_detector_workflow</span><span class="o">.</span><span class="n">visualize</span><span class="p">(</span>
    <span class="n">EmptyCanSubtractedIofDspacingTwoTheta</span><span class="p">[</span><span class="n">SampleRun</span><span class="p">],</span>
    <span class="n">graph_attr</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;rankdir&quot;</span><span class="p">:</span> <span class="s2">&quot;LR&quot;</span><span class="p">},</span>
    <span class="n">compact</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../../_images/user-guide_dream_dream-advanced-powder-reduction_40_0.svg" src="../../_images/user-guide_dream_dream-advanced-powder-reduction_40_0.svg" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">all_detector_workflow</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">EmptyCanSubtractedIofDspacingTwoTheta</span><span class="p">[</span><span class="n">SampleRun</span><span class="p">])</span>
</pre></div>
</div>
</div>
<p>We can ‘sum’ over <span class="math notranslate nohighlight">\(2\theta\)</span> by using <code class="docutils literal notranslate"><span class="pre">concat</span></code> to obtain a 1D curve:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">sum</span><span class="p">(</span><span class="n">da</span><span class="o">.</span><span class="n">bins</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="s1">&#39;two_theta&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">hist</span><span class="p">()</span> <span class="k">for</span> <span class="n">da</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">values</span><span class="p">())</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../../_images/user-guide_dream_dream-advanced-powder-reduction_43_0.svg" src="../../_images/user-guide_dream_dream-advanced-powder-reduction_43_0.svg" />
</div>
</div>
<p>But we can also preserve the <span class="math notranslate nohighlight">\(2\theta\)</span> dimension to produce a 2D plot. Since the detector banks have different, non-overlapping, <span class="math notranslate nohighlight">\(2\theta\)</span> ranges, we can simply plot all data arrays into a single figure:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pp</span><span class="o">.</span><span class="n">imagefigure</span><span class="p">(</span>
    <span class="o">*</span><span class="p">(</span><span class="n">pp</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="n">da</span><span class="o">.</span><span class="n">hist</span><span class="p">())</span> <span class="k">for</span> <span class="n">da</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span>
    <span class="n">norm</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span>
    <span class="n">cbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">vmin</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../../_images/user-guide_dream_dream-advanced-powder-reduction_45_0.svg" src="../../_images/user-guide_dream_dream-advanced-powder-reduction_45_0.svg" />
</div>
</div>
</section>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2025 Scipp contributors.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><!-- This will display the version of the docs -->
Current ESSdiffraction version: 25.10.0 (<a href="https://github.com/scipp/essdiffraction/releases">older versions</a>).</div>
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>